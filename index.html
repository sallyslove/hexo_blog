<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/hexo_blog/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/hexo_blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/hexo_blog/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/hexo_blog/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/hexo_blog/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/hexo_blog/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/hexo_blog/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦">
<meta property="og:type" content="website">
<meta property="og:title" content="è·¬æ­¥">
<meta property="og:url" content="https://sallyslove.github.io/hexo_blog/index.html">
<meta property="og:site_name" content="è·¬æ­¥">
<meta property="og:description" content="35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="è·¬æ­¥">
<meta name="twitter:description" content="35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/hexo_blog/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://sallyslove.github.io/hexo_blog/">





  <title>è·¬æ­¥</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/hexo_blog/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">è·¬æ­¥</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">ä¸ç§¯è·¬æ­¥ï¼Œæ— ä»¥è‡³åƒé‡Œ</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/hexo_blog/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/hexo_blog/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/hexo_blog/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            å½’æ¡£
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/hexo_blog/2020/02/11/K8s-Ingress/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/hexo_blog/2020/02/11/K8s-Ingress/" itemprop="url">K8s Ingress</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-02-11T10:42:55+08:00">
                2020-02-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="ingress"><a class="header-anchor" href="#ingress"></a>Ingress</h2>
<ul>
<li><em>Ingress enables externally-reachable urls, load balance traffic, terminate SSL, offer name based virtual hosting for a Kubernetes cluster.</em></li>
<li>é€šå¸¸æƒ…å†µä¸‹ï¼Œ<code>service</code>å’Œ<code>pod</code>çš„<code>IP</code>ä»…å¯åœ¨é›†ç¾¤å†…éƒ¨è®¿é—®ã€‚é›†ç¾¤å¤–éƒ¨çš„è¯·æ±‚éœ€è¦é€šè¿‡è´Ÿè½½å‡è¡¡è½¬å‘åˆ°<code>service</code>åœ¨<code>Node</code>ä¸Šæš´éœ²çš„<code>NodePort</code>ä¸Šï¼Œç„¶åå†ç”±<code>kube-proxy</code>å°†å…¶è½¬å‘ç»™ç›¸å…³çš„<code>Pod</code>ã€‚è€Œ<code>Ingress</code>å°±æ˜¯ä¸ºè¿›å…¥é›†ç¾¤çš„è¯·æ±‚æä¾›è·¯ç”±è§„åˆ™çš„é›†åˆ</li>
<li>ç”¨<code>NodePort</code>æ¥æš´éœ²æœåŠ¡çš„æ—¶å€™ï¼Œ <code>IP</code>å¯èƒ½ä¼šæ¼‚ç§»ï¼Œå¹¶ä¸”ï¼Œå¦‚æœæœåŠ¡å¤ªå¤šçš„è¯ï¼Œä¼šæœ‰æ··ä¹±ï¼Œä¸ºæ­¤å¼•å…¥äº†<code>ingress</code>ï¼Œä½¿ç”¨<code>hostname</code>æ¥é¿å…è¿™ä¸ªé—®é¢˜ã€‚</li>
<li>å¯ä»¥è®¤ä¸º<code>Ingress</code>åŒ…å«ä¸¤ä¸ªç»„ä»¶ï¼š<code>ingress controller</code>å’Œ<code>ingress</code></li>
<li>å‚è€ƒé“¾æ¥ï¼š
<ul>
<li><a href="https://www.kubernetes.org.cn/ingress" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£ åè¯è§£é‡Šï¼šIngress</a></li>
</ul>
</li>
</ul>
<h3 id="ingress-controller"><a class="header-anchor" href="#ingress-controller"></a>Ingress Controller</h3>
<ul>
<li>
<p><code>ingress controller</code>ç›®å‰ä¸»è¦æœ‰ä¸¤ç§ï¼šåŸºäº<code>nginx</code>æœåŠ¡çš„<code>ingress controller</code>å’ŒåŸºäº<code>traefik</code>çš„<code>ingress controller</code>ã€‚</p>
<ul>
<li><code>traefik</code>çš„<code>ingress controller</code>ï¼Œç›®å‰æ”¯æŒ<code>http</code>å’Œ<code>https</code>åè®®ã€‚</li>
<li>è€Œ<code>nginx</code>å¯ä»¥æ”¯æŒ<code>TCP</code>è´Ÿè½½,ä½†æ˜¯ç›®å‰<code>k8s</code>ä»…ä»…æ”¯æŒ<code>HTTP</code>å’Œ<code>HTTPS</code></li>
<li>æˆ‘ä»¬äº§å“é‡Œé¢ç›®å‰ä½¿ç”¨çš„ä¹Ÿæ˜¯<code>nginx</code>ã€‚</li>
</ul>
</li>
<li>
<p><code>ingress controller</code>ä¼šå°†æ–°åŠ å…¥çš„<code>Ingress</code>è½¬åŒ–æˆ<code>Nginx</code>çš„é…ç½®æ–‡ä»¶å¹¶ä½¿ä¹‹ç”Ÿæ•ˆ</p>
</li>
<li>
<p>é€šå¸¸ä¼šå•ç‹¬å®‰è£…åœ¨ä¸€ä¸ª<code>namespace</code>é‡Œé¢ï¼Œæ¯”å¦‚<code>nginx-inigress</code>é‡Œé¢ã€‚</p>
</li>
<li>
<p>é…å¥—ä¼šæœ‰ä¸€äº›éƒ¨ç½²ï¼Œè§£é‡Šå¦‚ä¸‹ï¼š</p>
<ul>
<li><code>Deployment</code>:<code>default-http-backend</code>,å¯¹åº”æœ‰åŒåçš„<code>service</code>.å¦‚æœå¤–ç•Œè®¿é—®çš„åŸŸåä¸å­˜åœ¨çš„è¯ï¼Œåˆ™é»˜è®¤è½¬å‘åˆ°<code>default-http-backend</code>è¿™ä¸ª<code>service</code>ï¼Œä¼šè¿”å›404</li>
</ul>
</li>
<li>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<ul>
<li><a href="https://www.jianshu.com/p/feeea0bbd73e" target="_blank" rel="noopener">ä»é›¶å¼€å§‹æ­å»ºK8s</a></li>
<li><a href="https://www.ilanni.com/?p=14501" target="_blank" rel="noopener">k8så®‰è£…ä¸é…ç½®ingress(ä¸€)</a>: æ–‡æ¡£å†™å¾—çœŸå¿ƒä¸é”™ï¼Œæ ¼å¼å®åœ¨å¤ªçƒ‚äº†ï¼Œçœ‹å¾—çœ¼ç›ç–¼</li>
<li><a href="https://www.cnblogs.com/justmine/p/8991379.html" target="_blank" rel="noopener">è¯¦è§£k8sç»„ä»¶Ingressè¾¹ç¼˜è·¯ç”±å™¨å¹¶è½åœ°åˆ°å¾®æœåŠ¡ - kubernetes</a></li>
</ul>
</li>
</ul>
<h3 id="ingress-yaml-file"><a class="header-anchor" href="#ingress-yaml-file"></a>Ingress YAML FILE</h3>
<ul>
<li><code>Ingress.yaml</code>é‡Œé¢çš„ä¿¡æ¯ä¸å¯èƒ½å®Œå…¨åˆ—è¿™é‡Œï¼Œæœ‰ä»¥ä¸‹ä¸€äº›å…ƒç´ å’Œç±»å‹</li>
</ul>
<h3 id="ingress-rule"><a class="header-anchor" href="#ingress-rule"></a>Ingress Rule</h3>
<ul>
<li>è¿˜æœ‰ä¸ª<code>ingress-rules</code>çš„yamlæ–‡ä»¶ã€‚é‡Œé¢çš„å†…å®¹å¦‚ä¸‹ï¼š
<ul>
<li><code>Kind</code>: <code>Ingress</code> è¿™ä¸ª<code>rule</code>è§„åˆ™ï¼Œå“ªä¸ª<code>endPoint</code>è¿›å“ªä¸ª<code>deployment</code></li>
<li>æ¯ä¸ª<code>Ingress</code>éƒ½éœ€è¦é…ç½®<code>rules</code>ï¼Œç›®å‰<code>Kubernetes</code>ä»…æ”¯æŒ<code>http</code>è§„åˆ™ã€‚æ‰€ä»¥æœ€å…³é”®çš„å°±æ˜¯<code>rule</code></li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/hexo_blog/2020/01/09/Linux-Command/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/hexo_blog/2020/01/09/Linux-Command/" itemprop="url">Linux Command</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-01-09T09:43:08+08:00">
                2020-01-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>å·¥ä½œå¤šå¹´ï¼Œ<code>Linux</code>å‘½ä»¤æ˜¯æ—¶ä¸æ—¶è¦ç”¨åˆ°çš„ã€‚æ¯æ¬¡éƒ½æ˜¯ç™¾åº¦ä¹‹ï¼ˆè™½ç„¶ä¸æ˜¯çœŸçš„ç”¨çš„ç™¾åº¦:Pï¼‰ï¼Œè®°å½•åœ¨è¿™é‡Œï¼Œçœå¾—æ¯æ¬¡è¿˜å¾—å»æ‰¾</p>
<h2 id="awk"><a class="header-anchor" href="#awk"></a>AWK</h2>
<h3 id="å‚è€ƒé“¾æ¥"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h3>
<p>-<a href="https://www.cnblogs.com/ggjucheng/archive/2013/01/13/2858470.html" target="_blank" rel="noopener">linux awkå‘½ä»¤è¯¦è§£</a></p>
<ul>
<li><a href="https://www.cnblogs.com/dakewei/p/9848176.html" target="_blank" rel="noopener">ä½¿ç”¨awkåˆ†å‰²å­—ç¬¦ä¸²å¹¶ä¸”è·å–åˆ†å‰²åçš„æœ€åä¸€ä¸ªå­—ç¬¦ä¸²</a></li>
</ul>
<h3 id="å®ä¾‹"><a class="header-anchor" href="#å®ä¾‹"></a>å®ä¾‹</h3>
<p><code>awk</code> å…¶å®æ˜¯è¯»å…¥ä¸€è¡Œï¼Œè¿›è¡ŒæŸ¥æ‰¾ï¼Œå†è¿›è¡Œæ“ä½œã€‚å¯ä»¥é›†åˆ<code>SED</code>å’Œ<code>GREP</code>çš„ä½œç”¨ã€‚ä¸‹é¢ç”¨ä¾‹å­æ¥è¯´æ˜é—®é¢˜</p>
<ul>
<li><code>awk -F'-' '{print $1}'</code>
<ul>
<li>ç”¨<code>-</code>åšåˆ†éš”ç¬¦ï¼Œç„¶åå°†<code>-</code>åˆ†éš”ä¹‹åçš„ç¬¬ä¸€åˆ—æ•°æ®è¾“å‡ºå‡ºæ¥ã€‚</li>
<li>å¦‚æœæœ‰ç‰ˆæœ¬ï¼Œæ¯”å¦‚<code>2.0.1-SNAPSHOT</code>,è¿™ä¸ªè¯­å¥å°±å¯ä»¥å¾—åˆ°`2.0.``</li>
</ul>
</li>
<li><code>echo &quot;you-me-he&quot; |awk -F '[-]' '{print $NF}'</code>
<ul>
<li>è¿™æ¡å‘½ä»¤æ˜¯ç”¨<code>-</code>åˆ†éš”ä¹‹åï¼Œæ‰“å°åˆ†éš”åçš„æœ€åä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥è¾“å‡º<code>he</code></li>
</ul>
</li>
</ul>
<h2 id="sed"><a class="header-anchor" href="#sed"></a>SED</h2>
<h3 id="å®ä¾‹-v2"><a class="header-anchor" href="#å®ä¾‹-v2"></a>å®ä¾‹</h3>
<h2 id="æˆªå–å­—ç¬¦ä¸²çš„æ–¹æ³•"><a class="header-anchor" href="#æˆªå–å­—ç¬¦ä¸²çš„æ–¹æ³•"></a>æˆªå–å­—ç¬¦ä¸²çš„æ–¹æ³•</h2>
<h3 id="å‚è€ƒé“¾æ¥-v2"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥-v2"></a>å‚è€ƒé“¾æ¥</h3>
<p>-<a href="https://www.jb51.net/article/56563.htm" target="_blank" rel="noopener">Shellè„šæœ¬8ç§å­—ç¬¦ä¸²æˆªå–æ–¹æ³•æ€»ç»“</a></p>
<h3 id="å®ä¾‹-v3"><a class="header-anchor" href="#å®ä¾‹-v3"></a>å®ä¾‹</h3>
<ul>
<li><code>var=http://www.aaa.com/123.htm</code></li>
<li><code>echo ${var#*//}</code>
<ul>
<li><code>#</code> å·æ˜¯è¿ç®—ç¬¦ï¼Œ<code>*//</code> è¡¨ç¤ºä»å·¦è¾¹å¼€å§‹åˆ é™¤ç¬¬ä¸€ä¸ª <code>//</code> å·åŠå·¦è¾¹çš„æ‰€æœ‰å­—ç¬¦</li>
<li>æ‰€ä»¥è¿™æ ·çš„è¯ä¼šå°†<code>http://</code>éƒ½ç»™åˆ é™¤æ‰</li>
</ul>
</li>
<li><code>echo ${var##*/}</code>
<ul>
<li><code>##</code>æ˜¯è¿ç®—ç¬¦æŒ‡æœ€åä¸€ä¸ªï¼Œ<code>*/</code>è¡¨ç¤º<code>/</code>å’Œ<code>/</code>å·¦è¾¹çš„æ‰€æœ‰å­—ç¬¦ã€‚æ‰€ä»¥ä¸€ä¸ª<code>#</code>æ˜¯ç¬¬ä¸€ä¸ªï¼Œä¸¤ä¸ªæ˜¯æœ€åä¸€ä¸ªã€‚</li>
<li>è¿™å¥è¯ä¼šåˆ é™¤æœ€åä¸€ä¸ª<code>/</code>ä»¥åŠå·¦è¾¹çš„å­—ç¬¦ï¼Œ ç»“æœåªç•™ä¸‹äº†<code>123.htm</code></li>
</ul>
</li>
</ul>
<h2 id="åˆ¤æ–­æ–‡ä»¶"><a class="header-anchor" href="#åˆ¤æ–­æ–‡ä»¶"></a>åˆ¤æ–­æ–‡ä»¶</h2>
<h3 id="å‚è€ƒé“¾æ¥-v3"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥-v3"></a>å‚è€ƒé“¾æ¥</h3>
<ul>
<li><a href="https://www.cnblogs.com/37yan/p/6962563.html" target="_blank" rel="noopener">shellåˆ¤æ–­æ–‡ä»¶å­˜åœ¨</a></li>
</ul>
<h3 id="å®ä¾‹-v4"><a class="header-anchor" href="#å®ä¾‹-v4"></a>å®ä¾‹</h3>
<ul>
<li>
<p>åˆ¤æ–­æ–‡ä»¶å­˜åœ¨ä¸å¦</p>
<p>if [ ! -f â€œ/data/filenameâ€ ];then<br>
echo &quot;æ–‡ä»¶ä¸å­˜åœ¨&quot;<br>
else<br>
rm -f /data/filename<br>
fi</p>
</li>
<li>
<p>åˆ¤æ–­ç›®å½•å­˜åœ¨ä¸å¦ï¼šå°†<code>-f</code>æ¢æˆ<code>-d</code></p>
</li>
</ul>
<pre><code>if [ -d &quot;/data/&quot; ];then
echo &quot;æ–‡ä»¶å¤¹å­˜åœ¨&quot;
else
echo &quot;æ–‡ä»¶å¤¹ä¸å­˜åœ¨&quot;
fi
</code></pre>
<h2 id="å­—ç¬¦ä¸²æ“ä½œ"><a class="header-anchor" href="#å­—ç¬¦ä¸²æ“ä½œ"></a>å­—ç¬¦ä¸²æ“ä½œ</h2>
<h3 id="å­—ç¬¦ä¸²è¿æ¥"><a class="header-anchor" href="#å­—ç¬¦ä¸²è¿æ¥"></a>å­—ç¬¦ä¸²è¿æ¥</h3>
<ul>
<li>ç›´æ¥å†™åœ¨ä¸€èµ·å°±å¯ä»¥äº†</li>
</ul>
<h2 id="ç”Ÿæˆéšæœºå¯†ç "><a class="header-anchor" href="#ç”Ÿæˆéšæœºå¯†ç "></a>ç”Ÿæˆéšæœºå¯†ç </h2>
<h3 id="å‚è€ƒé“¾æ¥-v4"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥-v4"></a>å‚è€ƒé“¾æ¥</h3>
<ul>
<li><a href="https://www.cnblogs.com/EasonJim/p/9041957.html" target="_blank" rel="noopener">Linuxä¸‹ç”Ÿæˆéšæœºå¯†ç </a></li>
</ul>
<h3 id="å®ä¾‹-v5"><a class="header-anchor" href="#å®ä¾‹-v5"></a>å®ä¾‹</h3>
<ul>
<li><code>date +%s |sha256sum |base64 |head -c 32 ;echo</code> è¿™æ ·çš„è¯è¯´æ˜¯æ ¹æ®å½“å‰æ—¶é—´æ¥ç®—çš„ã€‚æ‰€ä»¥å®‰å…¨æ€§å…¶å®å¾ˆé«˜å•Š</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/hexo_blog/2019/12/06/å„ç±»é—®é¢˜è§£å†³/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/hexo_blog/2019/12/06/å„ç±»é—®é¢˜è§£å†³/" itemprop="url">Problems During Working</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-12-06T13:53:11+08:00">
                2019-12-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>å¼€ä¸ªæ–°åšå®¢ï¼Œæ¥è®°å½•å·¥ä½œè¿‡ç¨‹ä¸­ç¢°åˆ°çš„å„ç§å„ç±»çš„å°é—®é¢˜ã€‚</p>
<h2 id="env"><a class="header-anchor" href="#env"></a>ENV</h2>
<p>è¿™ä¸ªç« èŠ‚ä¸»è¦æ˜¯åŒ…æ‹¬ç¼–è¯‘å•Šï¼Œç‰ˆæœ¬æ§åˆ¶å•Šï¼ŒIDEå•Šä¹‹ç±»çš„å°é—®é¢˜</p>
<h3 id="ij"><a class="header-anchor" href="#ij"></a>IJ</h3>
<h4 id="command-too-long-error"><a class="header-anchor" href="#command-too-long-error"></a>command too long error</h4>
<ul>
<li>
<p>ä»Šå¤©å°è¯•è·‘Junitï¼Œç»“æœIJæŠ¥é”™ï¼Œè¯´æˆ‘å‘½ä»¤è¡Œå¤ªé•¿ï¼š</p>
<pre><code>Error running 'xxxxxxx': Command line is too long. Shorten command line for xxxxxxx or also for JUnit default configuration.
</code></pre>
</li>
<li>
<p>è§£å†³æ–¹æ³•æ˜¯åœ¨Runâ€¦çš„é…ç½®é‡Œé¢ï¼Œæœ‰ä¸€ä¸ª<code>shorten command line</code>é€‰é¡¹ï¼Œé€‰æˆ<code>classpath file</code>ï¼Œè¿™æ ·å°±å¯ä»¥äº†ã€‚</p>
</li>
<li>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<ul>
<li><a href="https://blog.jetbrains.com/idea/2017/10/intellij-idea-2017-3-eap-configurable-command-line-shortener-and-more/" target="_blank" rel="noopener">configurable-command-line-shortener</a></li>
<li><a href="https://stackoverflow.com/questions/47926382/how-to-configure-shorten-command-line-method-for-whole-project-in-intellij/47927544" target="_blank" rel="noopener">how-to-configure-shorten-command-line</a></li>
</ul>
</li>
</ul>
<h4 id="output-path-same"><a class="header-anchor" href="#output-path-same"></a>Output path same</h4>
<ul>
<li>ç¼–è¯‘<code>scala</code>é¡¹ç›®çš„æ—¶å€™æŠ¥çš„é”™è¯¯ã€‚æ„æ€æ˜¯è¾“å‡ºè·¯å¾„ä¸€æ ·ã€‚æ”¹ä¸€ä¸‹<code>module</code>çš„è¾“å‡ºè·¯å¾„å°±å¯ä»¥äº†ã€‚å¥‡æ€ªçš„æ˜¯ï¼Œä¸ºå•¥ä¼šä¸€æ ·å•Šã€‚</li>
<li><a href="https://stackoverflow.com/questions/18920334/output-path-is-shared-between-the-same-module-error/21418406#21418406" target="_blank" rel="noopener">output-path-is-shared</a></li>
</ul>
<h4 id="error-failed-to-load-project-configuration-cannot-parse-file-xxx-idea-workspace-xml-parseerror-at-row-col-1-1-message-content-is-not-allowed-in-prolog"><a class="header-anchor" href="#error-failed-to-load-project-configuration-cannot-parse-file-xxx-idea-workspace-xml-parseerror-at-row-col-1-1-message-content-is-not-allowed-in-prolog"></a>Error:Failed to load project configuration: cannot parse file xxx.idea\workspace.xml: ParseError at [row,col]:[1,1] Message: Content is not allowed in prolog.</h4>
<ul>
<li>å¤§è‡´å«ä¹‰å°±æ˜¯è¿™ä¸ªæ–‡ä»¶åäº†æŒ‰ç…§stackoverflowä¸Šé¢çš„ï¼Œå…ˆåˆ é™¤è¿™ä¸ªæ–‡ä»¶ï¼Œå†ç‚¹å‡»â€œ started 'Invalid Caches/Restart&quot; under â€œFileâ€.â€å°±å¯ä»¥è§£å†³é—®é¢˜äº†</li>
<li><a href="https://stackoverflow.com/questions/29604148/workspace-xml-file-corrupted-error-on-line-1-content-is-not-allowed-in-prolog" target="_blank" rel="noopener">workspace-xml-file-corrupted</a></li>
</ul>
<h3 id="git"><a class="header-anchor" href="#git"></a>GIT</h3>
<h4 id="filename-too-long-error"><a class="header-anchor" href="#filename-too-long-error"></a>filename too long error</h4>
<ul>
<li>æ”¹ä¸€ä¸‹<code>GIT</code>çš„é…ç½®å°±å¯ä»¥äº†</li>
<li><code>git config --system core.longpaths true</code></li>
<li><a href="https://ourcodeworld.com/articles/read/109/how-to-solve-filename-too-long-error-in-git-powershell-and-github-application-for-windows" target="_blank" rel="noopener">how-to-solve-filename-too-long-error</a></li>
</ul>
<h3 id="vim"><a class="header-anchor" href="#vim"></a>VIM</h3>
<h4 id="å…¨å±€æ›¿æ¢"><a class="header-anchor" href="#å…¨å±€æ›¿æ¢"></a>å…¨å±€æ›¿æ¢</h4>
<ul>
<li><code>:%s/vivian/sky/g</code>: æ›¿æ¢æ¯ä¸€è¡Œä¸­æ‰€æœ‰<code>vivian</code> ä¸º<code>sky</code></li>
<li><a href="http://blog.sina.com.cn/s/blog_736f1c59010136ry.html" target="_blank" rel="noopener">vimæ›¿æ¢å˜é‡</a></li>
</ul>
<h2 id="java"><a class="header-anchor" href="#java"></a>Java</h2>
<h3 id="mock"><a class="header-anchor" href="#mock"></a>Mock</h3>
<h4 id="checked-exception-is-invalid-for-this-method"><a class="header-anchor" href="#checked-exception-is-invalid-for-this-method"></a>Checked exception is invalid for this method!</h4>
<ul>
<li>ç”¨<code>thenThrow</code>æ—¶å€™æŠ¥äº†è¿™ä¸ªé”™è¯¯ï¼Œè¿™ä¸ªé”™è¯¯çš„å«ä¹‰å…¶å®æ˜¯è°ƒç”¨çš„å‡½æ•°å¹¶æ²¡æœ‰æŠ›å‡ºæ¨¡æ‹Ÿçš„è¿™ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥æ¨¡æ‹Ÿä¸èµ·æ¥</li>
<li>æˆ‘è‡ªå·±æ˜¯å› ä¸ºåœ¨<code>scala</code>é‡Œé¢å¤–é¢åŒ…äº†ä¸€å±‚</li>
</ul>
<h2 id="cassandra"><a class="header-anchor" href="#cassandra"></a>Cassandra</h2>
<h3 id="cassandra-was-never-started"><a class="header-anchor" href="#cassandra-was-never-started"></a>Cassandra was never started</h3>
<ul>
<li>è¿™ä¸ªé—®é¢˜æ˜¯åœ¨è§£å†³PODä¸æ–­é‡å¯çš„é—®é¢˜çš„è¿‡ç¨‹ä¸­é‡åˆ°çš„ã€‚</li>
<li>é—®é¢˜çš„æ ¹æºå…¶å®å°±æ˜¯Cassandraçš„ç‰ˆæœ¬è¢«æ›¿æ¢äº†ï¼Œç”¨æˆ·å’Œå¯†ç ä¹Ÿæ¢æ‰äº†</li>
<li>å‚è€ƒé“¾æ¥ï¼š
<ul>
<li>
<p><a href="https://docs.datastax.com/en/developer/java-driver/3.1/manual/custom_codecs/extras/" target="_blank" rel="noopener">time codecs</a></p>
<p>2020-03-26 10:39:08,280+0100 [vent Dispatcher] WARN  [com.datastax.driver.core.CodecRegistry] Ignoring codec InstantCodec [timestamp &lt;-&gt; java.time.Instant] because it collides with previously registered codec InstantCodec [timestamp &lt;-&gt; java.time.Instant]</p>
</li>
</ul>
</li>
</ul>
<h2 id="docker"><a class="header-anchor" href="#docker"></a>Docker</h2>
<h3 id="docker-login"><a class="header-anchor" href="#docker-login"></a>docker login</h3>
<pre><code> $ docker login XXXXX
    Authenticating with existing credentials...
    Stored credentials invalid or expired
    Error: Cannot perform an interactive login from a non TTY device
</code></pre>
<ul>
<li>è¿™æ˜¯ç”±äºå¯†ç æ›´æ¢äº†ä¹‹ååŸæœ‰å¯†ç ä¸å¯¹é€ æˆçš„é—®é¢˜ã€‚åŠ ä¸ª<code>-u username -p password</code>å°±èƒ½å¤Ÿè§£å†³</li>
<li>ä¹Ÿå¯ä»¥è®¾ç½®ç¯å¢ƒå˜é‡æ¥è§£å†³<code>DOCKER_USERNAME DOCKER_PASSWORD</code></li>
<li>å‚è€ƒé“¾æ¥ï¼š <a href="https://community.atlassian.com/t5/Bitbucket-questions/Piplenes-docker-login-can-not-perform-an-interactive-login-from/qaq-p/595736" target="_blank" rel="noopener">docker login can not perform an interactive login from a non TTY</a></li>
</ul>
<h3 id="docker-demon"><a class="header-anchor" href="#docker-demon"></a>docker demon</h3>
<pre><code>error during connect: Get http://%2F%2F.%2Fpipe%2Fdocker_engine/v1.25/version: open //./pipe/docker_engine: The system cannot find the file
specified. In the default daemon configuration on Windows, the docker client must be run elevated to connect. This error may also indicate that the docker daemon is not running.
</code></pre>
<ul>
<li><code>&quot;C:\Program Files\Docker\Docker\DockerCli.exe&quot; -SwitchDaemo</code></li>
<li>å¹¶æ²¡æœ‰ç ”ç©¶åŸç†å•¦</li>
<li>å‚è€ƒé“¾æ¥ï¼š<a href="https://stackoverflow.com/questions/40459280/docker-cannot-start-on-windows" target="_blank" rel="noopener">docker cannot start on windows</a></li>
</ul>
<h3 id="docker-image-æ²¡æœ‰åå­—"><a class="header-anchor" href="#docker-image-æ²¡æœ‰åå­—"></a>docker image æ²¡æœ‰åå­—</h3>
<ul>
<li>
<p><code>docker build</code>å‡ºæ¥çš„<code>image</code>æ²¡æœ‰åå­—ï¼Œéœ€è¦åœ¨å‘½ä»¤è¡ŒæŒ‡å®š</p>
<pre><code>docker build -t image_name
</code></pre>
</li>
<li>
<p>å‚è€ƒé“¾æ¥</p>
<ul>
<li><a href="https://stackoverflow.com/questions/38986057/how-to-set-image-name-in-dockerfile" target="_blank" rel="noopener">how-to-set-image-name-in-dockerfile</a></li>
</ul>
</li>
</ul>
<h3 id="docker-for-desktop-å®‰è£…"><a class="header-anchor" href="#docker-for-desktop-å®‰è£…"></a>docker for desktop å®‰è£…</h3>
<ul>
<li>å®‰è£…æ—¶å€™ä¸€ç›´æç¤º<code>dockerd</code>æ–‡ä»¶è¢«<code>windows event log</code>å ç”¨äº†ã€‚ä½†æ˜¯æŒ‰ç…§å„ç§<code>windows</code>çš„æ–¹æ³•éƒ½æ‰¾ä¸åˆ°ï¼Œæœ€åä»<code>gitbash</code>å¼ºåˆ¶åˆ é™¤æ‰æ–‡ä»¶å†å®‰è£…å°±å¥½äº†ã€‚</li>
</ul>
<h3 id="docker-for-desktop-å¦‚ä½•å®‰è£…dashboard"><a class="header-anchor" href="#docker-for-desktop-å¦‚ä½•å®‰è£…dashboard"></a>docker for desktop å¦‚ä½•å®‰è£…Dashboard</h3>
<ul>
<li>å®‰è£…<code>k8s</code>çš„<code>dashboard</code>ï¼š
<ul>
<li>ä½¿ç”¨â€œdocker for desktopâ€œçš„æ—¶å€™ï¼Œè¿™ä¸ª<code>dashboard</code>è²Œä¼¼ä¸æ˜¯äº‹å…ˆè£…å¥½çš„ã€‚å°è±¡ä¸æ·±åˆ»äº†ã€‚éœ€è¦è£…ä¸€ä¸‹ï¼š</li>
<li><code>kubectl create -f https://raw.githubusercontent.com/kubernetes/dashboard/master/src/deploy/recommended/kubernetes-dashboard.yaml</code></li>
<li><code>kubectl proxy</code> å†å°†<code>proxy</code>ç»™å¼„å‡ºæ¥ï¼Œå°±å¯ä»¥è®¿é—®äº†ã€‚</li>
<li>å¦‚ä¸‹å›¾ï¼š<br>
<img src="https://user-images.githubusercontent.com/5803001/34945022-c57b369a-fa3c-11e7-85e7-83f716d10705.png" alt></li>
<li>å‚è€ƒé“¾æ¥ç™»å½•ï¼š
<ul>
<li><a href="https://segmentfault.com/a/1190000012850396" target="_blank" rel="noopener">configç™»å½•æ–¹å¼</a></li>
<li><a href="https://www.cnblogs.com/guigujun/p/8366530.html" target="_blank" rel="noopener">configç™»å½•æ–¹å¼2</a></li>
<li><a href="https://www.cnblogs.com/jackyfei/p/10180465.html" target="_blank" rel="noopener">tokenæ–¹å¼ç™»å½•</a></li>
</ul>
</li>
<li>è·å–tokençš„å‘½ä»¤ï¼š<code>kubectl -n kube-system describe secret $(kubectl -n kube-system get secret | grep admin-user | awk '{print $1}')</code></li>
</ul>
</li>
</ul>
<h2 id="k8s"><a class="header-anchor" href="#k8s"></a>K8S</h2>
<h3 id="è¿ä¸ä¸Šk8s"><a class="header-anchor" href="#è¿ä¸ä¸Šk8s"></a>è¿ä¸ä¸ŠK8S</h3>
<pre><code>$ kubectl cluster-info
Kubernetes master is running at ...
To further debug and diagnose cluster problems, use 'kubectl cluster-info dump'.
Unable to connect to the server: x509: certificate signed by unknown authority (possibly because of &quot;crypto/rsa: verification error&quot; while trying to verify candidate authority certificate &quot;kubernetes&quot;)
</code></pre>
<ul>
<li>å‚è€ƒé“¾æ¥ï¼š<a href="https://blog.csdn.net/baobaoxiannv/article/details/83818426" target="_blank" rel="noopener">csdnåšå®¢ä¸€ç¯‡</a></li>
<li>å…¶å®å°±æ˜¯<code>kube</code>çš„<code>config</code>æ–‡ä»¶: <code>~/.kube/config</code> æ–‡ä»¶è¿‡æ—¶äº†ã€‚é‡Œé¢çš„<code>certification</code>éœ€è¦æ›´æ–°ã€‚ä»<code>kube server</code>ä¸Šé¢æŠŠ<code>config</code>æ‹¿ä¸‹æ¥æ›¿æ¢ä¸€äº›æœ¬åœ°çš„å°±å¥½äº†ã€‚</li>
</ul>
<h3 id="k8sçš„nodeport-serviceå‡ºé”™"><a class="header-anchor" href="#k8sçš„nodeport-serviceå‡ºé”™"></a>K8sçš„NodePort Serviceå‡ºé”™</h3>
<h5 id="nodeport-serviceçš„nodeportæ— æ³•è®¿é—®"><a class="header-anchor" href="#nodeport-serviceçš„nodeportæ— æ³•è®¿é—®"></a>NodePort Serviceçš„NodePortæ— æ³•è®¿é—®</h5>
<ul>
<li>åœ¨å·¥ä½œä¸­ç¢°åˆ°ä¸€ä¸ªé—®é¢˜ã€‚<code>NodePort</code>çš„<code>NodePort</code>æ— æ³•è®¿é—®ï¼Œåªæœ‰æˆ‘ç»„å¼€å‘çš„ä¸€ä¸ªæœåŠ¡æœ‰é—®é¢˜ï¼Œå…¶ä»–æœåŠ¡éƒ½æ˜¯OKçš„
<ul>
<li>å†…éƒ¨æœåŠ¡ä½¿ç”¨<code>clusterIP:internalPort</code>è®¿é—®æ²¡æœ‰é—®é¢˜</li>
<li>å¤–éƒ¨æœºå™¨æ— æ³•è®¿é—®</li>
<li>å„ä¸ªæœºå™¨ä¸Šé¢çš„ç«¯å£å·²ç»å®Œå…¨å¼€å¥½äº†</li>
<li>åªæœ‰æœ¬æœºå¯ä»¥ä½¿ç”¨<code>NodeIP:NodePort</code>è®¿é—®åˆ°æœåŠ¡,ä¹Ÿå°±æ˜¯<code>deployment</code>èµ·æˆ–è€…<code>pod</code>èµ·çš„é‚£å°æœºå™¨å¯ä»¥è®¿é—®æœåŠ¡</li>
<li>åªæœ‰ä¸€å¥—ç¯å¢ƒæœ‰é—®é¢˜ï¼Œå¦å¤–ä¸€å¥—ç¯å¢ƒæ²¡æœ‰é—®é¢˜ã€‚æœ‰é—®é¢˜çš„ç¯å¢ƒä¸Šé¢æœ‰<code>kube-proxy</code>æœåŠ¡ï¼Œè€Œå¦ä¸€å¥—å¹¶æ²¡åœ¨<code>kube-system</code>ä¸‹é¢æ‰¾åˆ°<code>kube-proxy</code></li>
</ul>
</li>
<li>å…ˆè¯´ç»“è®ºï¼Œæœ€åå‘ç°æ˜¯ç”±äºåœ¨æˆ‘å›½æŠµæŠ—ç–«æƒ…æœŸé—´ï¼Œå›½å¤–å‹äººåŠ äº†<code>NetworkPolicy</code>å¯¼è‡´çš„ï¼Œéœ€è¦åœ¨æœåŠ¡çš„<code>deployment</code>é‡Œé¢åŠ ä¸Šä¸€ä¸ªæ ‡å‡†ä½ï¼Œè€Œæ·»åŠ çš„ç½‘ç»œè§„åˆ™ä¼šæ ¹æ®è¿™ä¸ªæ ‡å‡†ä½æ¥æ”¾è¡Œæˆ–è€…é˜»æ‹¦<code>traffic</code>
<ul>
<li>ä½¿ç”¨<code>kubectl get networkpolicy</code>å¯ä»¥çœ‹åˆ°è®¾ç½®çš„ç½‘ç»œè§„åˆ™ï¼Œä½¿ç”¨<code>describe</code>å‘½ä»¤å¯ä»¥çœ‹åˆ°è¯¦ç»†çš„ä¿¡æ¯ï¼Œå¦‚ä¸‹ï¼Œæ‰€ä»¥éœ€è¦åŠ ä¸Šè¿™ä¸ªæ ‡å¿—ä½ï¼ˆåœ¨deploymentçš„labelsé‡Œé¢ã€‚ï¼‰</li>
<li>åç»­éœ€è¦è¿›ä¸€æ­¥å­¦ä¹ <code>NetworkPolicy</code>ç›¸å…³çŸ¥è¯†</li>
</ul>
</li>
</ul>
<pre><code>   Spec:
	PodSelector:     allowTraffic=true
</code></pre>
<ul>
<li>è¿™è¾¹æ¥çœ‹è§£å†³åˆ†æè¿‡ç¨‹ã€‚
<ul>
<li>ç”±äºä¸¤å¥—ç¯å¢ƒä¸Šä¸€å¥—æ˜¯å·¥ä½œçš„ç¬¬ä¸€ååº”æ˜¯ä¸¤å¥—æœºå™¨çš„å·®å¼‚ï¼Œå¹¶ä¸”è¿˜æœ‰ä¸€ä¸ªä¿¡æ¯æ˜¯æ˜¥èŠ‚å‰æ˜¯å·¥ä½œçš„ï¼Œæ˜¥èŠ‚åæ˜¯ä¸å·¥ä½œçš„ã€‚ä½†æ˜¯ç”±äºæœºå™¨å¹¶ä¸æ˜¯æˆ‘ä»¬è‡ªå·±æ­çš„ï¼Œåªèƒ½çŒœæµ‹æ˜¯ç¯å¢ƒæ”¹å˜äº†ã€‚</li>
<li><code>kube-proxy</code> å‡ºé—®é¢˜äº†ï¼Œå› ä¸ºæ‰€æœ‰çš„<code>clusterIP</code>æ˜¯å¥½çš„ï¼Œé‚£ä¹ˆçŒœæµ‹æ˜¯ä¸­é—´çš„è½¬å‘è¿‡ç¨‹å‡ºé—®é¢˜äº†ï¼Œäºæ˜¯æŸ¥è¯¢çœ‹çœ‹åŒä¸€ä¸ª<code>node</code>ä¸Šé¢çš„<code>kube-proxy</code>çš„æ—¥å¿—ï¼Œäº‹å®ä¸Šæ²¡æœ‰ä»»ä½•é”™è¯¯ã€‚è¿™è¾¹æœ‰å‡ ä¸ªä¿¡æ¯ï¼Œå³ä½¿åœ¨æ—¥å¿—é‡Œé¢çœ‹åˆ°äº†ç«¯å£è¢«å ç”¨çš„æ—¥å¿—ï¼Œä¹Ÿå¹¶æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Œåœ¨æµ‹è¯•ä¸­ï¼Œä¸åœåœ°å¯åœ<code>service</code>å°±å¯èƒ½è§¦å‘è¿™ä¸ªæ—¥å¿—ã€‚</li>
<li>åœ¨æ’é™¤æ‰<code>kube-proxy</code>ä¹‹åï¼Œå°±æ€€ç–‘æ˜¯<code>iptables</code>çš„é”™è¯¯ã€‚å‚è€ƒä»¥ä¸‹é“¾æ¥ï¼Œç¡®å®åœ¨<code>iptables</code>å‡ºç°é—®é¢˜çš„æ—¶å€™å¯èƒ½å‘ç”Ÿç±»ä¼¼çš„é”™è¯¯ï¼š</li>
<li>å‚è€ƒé“¾æ¥ï¼š<a href="https://stackoverflow.com/questions/46667659/kubernetes-cannot-access-nodeport-from-other-machines" target="_blank" rel="noopener">k8sçš„nodeportæ— æ³•ä»å…¶ä»–æœºå™¨è®¿é—®</a></li>
<li><a href="https://www.myf5.net/post/2343.htm" target="_blank" rel="noopener">NodePort Serviceçš„è¯·æ±‚æœªè¢«åˆ†å‘åˆ°å„ä¸ªnodeçš„æ’é”™</a></li>
<li>äºæ˜¯çœ‹äº†ä¸€æ•´å¤©çš„<code>iptables</code>ã€‚ç”±äºæ—¶é—´ç´§è¿«ï¼Œå¹¶æœªèƒ½çœ‹åˆ°å…¨è²Œï¼Œåç»­ä¼šæ–°å¼€ä¸€ç¯‡åšå®¢æ¥è¡¥ã€‚äº‹å®ä¸Šï¼Œ<code>NodePort</code>æœåŠ¡ç±»å‹åªæ¯”<code>ClusterIP</code>ç±»å‹å¤šä¸¤æ¡è§„åˆ™</li>
<li>è€Œåœ¨æ•´ä¸ª<code>ipTables</code>é‡Œé¢ï¼Œå¯ä»¥å¾ˆæ¸…æ™°åœ°çœ‹åˆ°æ•´ä¸ªé“¾è·¯ï¼Œä¸€ç›´è½¬åˆ°<code>endpoint</code>ä¸Šé¢ã€‚å°½ç®¡é‡Œé¢ä¹Ÿæœ‰ä¸Šè¿°ä¸¤ä¸ªé“¾æ¥ä¸­æåˆ°çš„<code>Docker</code>ç›¸å…³çš„è§„åˆ™ï¼Œå´ä¸æ˜¯åœ¨<code>filter</code>è¿‡æ»¤è¡¨é‡Œé¢ã€‚è€Œæ˜¯åœ¨<code>NAT</code>è½¬å‘è¡¨é‡Œï¼Œæ‰€ä»¥æŒ‰ç…§é“¾è·¯æ¥çœ‹ï¼Œä»<code>NodePort</code>è¿›å»çš„è¯·æ±‚æœ€åç¡®å®è½¬å‘åˆ°äº†<code>endpoint</code>ï¼Œå¹¶æ²¡æœ‰åˆ°<code>Docker</code>é‡Œé¢ã€‚äº‹å®ä¸Šï¼Œæˆ‘å°è¯•åœ¨<code>IpTables</code>é‡Œé¢åŠ ä¸Šäº†é“¾æ¥ä¸­çš„è·¯ç”±ï¼Œå¹¶æœªç”Ÿæ•ˆã€‚</li>
<li>åœ¨ç ”ç©¶äº†ä¸€å¤©<code>iptables</code>ä¹‹åï¼Œè½¬åˆ°äº†æ¯”è¾ƒç”Ÿç¡¬ä¸€äº›å´å¯èƒ½æ›´æœ‰æ•ˆçš„åŠæ³•ï¼š</li>
<li>ç ”ç©¶å…¶ä»–æœåŠ¡çš„ä»£ç æ”¹åŠ¨ã€‚äº‹å®ä¸Šï¼Œè‚¯å®šæ˜¯æœ‰åŠ å…¥è¿™ä¸ªæ ‡å¿—ä½çš„ï¼Œä½†æ˜¯ç”±äºå’Œä¸€äº›ç±»ä¼¼æ ¼å¼çš„æ”¹åŠ¨åœ¨ä¸€èµ·ï¼Œæ²¡çœ‹å‡ºæ¥</li>
<li>æŸ¥è¯¢ä»å“ªä¸€å¤©å¼€å§‹å‡ºç°äº†é—®é¢˜ã€‚ä¸‡å¹¸å·²ç»çŸ¥é“2æœˆ6å·çš„åŒ…æœ‰é—®é¢˜ï¼Œå¹´å‰æ˜¯å¥½çš„ï¼Œä¸­é—´å¹¶æœªå·®å‡ å¤©ã€‚åœ¨æ•°æ¬¡è£…åŒ…å¸è½½ä¹‹åå‘ç°äº†æ—¶é—´ç‚¹ã€‚å†æ¯”è¾ƒä¸¤ä¸ªåŒ…çš„å·®å¼‚ï¼Œå‘ç°äº†è¿™ä¸ª<code>NetworkPolicy</code>çš„å¢åŠ </li>
</ul>
</li>
</ul>
<h3 id="podä¸æ–­é‡å¯"><a class="header-anchor" href="#podä¸æ–­é‡å¯"></a>PODä¸æ–­é‡å¯</h3>
<ul>
<li>ä»æ—§æ˜¯ä¸Šä¸€ä¸ªé—®é¢˜ç›¸åŒçš„é¡¹ç›®å‡ºçš„é—®é¢˜ï¼Œè¿™ä¸ªé¡¹ç›®æ€ä¹ˆè¿™ä¹ˆéš¾å‘¢ ğŸ˜¦</li>
<li>ç”±äºè¿™ä¸ªé¡¹ç›®æ˜¯æ¶æ„åœ¨<code>OSGI</code>ä¸Šé¢çš„ï¼Œè¿›å…¥<code>OSGI</code>å‘ç°æœ‰ä¸€ä¸ª<code>AKKA</code>ç›¸å…³çš„<code>bundle</code>çš„çŠ¶æ€ä¸å¯¹ï¼Œä¸æ˜¯<code>ACTIVE</code>ï¼Œè€Œæ˜¯<code>RESOLVED</code>ï¼Œç¬¬ä¸€ååº”å°±æ˜¯æˆ‘åœ¨å‰ä¸€å‘¨åšçš„æ”¹åŠ¨ä¸å¯¹ã€‚å› ä¸ºåœ¨å‰ä¸€å¤©æˆ‘è¿›è¡Œäº†<code>IPV6</code>çš„æ”¹åŠ¨ï¼Œä½†æ˜¯å¹¶ä¸å·¥ä½œã€‚</li>
<li>äºæ˜¯å›æ»šæ‰<code>IPV6</code>çš„æ”¹åŠ¨ï¼Œå›æ»šæ‰å†ä¹‹å‰çš„<code>AKKA service</code>ç›¸å…³çš„æ”¹åŠ¨ï¼Œç„¶å¹¶åµï¼Œè¿™æ—¶å€™ä¹Ÿå·²ç»å‘¨äº”æ™šä¸Š12ç‚¹äº†ã€‚åªèƒ½ä½œç½¢</li>
</ul>
<h4 id="ä¸ºä½•æ²¡èƒ½å¤Ÿæ›´æ—©çš„å‘ç°é—®é¢˜"><a class="header-anchor" href="#ä¸ºä½•æ²¡èƒ½å¤Ÿæ›´æ—©çš„å‘ç°é—®é¢˜"></a>ä¸ºä½•æ²¡èƒ½å¤Ÿæ›´æ—©çš„å‘ç°é—®é¢˜</h4>
<ul>
<li><code>POD</code>å¹¶ä¸æ˜¯èµ·ä¸æ¥ï¼Œç„¶åä¸€ç›´é‡å¯ï¼Œè€Œæ˜¯åœ¨èµ·æ¥ä¸€æ®µæ—¶é—´ï¼Œå¤§çº¦10æ¥åˆ†é’Ÿçš„æ—¶å€™ä¼šé‡å¯ï¼Œæ‰€ä»¥ä¸€ç›´æ²¡æœ‰è¢«å‘ç°ã€‚è¿™ç‚¹æ˜¯ä¸€ä¸ªæ”¹å˜ï¼Œåç»­éœ€è¦æ³¨æ„ã€‚</li>
<li>æµ‹è¯•æ–¹æ³•çš„é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨æµ‹è¯•çš„æ—¶å€™å› ä¸ºåªæ˜¯åŠŸèƒ½å‘å¸ƒä¹‹åçš„å›å½’æµ‹è¯•ï¼Œä»…ä»…æµ‹è¯•äº†ç«¯å£æ˜¯ä¸æ˜¯é€šã€‚è¿™æ ·å¾ˆå¿«ï¼Œä½†æ˜¯ä¹Ÿå°±æµ‹ä¸åˆ°é—®é¢˜äº†ã€‚</li>
</ul>
<h4 id="å‘¨æœ«è°ƒè¯•"><a class="header-anchor" href="#å‘¨æœ«è°ƒè¯•"></a>å‘¨æœ«è°ƒè¯•</h4>
<ul>
<li>å‘¨æœ«çš„æ—¶å€™å’Œä¸Šä¸€æ¬¡è°ƒè¯•ä¸ä¸€æ ·çš„æ˜¯ï¼Œä¸Šæ¥å°±é€‰æ‹©äº†å„ç§è£…åŒ…å’Œå¯¹æ¯”ï¼Œæœ€åå‘ç°3æœˆ9å·çš„åŒ…æ˜¯OKçš„ï¼Œè€Œ12å·çš„å°±æŒ‚äº†</li>
<li>åœ¨è¿™ä¹‹é—´ï¼Œæœ€å¤§çš„æ”¹åŠ¨æ˜¯<code>Cassandra</code>æ”¹åŠ¨ï¼Œè¿™ä¸ªæ”¹åŠ¨ç›´æ¥å¯¼è‡´äº†10å·11å·çš„åŒ…éƒ½æ˜¯åçš„ã€‚</li>
<li>ç„¶åå†ä¸€æ¬¡ï¼Œæˆ‘ä»¬è¿™ä¸ªé¡¹ç›®åˆè¢«å›½å¤–å‹äººç»™æ¼æ‰äº†</li>
<li>ä½†æ˜¯å¥‡ç‰¹çš„æ˜¯ï¼ŒæŒ‰ç…§å¯¹æ¯”ä¹‹åï¼Œæˆ‘ä»¬åº”è¯¥è¿ä¸ä¸Š<code>Cassandra</code>äº†æ‰å¯¹ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œæ•´ä¸ª<code>pod</code>èµ·æ¥çš„æ—¶å€™ï¼Œ<code>OSGI</code>çš„æœåŠ¡ä¼šæœ€å…ˆæ£€æŸ¥æ•°æ®åº“å®‰è£…ï¼Œå¹¶æœªæŠ¥é”™ï¼Œæ‰€ä»¥è¿™ç‚¹å¾ˆæ˜¯å¥‡ç‰¹ã€‚åœ¨è§£å†³é—®é¢˜åå‘ç°ï¼Œåº”è¯¥æ˜¯åˆ›äº†ä¸åŒçš„<code>user</code>ï¼Œ<code>super user</code>ä»æ—§æ˜¯å­˜åœ¨çš„ã€‚æ‰€ä»¥è¿æ¥å¹¶æœªæŠ¥é”™ï¼Œä½†æ˜¯å®é™…çš„æœåŠ¡å´ä¸å¯¹äº†</li>
<li>å¯¹æ¯”åŒ…æ— æ•ˆä¹‹åï¼Œå›åˆ°æœ€åˆçš„é—®é¢˜ä¸Šé¢ï¼Œä¸ºä»€ä¹ˆ<code>POD</code>ä¼šè‡ªåŠ¨é‡å¯</li>
</ul>
<h4 id="k8s-podé‡å¯"><a class="header-anchor" href="#k8s-podé‡å¯"></a>K8S PODé‡å¯</h4>
<ul>
<li>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªå‘½ä»¤ï¼š <code>kubectl get events</code>,ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å¯ä»¥çœ‹åˆ°<code>POD</code>çš„äº‹åŠ¡ï¼š</p>
<pre><code>$ kubectl get events
LAST SEEN   TYPE   REASON  OBJECT      MESSAGE
&lt;unknown&gt;   Normal    Scheduled                         pod/xxxxxxx Successfully assigned &lt;namespace&gt;/xxxxxx to node-10-41-82-7
</code></pre>
</li>
<li>
<p>è¿™æ ·å¯ä»¥æ¸…æ™°çœ‹åˆ°<code>pod</code>ç”±äºè¿ä¸ä¸Š<code>AKKA</code>æœåŠ¡çš„<code>2929</code>ç«¯å£è€Œé‡å¯ï¼Œä¹Ÿå°±æ˜¯<code>liveness</code>æ¡ä»¶ä¸æ»¡è¶³äº†ï¼Œæ‰€ä»¥<code>K8S</code>å°±æ¬¢å¿«åœ°æŠŠ<code>POD</code>æ€æ‰äº†ã€‚</p>
</li>
<li>
<p>ç„¶åè¿˜æœ‰ä¸€ä¸ªæœ‰ç”¨çš„å‘½ä»¤æ˜¯<code>kubectl logs -p &lt;podName&gt;</code>è¿™æ¡å‘½ä»¤å¯ä»¥å¸®åŠ©æˆ‘ä»¬çœ‹åˆ°è¢«æ€çš„å‰ä¸€ä¸ªpodçš„æ—¥å¿—ï¼Œæ¯•ç«Ÿæˆ‘ä»¬çœ‹çš„å½“æ—¶ï¼Œå‰ä¸€ä¸ªpodå¯èƒ½å·²ç»è¢«å¹²æ‰äº†</p>
</li>
</ul>
<h4 id="åˆ†æ"><a class="header-anchor" href="#åˆ†æ"></a>åˆ†æ</h4>
<ul>
<li>
<p>é—®é¢˜æœ‰äºŒï¼Œ<code>2929</code>ç«¯å£èµ·ä¸æ¥ï¼Œ<code>OSGI bundle</code>èµ·ä¸æ¥ï¼Œä¹Ÿå¯èƒ½æœ€åéƒ½æ˜¯<code>Cassandra</code>å¯¼è‡´çš„ã€‚åœ¨è§£å†³ä¹‹åï¼Œäº‹å®è¯æ˜åä¸€ä¸ªé—®é¢˜ç¡®å®æ˜¯ï¼Œå‰ä¸€ä¸ªå¹¶ä¸æ˜¯ã€‚</p>
</li>
<li>
<p>è€Œä¸”ä¸¤è€…éƒ½å’Œ<code>AKKA</code>æœåŠ¡ç›¸å…³ï¼Œä½†æ˜¯<code>AKKA</code>å’Œ<code>Cassandra</code>æœ‰ä¸ªæ¯›çº¿ç›¸å…³æ€§ã€‚</p>
</li>
<li>
<p>è¿˜æœ‰ä¸ªå‘çˆ¹çš„æ˜¯ï¼Œæ‰“å¼€<code>DEBUG</code>çº§åˆ«çš„æ—¥å¿—ï¼Œå¯ä»¥çœ‹åˆ°é™¤äº†<code>AKKA</code>ç›¸å…³çš„<code>bundle</code>ä¹‹å¤–ï¼Œå‡ ä¹æ‰€æœ‰çš„<code>bundle</code>éƒ½åœ¨æŠ¥ä»¥ä¸‹çš„é”™è¯¯ã€‚è¿™ä¸ªé”™è¯¯åœ¨<code>bundle</code>ä¹‹é—´è°ƒç”¨æœåŠ¡æ—¶å€™çš„å°±ä¼šå‡ºç°ã€‚</p>
</li>
<li>
<p>ç”±äº<code>AKKA</code>çš„<code>bundle</code>æ˜¯æœ€åä¸€ä¸ªï¼Œåœ¨å¯åŠ¨æ—¶å€™ä¼šcheckå…¶ä»–æ‰€æœ‰<code>bundle</code>çš„çŠ¶æ€ï¼Œæ‰€ä»¥è¿™å®¶ä¼™å°±æŒ‚äº†ã€‚å°†<code>check</code>å»æ‰å°±èµ·æ¥äº†ã€‚æ‰€ä»¥çœ‹èµ·æ¥ï¼Œè¿™ä¸ª<code>bundle</code>èµ·ä¸æ¥ï¼Œæ›´å¤šçš„æ˜¯å’Œä»¥ä¸‹çš„<code>OSGI</code>é”™è¯¯ç›¸å…³ï¼Œè€Œä¸æ˜¯å’Œ<code>AKKA</code>æœ‰å…³è”</p>
</li>
<li>
<p>ä½†æ˜¯åœ¨ä»ä¸Šå›çš„<code>network Policy</code>é—®é¢˜ä»¥æ¥ï¼Œåªæœ‰ä¸€æ»´æ»´helm chartçš„æ”¹åŠ¨ã€‚javaä»£ç å‹æ ¹æ²¡åŠ¨è¿‡ã€‚ä¾èµ–ä¹Ÿæ²¡æ”¹è¿‡ã€‚</p>
</li>
<li>
<p><code>OSGI</code>ä½ æŠ¥ä»€ä¹ˆé”™å•Šï¼Œåè¡€äº†æˆ‘ï¼</p>
<pre><code> org.osgi.framework.ServiceException: org.apache.felix.scr.impl.manager.SingleComponentManager.getService() returned a null service object
at org.eclipse.osgi.internal.serviceregistry.ServiceUse.getService(ServiceUse.java:163) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.internal.serviceregistry.ServiceRegistrationImpl.getService(ServiceRegistrationImpl.java:468) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.internal.serviceregistry.ServiceRegistry.getService(ServiceRegistry.java:467) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.framework.internal.core.BundleContextImpl.getService(BundleContextImpl.java:594) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.apache.felix.scr.impl.helper.BindMethod.getServiceObject(BindMethod.java:572) [na:na]
at org.apache.felix.scr.impl.manager.DependencyManager.getServiceObject(DependencyManager.java:2012) [na:na]
at org.apache.felix.scr.impl.manager.DependencyManager$SingleDynamicCustomizer.prebind(DependencyManager.java:852) [na:na]
at org.apache.felix.scr.impl.manager.DependencyManager.prebind(DependencyManager.java:1439) [na:na]
at org.apache.felix.scr.impl.manager.AbstractComponentManager.collectDependencies(AbstractComponentManager.java:1119) [na:na]
at org.apache.felix.scr.impl.manager.SingleComponentManager.getServiceInternal(SingleComponentManager.java:807) [na:na]
at org.apache.felix.scr.impl.manager.SingleComponentManager.getService(SingleComponentManager.java:777) [na:na]
at org.eclipse.osgi.internal.serviceregistry.ServiceUse$1.run(ServiceUse.java:141) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at java.security.AccessController.doPrivileged(Native Method) [na:1.8.0_212]
at org.eclipse.osgi.internal.serviceregistry.ServiceUse.getService(ServiceUse.java:139) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.internal.serviceregistry.ServiceRegistrationImpl.getService(ServiceRegistrationImpl.java:468) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.internal.serviceregistry.ServiceRegistry.getService(ServiceRegistry.java:467) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.framework.internal.core.BundleContextImpl.getService(BundleContextImpl.java:594) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.apache.felix.scr.impl.helper.BindMethod.getServiceObject(BindMethod.java:572) [na:na]
at org.apache.felix.scr.impl.manager.DependencyManager.getServiceObject(DependencyManager.java:2012) [na:na]
at org.apache.felix.scr.impl.manager.DependencyManager$SingleDynamicCustomizer.prebind(DependencyManager.java:852) [na:na]
at org.apache.felix.scr.impl.manager.DependencyManager.prebind(DependencyManager.java:1439) [na:na]
at org.apache.felix.scr.impl.manager.AbstractComponentManager.collectDependencies(AbstractComponentManager.java:1119) [na:na]
at org.apache.felix.scr.impl.manager.SingleComponentManager.getServiceInternal(SingleComponentManager.java:807) [na:na]
at org.apache.felix.scr.impl.manager.SingleComponentManager.getService(SingleComponentManager.java:777) [na:na]
at org.eclipse.osgi.internal.serviceregistry.ServiceUse$1.run(ServiceUse.java:141) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at java.security.AccessController.doPrivileged(Native Method) [na:1.8.0_212]
at org.eclipse.osgi.internal.serviceregistry.ServiceUse.getService(ServiceUse.java:139) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.internal.serviceregistry.ServiceRegistrationImpl.getService(ServiceRegistrationImpl.java:468) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.internal.serviceregistry.ServiceRegistry.getService(ServiceRegistry.java:467) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.framework.internal.core.BundleContextImpl.getService(BundleContextImpl.java:594) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.apache.felix.scr.impl.helper.BindMethod.getServiceObject(BindMethod.java:572) [na:na]
at org.apache.felix.scr.impl.manager.DependencyManager.getServiceObject(DependencyManager.java:2012) [na:na]
at org.apache.felix.scr.impl.manager.DependencyManager$SingleDynamicCustomizer.prebind(DependencyManager.java:852) [na:na]
at org.apache.felix.scr.impl.manager.DependencyManager.prebind(DependencyManager.java:1439) [na:na]
at org.apache.felix.scr.impl.manager.AbstractComponentManager.collectDependencies(AbstractComponentManager.java:1119) [na:na]
at org.apache.felix.scr.impl.manager.SingleComponentManager.getServiceInternal(SingleComponentManager.java:807) [na:na]
at org.apache.felix.scr.impl.manager.AbstractComponentManager.activateInternal(AbstractComponentManager.java:850) [na:na]
at org.apache.felix.scr.impl.manager.AbstractComponentManager.enable(AbstractComponentManager.java:419) [na:na]
at org.apache.felix.scr.impl.config.ConfigurableComponentHolder.enableComponents(ConfigurableComponentHolder.java:376) [na:na]
at org.apache.felix.scr.impl.BundleComponentActivator.initialize(BundleComponentActivator.java:172) [na:na]
at org.apache.felix.scr.impl.BundleComponentActivator.&lt;init&gt;(BundleComponentActivator.java:120) [na:na]
at org.apache.felix.scr.impl.Activator.loadComponents(Activator.java:258) [na:na]
at org.apache.felix.scr.impl.Activator.access$000(Activator.java:45) [na:na]
at org.apache.felix.scr.impl.Activator$ScrExtension.start(Activator.java:185) [na:na]
at org.apache.felix.utils.extender.AbstractExtender.createExtension(AbstractExtender.java:259) [na:na]
at org.apache.felix.utils.extender.AbstractExtender.modifiedBundle(AbstractExtender.java:232) [na:na]
at org.osgi.util.tracker.BundleTracker$Tracked.customizerModified(BundleTracker.java:479) [karaf-org.osgi.core.jar:na]
at org.osgi.util.tracker.BundleTracker$Tracked.customizerModified(BundleTracker.java:414) [karaf-org.osgi.core.jar:na]
at org.osgi.util.tracker.AbstractTracked.track(AbstractTracked.java:232) [karaf-org.osgi.core.jar:na]
at org.osgi.util.tracker.BundleTracker$Tracked.bundleChanged(BundleTracker.java:443) [karaf-org.osgi.core.jar:na]
at org.eclipse.osgi.framework.internal.core.BundleContextImpl.dispatchEvent(BundleContextImpl.java:847) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous(ListenerQueue.java:148) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.framework.internal.core.Framework.publishBundleEventPrivileged(Framework.java:1568) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.framework.internal.core.Framework.publishBundleEvent(Framework.java:1504) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.framework.internal.core.Framework.publishBundleEvent(Framework.java:1499) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.framework.internal.core.BundleHost.startWorker(BundleHost.java:391) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.framework.internal.core.AbstractBundle.resume(AbstractBundle.java:390) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.framework.internal.core.Framework.resumeBundle(Framework.java:1176) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.framework.internal.core.StartLevelManager.resumeBundles(StartLevelManager.java:559) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.framework.internal.core.StartLevelManager.resumeBundles(StartLevelManager.java:544) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.framework.internal.core.StartLevelManager.incFWSL(StartLevelManager.java:457) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.framework.internal.core.StartLevelManager.doSetStartLevel(StartLevelManager.java:243) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.framework.internal.core.StartLevelManager.dispatchEvent(StartLevelManager.java:438) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.framework.internal.core.StartLevelManager.dispatchEvent(StartLevelManager.java:1) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.run(EventManager.java:340) [org.eclipse.osgi-3.8.2.v20130124-134944.jar:na]
</code></pre>
</li>
</ul>
<h4 id="è¿›å±•"><a class="header-anchor" href="#è¿›å±•"></a>è¿›å±•</h4>
<ul>
<li>åœ¨åšäº†<code>workaround</code>ï¼š æ›¿æ¢<code>liveness</code>çš„ç«¯å£ï¼Œè¿™æ ·<code>pod</code>ä¸ä¼šåœ¨ä¸æ–­é‡å¯ï¼›å°†<code>bundle</code>çš„<code>check</code>å»æ‰ï¼Œè¿™æ ·<code>bundle</code>çœ‹ç€éƒ½<code>active</code>äº†ã€‚ä¹‹åï¼Œå¼€å§‹é‡æ–°<code>debug</code></li>
<li><code>OSGI</code>çš„é”™è¯¯åœ¨æ‰“å¼€<code>apache</code>çš„<code>debug log</code>ä¹‹åä»æ—§æ— ä»ä¸‹æ‰‹ï¼Œè¿™ä¸ªé”™è¯¯åœ¨3æœˆ9å·çš„åŒ…ä¸­ä¹Ÿæ˜¯æ²¡æœ‰çš„ï¼Œåªèƒ½å›åˆ°å¯¹æ¯”åŒ…çš„è€è·¯ä¸Šé¢æ¥ã€‚</li>
<li>é‚£ä¹ˆç¬¬ä¸€ä¸ªä»æ—§æ˜¯<code>Cassandra</code>çš„æ”¹åŠ¨ã€‚è¿™å›åœ¨å°†è¿™ä¸ªæ”¹åŠ¨åŠ ä¸Šä¹‹åï¼Œ<code>OSGI</code>çš„é”™è¯¯æ²¡æœ‰äº†ã€‚ç„¶é¹…ï¼Œä¸ºä»€ä¹ˆæ•°æ®åº“çš„æ”¹åŠ¨ä¼šå½±å“åˆ°<code>OSGI</code>çš„çŠ¶æ€ï¼Œå¹¶ä¸çŸ¥é“ã€‚è¿™ä¸ªé—®é¢˜åªèƒ½åˆ°æ­¤ä¸ºæ­¢å•¦ã€‚</li>
<li>æ‰€ä»¥ä½¿ç”¨<code>karaf</code>ä»æ—§æ˜¯å¾ˆ<code>heavy</code>çš„ï¼Œåœ¨æœ€æ–°çš„ç‰ˆæœ¬ä¸­å·²ç»å°†ä¹‹ç§»é™¤äº†ã€‚</li>
</ul>
<h4 id="å‚è€ƒé“¾æ¥"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h4>
<ul>
<li>åœ¨é—®é¢˜çš„è§£å†³è¿‡ç¨‹ä¸­ï¼ŒæŸ¥è¯¢äº†å¾ˆå¤šï¼Œæœ‰ä¸€äº›æ¯”è¾ƒæœ‰ç”¨çš„é“¾æ¥å¦‚ä¸‹ï¼š
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/51455551" target="_blank" rel="noopener">k8sä¸ºä½•æ€æ­»æˆ‘çš„Pod</a></li>
<li><a href="https://blog.csdn.net/yzh_1346983557/article/details/89216494?depth_1-utm_source=distribute.pc_relevant.none-task&amp;utm_source=distribute.pc_relevant.none-task" target="_blank" rel="noopener">CPUåˆ†é…è¿‡å°‘å¯¼è‡´PODé‡å¯</a></li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/hexo_blog/2019/11/15/TLS-Certification/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/hexo_blog/2019/11/15/TLS-Certification/" itemprop="url">TLS - Certification</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-11-15T16:03:26+08:00">
                2019-11-15
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/security/" itemprop="url" rel="index">
                    <span itemprop="name">security</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="å‚è€ƒé“¾æ¥"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2>
<ul>
<li><a href="https://raw.githubusercontent.com/sallyslove/Pictures/master/Security/TLS/Certificate/certificate_detail.png" target="_blank" rel="noopener">SSL/TLS for dummies part 3 â€“ Understanding Certificate Authority</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/30655259" target="_blank" rel="noopener">HTTPS ç²¾è¯»ä¹‹ TLS è¯ä¹¦æ ¡éªŒ</a></li>
<li><a href="https://www.cnblogs.com/lhj588/p/6069873.html" target="_blank" rel="noopener">https SSLä¸»æµæ•°å­—è¯ä¹¦éƒ½æœ‰å“ªäº›æ ¼å¼ï¼Ÿ</a></li>
<li><a href="https://docs.oracle.com/javase/7/docs/technotes/guides/security/jsse/JSSERefGuide.html" target="_blank" rel="noopener">Java Secure Socket Extension</a></li>
</ul>
<h2 id="ä¸ºå•¥éœ€è¦è¯ä¹¦"><a class="header-anchor" href="#ä¸ºå•¥éœ€è¦è¯ä¹¦"></a>ä¸ºå•¥éœ€è¦è¯ä¹¦</h2>
<ul>
<li>æˆ‘ä»¬çŸ¥é“åœ¨<code>TLS</code>ä¼ è¾“ä¸­éœ€è¦ä½¿ç”¨ä¸å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œåœ¨å…¶ä¸­æœ‰å…¬é’¥ï¼Œç§é’¥ã€‚å…¬é’¥ç”¨æ¥ç»™å®¢æˆ·ç«¯ç»™è‡ªå·±å‘æ¶ˆæ¯ï¼Œç§é’¥ç”¨æ¥è§£å¯†æ”¶åˆ°çš„æ¶ˆæ¯ã€‚</li>
<li>ä½†æ˜¯ä»¥ä¸‹åœºæ™¯ä¸­å³ä½¿æ˜¯ä¸å¯¹ç§°åŠ å¯†ä¹Ÿæ˜¯ä¸å®‰å…¨çš„ï¼š
<ul>
<li>å°æ˜ç”¨æµè§ˆå™¨å¾€ç™¾åº¦å‘äº†ä¸ªæ¶ˆæ¯ï¼Œç„¶åç™¾åº¦å°†è‡ªå·±çš„å…¬é’¥è¿”å›ç»™å°æ˜ã€‚</li>
<li>æ”»å‡»è€…åœ¨ä¸­é€”æˆªä½äº†è¿™ä¸ªå…¬é’¥ï¼Œå¹¶ä¸”æ›¿æ¢ä¸ºè‡ªå·±çš„å…¬é’¥å‘ç»™äº†å°æ˜ã€‚</li>
<li>å°æ˜å¹¶ä¸æ¸…æ¥šï¼Œç”¨è¿™ä¸ªå‡çš„å…¬é’¥åŠ å¯†äº†è‡ªå·±çš„ç§é’¥ï¼Œå¹¶ä¸”å‘ç»™äº†ç™¾åº¦ã€‚</li>
<li>æ”»å‡»è€…äºæ˜¯æ‹¥æœ‰äº†å°æ˜çš„ç§é’¥ï¼Œæ¥ç€ç”¨ä¸Šä¸€æ¬¡æˆªè·çš„ç™¾åº¦çš„å…¬é’¥åŠ å¯†å°æ˜çš„ç§é’¥ï¼Œè¿”å›ç»™ç™¾åº¦ã€‚</li>
<li>äºæ˜¯ç™¾åº¦ä¼šè®¤ä¸º<code>TLS</code>é€šé“å·²ç»å»ºç«‹ã€‚æ¥ä¸‹æ¥å°æ˜å’Œç™¾åº¦ä¹‹é—´çš„æ‰€æœ‰æ¶ˆæ¯éƒ½ä¼šè¢«æ”»å‡»è€…å¾—çŸ¥ã€‚</li>
<li>è¿™æ—¶å€™å°±éœ€è¦è¯ä¹¦äº†ã€‚è¯ä¹¦é¢å‘æœºæ„ç”±<code>X.509</code>æ ‡å‡†æŒ‡å®šï¼Œä»¥ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§ã€‚è¯ä¹¦çš„ç›®çš„å°±æ˜¯ä¿è¯æ•°æ®çš„å®Œæ•´æ€§ã€‚å•§ï¼Œå¬ä¸Šå»å¥½å‰å®³ï¼</li>
</ul>
</li>
</ul>
<h2 id="è¯ä¹¦çš„ä½¿ç”¨è¿‡ç¨‹"><a class="header-anchor" href="#è¯ä¹¦çš„ä½¿ç”¨è¿‡ç¨‹"></a>è¯ä¹¦çš„ä½¿ç”¨è¿‡ç¨‹</h2>
<ol>
<li>é¦–å…ˆæ˜¯ç™¾åº¦ä½œä¸ºä¸€ä¸ªæœåŠ¡å™¨ï¼Œå‘<code>CA</code>ç”³è¯·ç­¾åè¯ä¹¦ã€‚è¿™é‡Œç”¨<code>Digicert</code>ä½œä¸º<code>CA</code>ã€‚<code>github</code>å°±æ˜¯<code>Digicert</code>åšçš„æ ¹è®¤è¯ ğŸ˜ƒ</li>
<li>é‚£ä¹ˆ<code>CA</code>ä¼šä¸ºç™¾åº¦åˆ›å»ºä¸€ä¸ªè¯ä¹¦ï¼Œé‡Œé¢åŒ…å«ä¸€äº›ä¿¡æ¯ï¼Œæ¯”å¦‚ä¾‹å¦‚æœåŠ¡å™¨åç§°ï¼ŒæœåŠ¡å™¨çš„å…¬é’¥ç­‰ã€‚</li>
<li><code>Digicert</code>å°†åˆ›å»ºæ•°æ®ï¼ˆè¿™é‡Œçš„æ•°æ®ï¼Œå…¶å®å°±æ˜¯è¯ä¹¦ï¼‰çš„å“ˆå¸Œå€¼ï¼Œå¹¶ä½¿ç”¨è‡ªå·±çš„ç§é’¥å¯¹å…¶è¿›è¡ŒåŠ å¯†</li>
<li>æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿè‡ªå¸¦<code>Digicert</code>ç­‰æƒå¨æœºæ„çš„å…¬é’¥ã€‚</li>
<li>å½“æµè§ˆå™¨æ”¶åˆ°ç­¾åè¯ä¹¦æ—¶ï¼Œå®ƒå°†ä½¿ç”¨<code>Digicert</code>çš„å…¬é’¥ä»ç­¾åç”Ÿæˆå“ˆå¸Œå€¼ï¼Œå®ƒè¿˜å°†ä½¿ç”¨è¯ä¹¦ä¸­æŒ‡å®šçš„æ•£åˆ—ç®—æ³•ç”Ÿæˆæ•°æ®ï¼ˆè¯ä¹¦ï¼‰çš„æ•£åˆ—</li>
<li>å¦‚æœä¸¤ä¸ªå“ˆå¸Œå€¼åŒ¹é…ï¼Œåˆ™ç­¾åéªŒè¯æˆåŠŸå¹¶ä¸”è¯ä¹¦æ˜¯å¯ä¿¡çš„</li>
<li>ç°åœ¨æµè§ˆå™¨å¯ä»¥ä½¿ç”¨è¯ä¹¦ä¸­æŒ‡å®šçš„ç™¾åº¦çš„å…¬é’¥ç»§ç»­è¿›è¡Œèº«ä»½éªŒè¯è¿‡ç¨‹ã€‚</li>
</ol>
<ul>
<li>ä¹Ÿå°±æ˜¯è¯´åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯äº¤æ¢å…¬é’¥ç§˜é’¥çš„è¿‡ç¨‹ä¸­ï¼ŒåŠ å…¥äº†<code>CA</code>çš„ç­¾åè®¤è¯ï¼Œè¿™æ ·ä¿è¯å®¢æˆ·ç«¯å¯ä»¥ä¿¡ä»»æ”¶åˆ°çš„å…¬é’¥ç¡®å®æ˜¯æœåŠ¡å™¨ç«¯çš„å…¬é’¥ï¼Œè€Œä¸æ˜¯æ”»å‡»è€…çš„å…¬é’¥ã€‚</li>
<li>å…¶å®å°±æ˜¯è¯ä¹¦æœåŠ¡å™¨å¯¹è‡ªå·±çš„ä¸€ä»½æ•°æ®ï¼Œè¿™ä¸ªæ•°æ®åŒ…å«è¯ä¹¦æœåŠ¡å™¨çš„ä¿¡æ¯å’Œç™¾åº¦çš„å…¬é’¥ä¿¡æ¯ï¼Œè¿˜æœ‰å…¶ä»–ä¸€äº›ä¿¡æ¯ã€‚ç„¶åå…ˆè¿›è¡Œhashè¿ç®—ï¼Œå†ç”¨è‡ªå·±çš„ç§é’¥è¿›è¡ŒåŠ å¯†ï¼Œç„¶åå’Œæ•°æ®ä¸€èµ·å‘ç»™æµè§ˆå™¨ã€‚</li>
<li>è¿™æ ·ï¼Œæµè§ˆå™¨å¯¹æ•°æ®è¿›è¡Œhashè¿ç®—ï¼Œç„¶åï¼Œç”¨è¯ä¹¦æœåŠ¡å™¨çš„å…¬é’¥è§£å¯†ï¼Œå†è·Ÿç®—å‡ºæ¥çš„hashå€¼è¿›è¡Œå¯¹æ¯”ã€‚</li>
</ul>
<p><img src="https://raw.githubusercontent.com/sallyslove/Pictures/master/Security/TLS/Certificate/Certificate.png" alt="æ¥è‡ªå‚è€ƒé“¾æ¥1"></p>
<ul>
<li>ä¸ºäº†ç»•è¿‡ä¸Šè¿°æœºåˆ¶ï¼Œæ”»å‡»è€…éœ€è¦ä½¿ç­¾åæ¥åŒ¹é…æ•°æ®ï¼Œä¸ºäº†åšåˆ°è¿™ç‚¹ï¼Œä»–éœ€è¦æ‹¥æœ‰<code>Digicert</code>çš„ç§é’¥ï¼ˆæœ€åˆä¸ºexample.comç­¾å‘å¹¶ç­¾ç½²äº†è¯ä¹¦ï¼‰ï¼Œæ‰€ä»¥æ”»å‡»è€…æ­¤æ—¶ä¼šå¤±è´¥ï¼Œå› ä¸ºä»–å¯ä»¥åˆ›å»ºçš„å”¯ä¸€ç­¾åæ¥è‡ªä»–çš„ç§é’¥ï¼Œæˆ‘ä»¬çš„æµè§ˆå™¨å¹¶ä¸ä¼šä¿¡ä»»è¿™ä¸€ç‚¹ã€‚æµè§ˆå™¨çš„è¯ä¹¦å­˜å‚¨åŒºä¹Ÿä¸ä¼šæœ‰æ”»å‡»è€…çš„å…¬é’¥ï¼Œå¹¶ä¸”åœ¨å‘ç”Ÿæ­¤ç±»æ”»å‡»æ—¶ä¼šæ˜¾ç¤ºè¯ä¹¦å¼‚å¸¸ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</li>
</ul>
<p><img src="https://raw.githubusercontent.com/sallyslove/Pictures/master/Security/TLS/Certificate/certificate_not_safe.png" alt></p>
<h2 id="root-ca-å’Œ-ä¸­é—´ca"><a class="header-anchor" href="#root-ca-å’Œ-ä¸­é—´ca"></a>Root CA å’Œ ä¸­é—´CA</h2>
<p><code>CA</code>çš„ä¸€å †çœ‹å¾—æƒ³åå•Šã€‚ğŸ˜¦</p>
<h3 id="root-ca"><a class="header-anchor" href="#root-ca"></a>Root CA</h3>
<ul>
<li>å‚è€ƒé“¾æ¥
<ul>
<li><a href="https://support.dnsimple.com/articles/what-is-certificate-authority/" target="_blank" rel="noopener">ä»€ä¹ˆæ˜¯CA</a></li>
<li><a href="https://support.dnsimple.com/articles/what-is-ssl-root-certificate/" target="_blank" rel="noopener">ä»€ä¹ˆæ˜¯Root CA</a></li>
</ul>
</li>
<li>æœ‰ä¸¤ç§è§£é‡Šï¼Œä¸€ä¸ªæ˜¯è¢«ä¿¡ä»»çš„æœºæ„ï¼Œå¦ä¸€ä¸ªæ˜¯è¿™ä¸ªæœºæ„é¢å‘å‡ºæ¥çš„è¯ä¹¦</li>
<li>æ¯”å¦‚<code>Digicert</code>å°±æ˜¯ä¸€ä¸ª<code>root CA</code></li>
</ul>
<h3 id="ä¸­é—´ca"><a class="header-anchor" href="#ä¸­é—´ca"></a>ä¸­é—´CA</h3>
<ul>
<li>ç®€å•åœ°è¯´ï¼Œå°†é¸¡è›‹æ”¾åœ¨ä¸€ä¸ªç¯®å­é‡Œé¢æ˜¯å¾ˆå±é™©çš„ï¼Œ <code>CA</code>ä¹Ÿæ˜¯ä¸€æ ·ï¼Œå¦‚æœæ‰€æœ‰çš„è¯ä¹¦éƒ½ç”±<code>root CA</code>ç­¾å‘ï¼Œé‚£ä¹ˆ<code>root CA</code>çš„å·¥ä½œé‡ç¹é‡ï¼Œè€Œä¸”ä¸€æ—¦<code>root CA</code>è¢«æ”»å‡»äº†ï¼Œåæœå®åœ¨ä¸å¯æƒ³è±¡</li>
<li>äºæ˜¯å‡ºç°äº†ä¸­é—´çš„<code>CA</code>æœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯è¢«æ ¹<code>CA</code>æœåŠ¡å™¨ä¿¡ä»»çš„ä¸­é—´æœåŠ¡å™¨</li>
<li><em><code>intermediate CA</code>æ˜¯<code>Root CA</code>ä¿¡ä»»çš„è¯ä¹¦é¢å‘æœºæ„ã€‚ <code>example.com</code>çš„è¯ä¹¦å°†ç”±<code>intermediate CA</code>é¢å‘ï¼Œ<code>intermediate CA</code>è¿˜å°†å…·æœ‰å°†ç”±<code>Root CA</code>ç­¾åçš„è¯ä¹¦ï¼Œå¹¶ä¸”åªæœ‰<code>Root CA</code>çš„è¯¦ç»†ä¿¡æ¯ä¼šè¢«å­˜å‚¨åœ¨æµè§ˆå™¨çš„è¯ä¹¦åº“ä¸­ã€‚</em></li>
<li>åœ¨æµè§ˆå™¨é‡Œé¢èƒ½çœ‹åˆ°è¯ä¹¦çš„è¯¦ç»†ä¿¡æ¯ã€‚æ¯”å¦‚ä»¥ä¸‹çš„è¿™ä¸ªè¯ä¹¦ã€‚G2å°±æ˜¯ä¸€ä¸ªä¸­é—´CAã€‚</li>
</ul>
<p><img src="https://raw.githubusercontent.com/sallyslove/Pictures/master/Security/TLS/Certificate/certificate_detail.png" alt></p>
<h3 id="è¯ä¹¦ç­¾åç®—æ³•"><a class="header-anchor" href="#è¯ä¹¦ç­¾åç®—æ³•"></a>è¯ä¹¦ç­¾åç®—æ³•</h3>
<ul>
<li>åœ¨è¯ä¹¦å°†æ•°æ®çš„<code>hashå€¼</code>ç”¨è‡ªå·±çš„ç§é’¥è¿›è¡ŒåŠ å¯†çš„æ—¶å€™å¯ä»¥é€‰æ‹©ä¸åŒçš„åŠ å¯†ç®—æ³•.</li>
<li><code>RSAè§£å¯†åŠ å¯†</code>å’Œ<code>RSAç­¾å</code>ç®—æ³•åº”è¯¥æœ‰ä¸€äº›å·®å¼‚ï¼Œè¿™é‡Œæš‚æ—¶å¹¶ä¸æ·±ç©¶ã€‚çœ‹ä¸‹å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œè¿™è¾¹ç­¾åç®—æ³•ç”¨çš„æ˜¯<code>sha256RSA</code>ã€‚<code>sha256</code>æ˜¯å“ˆå¸Œç®—æ³•ã€‚</li>
<li>éœ€è¦çŸ¥é“çš„æ˜¯ï¼Œç­¾åæ˜¯é€šè¿‡ä½¿ç”¨<code>intermediate CA</code>çš„ç§é’¥æ¥å®Œæˆçš„ã€‚å¹¶ä¸”ç­¾åéªŒè¯ç”±æµè§ˆå™¨ä½¿ç”¨ç›¸åº”çš„å…¬é’¥å®Œæˆçš„ã€‚</li>
<li>æ•°æ®é•¿åº¦è¶…è¿‡å…¶å¯†é’¥é•¿åº¦ï¼Œ<code>RSA</code>æ— æ³•åŠ å¯†æ•°æ®ã€‚å‡è®¾æˆ‘ä»¬ä½¿ç”¨<code>2048</code>ä½å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œé‚£ä¹ˆè¯ä¹¦æ•°æ®ä¸åº”è¶…è¿‡<code>2048</code>ä½ï¼Œä¹Ÿå°±æ˜¯<code>255</code>ä¸ªå­—èŠ‚ï¼Œè¿™å¹¶ä¸æ€»æ˜¯å¯è¡Œçš„ï¼Œå› ä¸ºè¯ä¹¦åŒ…å«å¾ˆå¤šä¿¡æ¯ã€‚å› æ­¤ï¼Œåœ¨åŠ å¯†ä¹‹å‰ï¼Œåœ¨è¯ä¹¦ä¸Šåº”ç”¨å“ˆå¸Œå‡½æ•°ï¼ˆå“ˆå¸Œå‡½æ•°åˆç§°ä¸ºæ•£åˆ—ç®—æ³•ï¼‰ï¼Œè¯¥å‡½æ•°ç”ŸæˆæŒ‡å®šé•¿åº¦çš„å”¯ä¸€éšæœºå­—ç¬¦ä¸²ã€‚ä¸‹å›¾ä¸­å°±æ˜¯<code>sha256</code>.</li>
</ul>
<p><img src="https://raw.githubusercontent.com/sallyslove/Pictures/master/Security/TLS/Certificate/certificate_algorithm.png" alt></p>
<h3 id="è¯ä¹¦æ ¡éªŒ"><a class="header-anchor" href="#è¯ä¹¦æ ¡éªŒ"></a>è¯ä¹¦æ ¡éªŒ</h3>
<ul>
<li>æµè§ˆå™¨æ˜¯æœ‰æ ¹<code>CA</code>çš„å…¬é’¥çš„ï¼Œæ‰€ä»¥æµè§ˆå™¨ä¼šå…ˆç”¨æ ¹<code>CA</code>çš„å…¬é’¥æ¥éªŒè¯ä¸­é—´<code>CA</code>çš„è¯ä¹¦</li>
<li>ç„¶åå°±å¯ä»¥ä¿¡ä»»ä¸­é—´<code>CA</code>çš„å…¬é’¥ï¼Œå†ç”¨è¿™ä¸ªå…¬é’¥æ¥è§£æœåŠ¡å™¨çš„è¯ä¹¦</li>
<li>ç„¶åå¾—åˆ°æœåŠ¡å™¨ï¼Œæ¯”å¦‚ç™¾åº¦çš„å…¬é’¥</li>
</ul>
<h3 id="è¯ä¹¦æ ¼å¼"><a class="header-anchor" href="#è¯ä¹¦æ ¼å¼"></a>è¯ä¹¦æ ¼å¼</h3>
<ul>
<li>è¯ä¹¦çš„è§„èŒƒæ˜¯<code>X.509</code>ï¼Œæœ‰å¥½å‡ ä¸ªç‰ˆæœ¬ã€‚èµ·ç åˆ°<code>v3</code>,åº”è¯¥ä¹Ÿæ˜¯ç›®å‰æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ä¸ªç‰ˆæœ¬ã€‚è¯ä¹¦çš„å†…å®¹éµå¾ª<code>asn.1</code>æ ¼å¼ã€‚ğŸ˜‚ å±…ç„¶æ˜¯<code>asn.1</code>çš„ï¼Œä¹…è¿çš„ä¸€ä¸ªè§„èŒƒäº†ã€‚</li>
<li>æœ€å¸¸è§çš„ä¸¤ä¸ªå·¥å…·æ˜¯<code>Java</code>çš„<code>Keytool</code>å’Œ<code>openssl</code></li>
<li><code>Java</code>çš„<code>keytool</code>ç”Ÿæˆçš„è¯ä¹¦æ ¼å¼æ˜¯<code>JKS</code>æ ¼å¼çš„è¯ä¹¦</li>
<li><code>openssl</code>ç”Ÿæˆ<code>PEMã€KEYã€CRT</code>æ ¼å¼çš„è¯ä¹¦</li>
<li>è¿˜æœ‰ä¸€äº›å…¶ä»–æ ¼å¼çš„è¯ä¹¦ï¼Œæ¯”å¦‚IBMå’Œå¾®è½¯ï¼Œéƒ½æœ‰è‡ªå·±çš„å·¥å…·ç”Ÿæˆçš„è‡ªå¸¦è¯ä¹¦
<ul>
<li><code>*.DER *.CER Certificate</code> : è¿™æ ·çš„è¯ä¹¦æ–‡ä»¶æ˜¯äºŒè¿›åˆ¶æ ¼å¼ï¼Œåªå«æœ‰è¯ä¹¦ä¿¡æ¯ï¼Œä¸åŒ…å«ç§é’¥ã€‚</li>
<li><code>*.CRT</code>: è¿™æ ·çš„æ–‡ä»¶å¯ä»¥æ˜¯äºŒè¿›åˆ¶æ ¼å¼ï¼Œä¹Ÿå¯ä»¥æ˜¯æ–‡æœ¬æ ¼å¼ï¼Œä¸€èˆ¬å‡ä¸ºæ–‡æœ¬æ ¼å¼ï¼ŒåŠŸèƒ½ä¸<code>*.DER/*.CER</code>ç›¸åŒã€‚</li>
<li><code>*.PEM Privacy Enhanced Mail</code>: ä¸€èˆ¬æ˜¯æ–‡æœ¬æ ¼å¼ï¼Œå¯ä»¥æ”¾è¯ä¹¦æˆ–ç§é’¥ï¼Œæˆ–è€…ä¸¤è€…éƒ½åŒ…å«ã€‚ <code>*.PEM</code>å¦‚æœåªåŒ…å«ç§é’¥ï¼Œé‚£ä¸€èˆ¬ç”¨<code>*.KEY</code>ä»£æ›¿ã€‚</li>
<li><code>*.PFX *.P12 Personal Information Exchange</code>æ˜¯äºŒè¿›åˆ¶æ ¼å¼ï¼ŒåŒæ—¶å«è¯ä¹¦å’Œç§é’¥ï¼Œä¸€èˆ¬æœ‰å¯†ç ä¿æŠ¤</li>
<li><strong>è¿™ä¸ªåšå®¢æ˜¯ä¸æ˜¯è¯´å¾—ä¸å¯¹å•Šï¼Œè¯ä¹¦é‡Œé¢å“ªé‡Œæ¥çš„ç§é’¥ï¼Œåº”è¯¥éƒ½æ˜¯å…¬é’¥æ‰å¯¹å§</strong></li>
</ul>
</li>
<li><code>â€”â€“BEGIN CERTIFICATEâ€”â€“</code> ç”¨è¿™ä¸ªå¼€å¤´çš„ï¼Œä»£è¡¨è¿™ä¸ªæ˜¯è¯ä¹¦</li>
<li><code>â€”â€“BEGIN RSA PRIVATE KEYâ€”â€“</code> è¿™ä¸ªå¼€å¤´çš„ï¼Œè¯´æ˜æ˜¯ä¸€ä¸ªç§é’¥ã€‚</li>
</ul>
<h4 id="è¯ä¹¦çš„è¯¦ç»†å†…å®¹"><a class="header-anchor" href="#è¯ä¹¦çš„è¯¦ç»†å†…å®¹"></a>è¯ä¹¦çš„è¯¦ç»†å†…å®¹</h4>
<ul>
<li>ä»¥ä¸‹æ˜¯è¯ä¹¦è§„èŒƒã€‚çœ‹åå­—èƒ½æ˜ç™½å…¶ä¸­åŒ…å«ï¼š
<ul>
<li>è¯ä¹¦è§„èŒƒçš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ¯”å¦‚<code>v3</code></li>
<li>è¯ä¹¦åºåˆ—å·ï¼Œè¯ä¹¦åºåˆ—å·åœ¨ä¸€ä¸ª<code>CA</code>æœºæ„å†…æ˜¯å”¯ä¸€çš„ï¼Œä½†ä¸æ˜¯å…¨å±€å”¯ä¸€</li>
<li>è¯ä¹¦ç­¾åç®—æ³•ï¼Œè¿™ä¸ªæ˜¯ä¸Šé¢å·²ç»çœ‹è¿‡äº†ã€‚</li>
<li>è¯ä¹¦ç­¾å‘è€…ï¼Œæ˜¯ä¸€ç»„<code>DN distributed name</code>ï¼Œåœ¨ç”¨<code>openssl</code>ç­‰å·¥å…·è¾“å‡ºè¯ä¹¦ä¿¡æ¯çš„æ—¶å€™ï¼Œèƒ½çœ‹åˆ°è¿™ä¸€æ ã€‚</li>
<li>è¯ä¹¦æœ‰æ•ˆæœŸ</li>
<li>è¯ä¹¦é‡Œé¢åŒ…å«çš„æœåŠ¡å™¨çš„åç§°ï¼Œ ä¹Ÿæ˜¯ä¸€ä¸ª<code>DN</code>ã€‚</li>
<li>è¯ä¹¦ä¸­åŒ…å«çš„æœåŠ¡å™¨çš„å…¬é’¥</li>
<li>å…¶ä»–æ‰©å±•ä¿¡æ¯ï¼šæ¯”å¦‚è¯ä¹¦æ‰€æºå¸¦çš„åŸŸåä¿¡æ¯<code>SAN</code></li>
<li>ç­¾åï¼šæœ€åæ˜¯è¯ä¹¦ç­¾åï¼Œè¿™ä¸ªåœ¨ä¸Šé¢å·²ç»è®²è¿‡ï¼Œæ˜¯æœ‰è¯ä¹¦æœåŠ¡å™¨ä½¿ç”¨è‡ªå·±çš„ç§é’¥å¯¹æ•°æ®è¿›è¡Œçš„ç­¾åï¼Œä½¿ç”¨è¯ä¹¦å†…æŒ‡å®šçš„ç­¾åç®—æ³•ã€‚æ ¼å¼å¦‚ä¸‹ï¼š</li>
</ul>
</li>
</ul>
<pre><code>   Signature = RSA(sha256(Data), IssuerPrivateKey)
</code></pre>
<p><img src="https://raw.githubusercontent.com/sallyslove/Pictures/master/Security/TLS/Certificate/certificate_detail_content.png" alt="è¯ä¹¦çš„è¯¦ç»†ä¿¡æ¯"></p>
<p><img src="https://raw.githubusercontent.com/sallyslove/Pictures/master/Security/TLS/Certificate/DN_explaination.jpg" alt="DNè¯¦è§£"></p>
<h4 id="è¯ä¹¦æŸ¥çœ‹å’Œæ ¼å¼è½¬æ¢"><a class="header-anchor" href="#è¯ä¹¦æŸ¥çœ‹å’Œæ ¼å¼è½¬æ¢"></a>è¯ä¹¦æŸ¥çœ‹å’Œæ ¼å¼è½¬æ¢</h4>
<ul>
<li>å„ä¸ªè¯ä¹¦çš„æ ¼å¼ä¹‹é—´æ˜¯å¯ä»¥ç›¸äº’è½¬æ¢çš„ã€‚</li>
<li>ä»¥ä¸‹å‘½ä»¤ï¼Œå°†<code>JKS</code>æ ¼å¼è½¬æ¢æˆä¸º<code>PFX</code>æ ¼å¼ã€‚äº‹å®ä¸Šï¼Œç”¨è¿™æ¡å‘½ä»¤å¯ä»¥å®ç°<code>JKS</code>å’Œ<code>PFX</code>çš„ç›¸äº’è½¬æ¢ï¼Œæ¢ä¸€ä¸‹ç›®æ ‡æ ¼å¼å’Œæºæ ¼å¼å³å¯ã€‚</li>
</ul>
<pre><code>keytool -importkeystore -srckeystore D:\server.jks -destkeystore D:\server.pfx -srcstoretype JKS -deststoretype PKCS12
</code></pre>
<h2 id="javaä¸­çš„å®ç°"><a class="header-anchor" href="#javaä¸­çš„å®ç°"></a>Javaä¸­çš„å®ç°</h2>
<ul>
<li>æˆ‘ä»¬åœ¨å·¥ä½œä¸­ç¢°åˆ°äº†é”™è¯¯:</li>
</ul>
<pre><code>javax.net.ssl.SSLHandshakeException: java.security.cert.CertificateException: No subject alternative names present
</code></pre>
<ul>
<li>
<p>è¿™ä¸ªé”™è¯¯åœ¨ç°åœ¨çœ‹æ¥å°±æ¯”è¾ƒæ¸…æ¥šäº†ï¼Œæ˜¯å®¢æˆ·ç«¯åœ¨æ ¡éªŒæœåŠ¡å™¨ç«¯çš„è¯ä¹¦ï¼Œå¹¶ä¸”å¯¹è¯ä¹¦é‡Œé¢çš„æ‰©å±•å­—æ®µ<code>SAN</code>æœ‰è¦æ±‚ï¼Œä½†æ˜¯æœåŠ¡å™¨ç«¯çš„è¯ä¹¦é‡Œé¢å¹¶æ²¡æœ‰å¸¦è¿™ä¸ªæ‰©å±•å­—æ®µï¼Œå°±é”™äº†ã€‚</p>
</li>
<li>
<p>è¿™éƒ¨åˆ†ä»£ç åº”è¯¥åœ¨<code>JSSE Java Secure Socket Extension</code>é‡Œé¢ã€‚<br>
æ²¡æœ‰unit testï¼Œå¾ˆéš¾è·Ÿä»£ç ã€‚å…ˆå°†æŠ¥é”™ä¿¡æ¯è®°å½•åœ¨è¿™é‡Œã€‚æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<pre><code> javax.net.ssl.SSLHandshakeException:  
 java.security.cert.CertificateException: No subject alternative names present
 at sun.security.ssl.Alerts.getSSLException(Alerts.java:192)
 at sun.security.ssl.SSLSocketImpl.fatal(SSLSocketImpl.java:1964)
 at sun.security.ssl.Handshaker.fatalSE(Handshaker.java:328)
 at sun.security.ssl.Handshaker.fatalSE(Handshaker.java:322)
 at sun.security.ssl.ClientHandshaker.serverCertificate(ClientHandshaker.java:1614)
 at sun.security.ssl.ClientHandshaker.processMessage(ClientHandshaker.java:216)
 at sun.security.ssl.Handshaker.processLoop(Handshaker.java:1052)
 at sun.security.ssl.Handshaker.process_record(Handshaker.java:987)
 at sun.security.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:1072)
 at sun.security.ssl.SSLSocketImpl.performInitialHandshake(SSLSocketImpl.java:1385)
 at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1413)
 at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1397)</code></pre>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/hexo_blog/2019/11/15/Maven-Dependency/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/hexo_blog/2019/11/15/Maven-Dependency/" itemprop="url">Maven Dependency</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-11-15T13:43:28+08:00">
                2019-11-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><code>maven</code>çš„<code>dependency</code>å’‹è¯´å‘¢ï¼Œé¡¹ç›®å¤§äº†ä¹‹åå°±æœ‰ç‚¹å¤æ‚ï¼Œåœ¨å·¥ä½œä¸­é…åˆ°ä¸€ä¸ªç”±äº<code>dependency</code>å¼•å…¥çš„é—®é¢˜ï¼Œå°†ä¸€äº›ç»†èŠ‚è®°å½•åœ¨è¿™é‡Œã€‚<br>
ç¯‡å¹…ä¸ä¼šå¾ˆé•¿ï¼Œä½†æ˜¯å®é™…é—®é¢˜ä¸­åº”è¯¥å¾ˆæœ‰å¸®åŠ©ã€‚</p>
<ul>
<li>
<p><code>mvn dependency:tree -Dverbose -Dincludes=&lt;groupID&gt;:&lt;artifiactID&gt;</code><br>
è¿™æ¡å‘½ä»¤å¯ä»¥æ¯”è¾ƒç›¸è¿‘åœ°æ‰“å°å‡ºéœ€è¦çŸ¥é“çš„åŒ…çš„æƒ…å†µã€‚</p>
</li>
<li>
<p>åœ¨ä¸€ä¸ª<code>pom</code>æ–‡ä»¶é‡Œé¢ï¼ŒåŒå±‚æ¬¡çš„æ’åœ¨å‰é¢çš„ä¼šè¢«ä¼˜å…ˆé‡‡ç”¨ï¼Œè€Œåé¢çš„ä¸€ä¸ªä¼šè¢«å¿½ç•¥ã€‚<br>
æ¯”å¦‚ï¼Œ <code>A depend on C 0.1</code>, <code>B depend on C 0.2</code>ï¼Œåœ¨<code>pom</code>é‡Œé¢å†™çš„æ—¶å€™ï¼Œ<code>A</code>åœ¨<code>B</code>å‰é¢ï¼Œé‚£ä¹ˆæœ€ç»ˆ<code>C 0.1</code>ä¼šæˆä¸ºæ•´ä¸ªé¡¹ç›®ä½¿ç”¨çš„ç‰ˆæœ¬</p>
</li>
<li>
<p>åƒä¸Šé¢è¿™ç§æƒ…å†µï¼Œå¦‚æœæƒ³ä½¿ç”¨<code>C 0.2</code>ï¼Œé‚£ä¹ˆæœ‰ä¸€ä¸ªæ–¹æ³•æ˜¯åœ¨<code>A</code>çš„ä¾èµ–åŠ å…¥çš„æ—¶å€™ï¼Œä½¿ç”¨<code>exclusions</code>å­—æ®µå°†å¯¹<code>C</code>çš„ä¾èµ–æ’é™¤æ‰ã€‚</p>
</li>
<li>
<p>æœ‰çš„æ—¶å€™ä¸€ä¸ªé¡¹ç›®é‡Œé¢çš„ç›¸å¯¹åº•å±‚çš„libåº“ï¼Œå¯èƒ½ä¼šè¢«å„ç§ä¸Šå±‚è°ƒç”¨ï¼Œæ¯”å¦‚æ‰“å°logçš„ï¼Œè®¿é—®æ•°æ®åº“çš„ï¼Œé‚£ä¹ˆæ›´å®¹æ˜“å‡ºç°å„ç§ç‰ˆæœ¬å†²çªï¼Œäº‹å®ä¸Šï¼Œåˆ°æœ€åæ²¡æœ‰åŠæ³•æ¥ç†å‡ºæ¥ï¼ŒçŠ¹å¦‚ä¸€å›¢ä¹±éº»ã€‚é‚£ä¹ˆä¸€ä¸ªç®€å•çš„æ–¹å¼å°±æ˜¯ï¼Œåœ¨é¡¶å±‚é¡¹ç›®çš„<code>pom</code>æ–‡ä»¶é‡Œé¢ï¼Œä½¿ç”¨<code>dependencymanagement</code>æ¥æŒ‡å®šä¸€ä¸ªèŒƒå›´å’Œç‰ˆæœ¬å·ã€‚è¿™ç§å®åœ¨æ˜¯ä¸€æ‹›ç ´ä¸‡å†›ã€‚</p>
</li>
<li>
<p>ä½¿ç”¨ç¬¬ä¸€æ¡å‘½ä»¤ä¹‹åæ‰“å°å‡ºæ¥çš„<code>log</code>é‡Œé¢æœ‰</p>
</li>
<li>
<p>ä»¥ä¸‹ä»£è¡¨æ˜¯<code>dependencymanagement</code>åœ¨èµ·ä½œç”¨</p>
<pre><code>- version managed from 0.17; omitted for duplicate)
</code></pre>
</li>
<li>
<p>ä»¥ä¸‹ä»£è¡¨æ˜¯ç‰ˆæœ¬å†²çªäº†</p>
<pre><code>omitted for conflict with 0.17
</code></pre>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/hexo_blog/2019/11/08/TLSç›¸å…³çŸ¥è¯†/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/hexo_blog/2019/11/08/TLSç›¸å…³çŸ¥è¯†/" itemprop="url">TLS - Operation</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-11-08T14:47:48+08:00">
                2019-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/security/" itemprop="url" rel="index">
                    <span itemprop="name">security</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="tlså’Œoauth"><a class="header-anchor" href="#tlså’Œoauth"></a>TLSå’ŒOAuth</h2>
<ul>
<li><a href="https://stackoverflow.com/questions/8378664/does-an-oauth-2-client-really-need-tls" target="_blank" rel="noopener">does-an-oauth-2-client-really-need-tls</a>ï¼š æˆ‘è‡ªå·±æœ‰ç‚¹æä¸æ¸…æ¥šè¿™äº›çš„å…³ç³»ï¼Œè¿™è¾¹æœ‰ä¸€ä¸ªè§£é‡Šå¾ˆæ˜¯æ¸…æ™°ï¼Œçœ‹äº†å°±æ˜ç™½äº†
<ul>
<li><em>3.1.2.1.  Endpoint Request Confidentiality If a redirection request will result in the transmission of an authorization code or access token over an open network (between the resource ownerâ€™s user-agent and the client), the client SHOULD require the use of a transport-layer security mechanism.</em> è¿™ä¸ªæ˜¯<code>Oauth</code>å®˜æ–¹æ–‡æ¡£é‡Œé¢çš„ä¸€æ®µè¯ã€‚</li>
<li>ä¸Šé¢ä¸€æ®µçš„æ„æ€åº”è¯¥æ˜¯è¿™æ ·çš„ï¼šä¸€ä¸ªç¬¬ä¸‰æ–¹è®¤è¯çš„è¯·æ±‚åœ¨ä¼ è¾“<code>authorization code</code>æˆ–è€…<code>access token</code>çš„æ—¶å€™åº”å½“åœ¨ä¼ è¾“å±‚ä½¿ç”¨å®‰å…¨æœºåˆ¶ã€‚è¿™é‡Œçš„å®‰å…¨æœºåˆ¶å°±æ˜¯æŒ‡<code>TLS</code>åè®®ã€‚</li>
</ul>
</li>
</ul>
<h2 id="tlsç‰ˆæœ¬"><a class="header-anchor" href="#tlsç‰ˆæœ¬"></a>TLSç‰ˆæœ¬</h2>
<ul>
<li><code>SSL3.0</code> å’Œ <code>TLS1.0</code> æ˜¯ä¸€ä¸ªä¸œè¥¿ã€‚å—¯ï¼Œå¾®è½¯å¹²çš„ã€‚å¾®è½¯è™½ç„¶æ˜¯ä¸€ä¸ªä¼Ÿå¤§çš„å…¬å¸ï¼Œä½†æ˜¯è¿™ä¸ªå¹²å¾—ä¸å¥½ï¼Œç›¸å½“ä¸å¥½ï¼Œè‡³å°‘æˆ‘æœ¬äººè§‰å¾—ä¸å¥½ã€‚å®åœ¨æ˜¯é™¤äº†å¢åŠ å¤§å®¶çš„æ··æ·†ä»¥å¤–ï¼Œæ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚å˜›ï¼Œæˆ‘ä»¬è‡ªå·±çš„äº§å“ä¹Ÿç»å¸¸å¹²è¿™ç§äº‹æƒ…ã€‚é€šå¸¸å‘¢ï¼Œæ˜¯å› ä¸ºè‡ªå·±è®¤ä¸ºå‘ç”Ÿäº†è·¨æ—¶ä»£çš„æ”¹å˜ï¼Œå¸Œæœ›è®©åˆ«äººä¹Ÿæ˜ç™½ã€‚</li>
<li>ç›®å‰æœ€æµè¡Œçš„ç‰ˆæœ¬æ˜¯<code>TLS1.2</code>ï¼Œæœ€æ–°çš„ç‰ˆæœ¬æ˜¯<code>TLS1.3</code>ã€‚</li>
<li><code>java8</code>ä¸­é»˜è®¤çš„æ˜¯<code>TLS1.2</code>ç‰ˆæœ¬ã€‚<code>java11</code>é‡Œé¢æ”¯æŒçš„æ˜¯<code>TLS1.3</code></li>
<li>å„ç§<code>web</code>åº”ç”¨æœåŠ¡å™¨çš„é…ç½®æ–‡ä»¶é‡Œé¢éƒ½å¯ä»¥é…ç½®æ”¯æŒæˆ–è€…ä¸æ”¯æŒçš„ç‰ˆæœ¬ã€‚æ¯”å¦‚<code>tomcat</code>æä¾›äº†å‚æ•°:<code>sslEnabledProtocols</code></li>
</ul>
<h3 id="å¦‚ä½•å‘ç°æˆ‘çš„æµè§ˆå™¨ä½¿ç”¨çš„tlsç‰ˆæœ¬"><a class="header-anchor" href="#å¦‚ä½•å‘ç°æˆ‘çš„æµè§ˆå™¨ä½¿ç”¨çš„tlsç‰ˆæœ¬"></a>å¦‚ä½•å‘ç°æˆ‘çš„æµè§ˆå™¨ä½¿ç”¨çš„TLSç‰ˆæœ¬</h3>
<ul>
<li>å› ä¸ºè¦æµ‹è¯•<code>tomcat</code>é‡Œé¢é…ç½®çš„å‚æ•°æ˜¯å¦ç”Ÿæ•ˆï¼Œæ‰€ä»¥ç¬¬ä¸€ååº”å°±æ˜¯æˆ‘å’‹çŸ¥é“å‘¢ã€‚åæ¥ç»åŒäº‹æç‚¹ï¼Œå…¶å®ç”¨<code>openssl</code>å°±å¯ä»¥äº†</li>
<li>åœ¨æµè§ˆå™¨çš„é…ç½®ä¸­èƒ½çœ‹åˆ°ï¼Œ æ¯”å¦‚IE, <code>File</code>-&gt;<code>Properties</code>, åœ¨<code>Connection</code>ä¸€æ å°±èƒ½çœ‹åˆ°ã€‚</li>
<li>å‚è€ƒé“¾æ¥ï¼š
<ul>
<li><a href="https://www.thesslstore.com/blog/google-chrome-72-deprecates-support-for-tls-1-0-tls-1-1/" target="_blank" rel="noopener">chromeå¦‚ä½•é…ç½®å’ŒæŸ¥çœ‹</a></li>
<li><a href="https://security.stackexchange.com/questions/19096/how-to-determine-if-a-browser-is-using-an-ssl-or-tls-connection/169418" target="_blank" rel="noopener">å¦‚ä½•æŸ¥çœ‹websiteçš„TLSç‰ˆæœ¬</a></li>
</ul>
</li>
</ul>
<h3 id="å¦‚ä½•æµ‹è¯•tlsè¿æ¥"><a class="header-anchor" href="#å¦‚ä½•æµ‹è¯•tlsè¿æ¥"></a>å¦‚ä½•æµ‹è¯•TLSè¿æ¥</h3>
<ul>
<li>è¿™ä¸ªæ˜¯åˆšéœ€å•Šåˆšéœ€ã€‚ä½¿ç”¨<code>openssl</code>è‚¯å®šä¹Ÿæ˜¯å¯ä»¥çš„ã€‚è¿™å›ä½¿ç”¨çš„æ˜¯<code>curl</code>å‘½ä»¤ã€‚</li>
<li><code>curl help</code>ä¸€ä¸‹å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨å‚æ•°å°±å¯ä»¥æŒ‡å®š<code>TLS</code>ç‰ˆæœ¬ï¼Œè¿˜æ˜¯å¾ˆå¥½ç”¨çš„ã€‚<br>
ğŸ˜¦ æˆ‘è§‰å¾—è‡ªå·±æœ‰æ—¶å€™æ˜¯å¾ˆå¥‡æ€ªçš„äººå•Šï¼Œä¸‹å›è¦æŠŠå®é™…ä½¿ç”¨çš„å‘½ä»¤å†™åœ¨è¿™é‡Œã€‚â•­(â•¯^â•°)â•®</li>
</ul>
<h2 id="tlsåŒå‘æ¡æ‰‹"><a class="header-anchor" href="#tlsåŒå‘æ¡æ‰‹"></a>TLSåŒå‘æ¡æ‰‹</h2>
<h3 id="keystoreå’Œtruststore"><a class="header-anchor" href="#keystoreå’Œtruststore"></a>KeyStoreå’ŒTrustStore</h3>
<ul>
<li><code>keystore</code>å’Œ<code>truststore</code>ä»å…¶æ–‡ä»¶æ ¼å¼æ¥çœ‹å…¶å®æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œéƒ½æ˜¯<code>.jks</code>æ–‡ä»¶ï¼Œåªæ˜¯ä¸ºäº†æ–¹ä¾¿ç®¡ç†å°†å…¶åˆ†å¼€</li>
<li><code>keystore</code>ä¸­ä¸€èˆ¬ä¿å­˜çš„æ˜¯æœåŠ¡å™¨ç«¯çš„ç§é’¥ï¼Œç”¨æ¥åŠ è§£å¯†æˆ–è€…ä¸ºåˆ«äººåšç­¾åã€‚å­˜å‚¨æœåŠ¡å™¨ç«¯çš„å…¬é’¥å’Œç§é’¥ã€‚</li>
<li><code>truststore</code>ä¸­ä¿å­˜çš„æ˜¯ä¸€äº›å¯ä¿¡ä»»çš„è¯ä¹¦ï¼Œä¸»è¦æ˜¯<code>java</code>åœ¨ä»£ç ä¸­è®¿é—®æŸä¸ª<code>https</code>çš„æ—¶å€™å¯¹è¢«è®¿é—®è€…è¿›è¡Œè®¤è¯çš„ï¼Œä»¥ç¡®ä¿å…¶å®å¯ä¿¡ä»»çš„ã€‚ä¸€èˆ¬ä¸ºå…¬é’¥<br>
<code>truststore</code>é‡Œé¢å­˜å‚¨çš„æ˜¯æœåŠ¡å™¨çš„ä¿¡ä»»å¯†é’¥å­˜å‚¨åº“ï¼Œå­˜<code>CA</code>å…¬é’¥ï¼Œä¹Ÿä¼šæœ‰äººåœ¨é‡Œé¢å­˜å‚¨å®¢æˆ·ç«¯çš„è¯ä¹¦é›†åˆã€‚</li>
<li>åº”è¯¥åœ¨ä¸åŒçš„åè®®ä¸­éƒ½æœ‰å¯èƒ½ç¢°åˆ°ï¼Œä¸ä»…ä»…æ˜¯<code>HTTPS</code>ï¼Œåœ¨ç½‘ä¸Šæœç´¢è¿‡ç¨‹ä¸­æœ‰<code>LDAP</code>ä¹Ÿç”¨åˆ°çš„ã€‚</li>
</ul>
<h3 id="keytool"><a class="header-anchor" href="#keytool"></a>Keytool</h3>
<ul>
<li><code>keytool</code>æ˜¯<code>java</code>é»˜è®¤å¸¦çš„å·¥å…·ã€‚é€šå¸¸ç”Ÿæˆ<code>.jks</code>æ ¼å¼çš„æ–‡ä»¶ã€‚ç§°ä¸º<code>keystore</code></li>
<li><code>keystore</code>æ–‡ä»¶é‡Œé¢å¯ä»¥å¸¦<code>key-pair</code>ï¼Œä¹Ÿå¯ä»¥æ˜¯è¯ä¹¦</li>
<li>ä»¥ä¸‹å‘½ä»¤æ˜¯ç”Ÿæˆä¸€ä¸ªåä¸º<code>keystore.jks</code>çš„<code>keystore</code>,å¹¶å°†è¯ä¹¦<code>jetty.crt</code>å¯¼å…¥åˆ°è¿™ä¸ªæ–‡ä»¶é‡Œé¢ã€‚åŒæ—¶æŒ‡å®šäº†å¯†ç ï¼Œå¹¶ä¸”åœ¨è¿‡ç¨‹ä¸­ä¸éœ€è¦å±å¹•äº¤äº’ã€‚<code>-trustcacerts</code>çš„å«ä¹‰æ˜¯ä¿¡ä»»è¯¥è¯ä¹¦</li>
</ul>
<pre><code>/opt/jdk/jre/bin/keytool -import -trustcacerts -file jetty.crt -keystore keystore.jks -alias jetty  -storepass changeit -noprompt
</code></pre>
<ul>
<li>
<p>è¿™æ¡å‘½ä»¤å¯ä»¥å°†ä¸Šä¸€æ¡å‘½ä»¤ä¸­å¯¼å…¥çš„è¯ä¹¦æ‰“å°è¾“å‡ºè¿›è¡Œæ£€éªŒ</p>
<p>/opt/jdk/jre/bin/keytool -list -v -keystore keystore.jks</p>
</li>
</ul>
<h3 id="openssl"><a class="header-anchor" href="#openssl"></a>openssl</h3>
<h3 id="jetty-tls-configuration"><a class="header-anchor" href="#jetty-tls-configuration"></a>Jetty TLS Configuration</h3>
<ul>
<li><code>keystore</code> é‡Œé¢å­˜å‚¨çš„æ˜¯<code>key-pair</code>å’Œ<code>certificate</code></li>
<li>å¯¹äº<code>Jetty</code>æ¥è¯´ï¼Œ<code>jetty.xml</code>åªæ”¯æŒ<code>keystore</code>ï¼Œè€Œä¸æ”¯æŒ<code>*.crt</code>çš„æ ¼å¼</li>
<li>é¡¹ç›®ä¸­ç¢°åˆ°äº†åªæä¾›<code>*.crt</code>æ–‡ä»¶çš„æƒ…å†µï¼Œé‚£ä¹ˆéœ€è¦è‡ªå·±äº§ç”Ÿ<code>keystore</code>ï¼Œå†å°†è¯ä¹¦å¯¼å…¥</li>
</ul>
<h2 id="å‚è€ƒé“¾æ¥"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2>
<ul>
<li><a href="https://www.cnblogs.com/gsls200808/p/4500246.html" target="_blank" rel="noopener">KeyStoreå’ŒTrustStore</a></li>
<li><a href="https://xz.aliyun.com/t/2530" target="_blank" rel="noopener">TLS åè®®è¯¦è§£</a></li>
<li><a href="https://stackoverflow.com/questions/19236628/jetty-9-setting-up-the-most-basic-ssl-https" target="_blank" rel="noopener">jetty-9-setting-up-the-most-basic-ssl-https</a></li>
<li><a href="https://wiki.eclipse.org/Jetty/Howto/Configure_SSL#Loading_Keys_and_Certificates_via_PKCS12" target="_blank" rel="noopener">Jetty/Howto/Configure SSL</a></li>
<li><a href="https://knowledge.digicert.com/solution/SO15252.html" target="_blank" rel="noopener">Import a certificate into a Jetty Java HTTP Servlet Web Server</a></li>
<li><a href="https://www.eclipse.org/jetty/documentation/current/configuring-ssl.html#loading-keys-and-certificates" target="_blank" rel="noopener">loading-keys-and-certificates</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/hexo_blog/2019/10/11/K8s-Service/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/hexo_blog/2019/10/11/K8s-Service/" itemprop="url">K8s Service</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-10-11T16:40:09+08:00">
                2019-10-11
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/docker/" itemprop="url" rel="index">
                    <span itemprop="name">docker</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Serviceçš„æ¦‚å¿µæœ‰ç‚¹å¤šï¼Œå†…å®¹ï¼Œå•ç‹¬æ‹å‡ºæ¥åšä¸€ç¯‡ã€‚</p>
<h2 id="å‚è€ƒé“¾æ¥"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2>
<ul>
<li><a href="https://www.kubernetes.org.cn/kubernetes-services" target="_blank" rel="noopener">åè¯è§£é‡Š Services</a></li>
<li><a href="https://segmentfault.com/a/1190000019376912" target="_blank" rel="noopener">Kubernetes Serviceè¯¦è§£</a></li>
</ul>
<h2 id="ä¸ºä»€ä¹ˆéœ€è¦service"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆéœ€è¦service"></a>ä¸ºä»€ä¹ˆéœ€è¦service</h2>
<p>æŒ‰ç…§å‚è€ƒé“¾æ¥2é‡Œé¢çš„è§£é‡Šï¼Œå€’æ˜¯å¾ˆå®¹æ˜“ç†è§£ã€‚<code>POD</code>å¯ä»¥èµ·å¾ˆå¤šä¸ªï¼Œæ˜¯å®ä½“ï¼Œè¿˜ä¸€ä¼šæœ‰ä¸€ä¼šæ²¡çš„ã€‚<br>
è€Œ<code>service</code>æ˜¯æš´éœ²æœåŠ¡çš„ï¼Œè¿™ä¹ˆè¯´ï¼Œåº”è¯¥åªæœ‰ä¸€ä¸ª<code>service</code>æ‰å¯¹å§ã€‚ç…ç€ç¡®å®å¦‚æ­¤å•Šã€‚</p>
<h2 id="services"><a class="header-anchor" href="#services"></a>Services</h2>
<p><code>service</code>æ˜¯<code>K8s</code>é‡Œé¢ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µã€‚ç±»å‹æ¯”è¾ƒå¤šã€‚K8sä¸­æ–‡æ–‡æ¡£é‡Œé¢çš„åè¯è§£é‡Šè¿˜æ˜¯æ¯”è¾ƒæ¸…æ¥šçš„ï¼Œå¹¶ä¸”ç»™å‡ºäº†ä¸ºä»€ä¹ˆéœ€è¦<code>service</code>ï¼Œ<code>service</code>å’Œ<code>pod</code>æœ‰ä»€ä¹ˆåŒºåˆ«</p>
<ul>
<li>
<p><code>Kubernete Service</code> æ˜¯ä¸€ä¸ªå®šä¹‰äº†ä¸€ç»„<code>Pod</code>çš„ç­–ç•¥çš„æŠ½è±¡ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰æ—¶å€™å«åšå®è§‚æœåŠ¡ã€‚è¿™äº›è¢«æœåŠ¡æ ‡è®°çš„<code>Pod</code>éƒ½æ˜¯ï¼ˆä¸€èˆ¬ï¼‰é€šè¿‡<code>label Selector</code>å†³å®šçš„ï¼ˆä¸‹é¢æˆ‘ä»¬ä¼šè®²åˆ°æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦ä¸€ä¸ªæ²¡æœ‰<code>label selector</code>çš„æœåŠ¡ï¼‰</p>
</li>
<li>
<p>A Kubernetes service is a named load balancer that proxies traffic to one or more containers.</p>
</li>
<li>
<p>The proxy works even if the containers are on different nodes. Services proxy communicate within the cluster and rarely expose ports to an outside interface.When you launch a service it looks like you cannot connect using curl or netcat unless you start it as part of Kubernetes. The recommended approach is to have a LoadBalancer service to handle external communications.<br>
<strong>å¥½å§ï¼Œè¿™æ®µè¯åŸºæœ¬æ²¡çœ‹æ‡‚ï¼Œæš‚æ—¶å°±ä¸ç®¡å®ƒäº†ã€‚serviceä¸ä»…ä»…æ˜¯load balancerå§ï¼Œéš¾é“æ¯ä¸€ç§serviceéƒ½æ˜¯load balancerçš„ä¸€ç§ä½“ç°å—ï¼Ÿ</strong></p>
</li>
<li>
<p>Kubernetes Services are an abstract that defines a policy and approach on how to access a set of Pods. The set of Pods accessed via a Service is based on a Label Selector.</p>
</li>
<li>
<p>Serviceæœ‰å¾ˆå¤šç§ï¼ŒåŒ…æ‹¬<code>targetPort</code>ï¼Œç»å¸¸ç”¨åˆ°çš„ï¼Œè¿˜æœ‰ï¼š<code>Cluster IP</code>ï¼Œ <code>NodePort</code> ï¼Œ<code>External IPs</code>ï¼Œ <code>Load Balancer</code>ä¹‹ç±»</p>
<ul>
<li>Cluster IPçš„è§£é‡Šï¼š Cluster IP is the default approach when creating a Kubernetes Service. The service is allocated an internal IP that other components can use to access the pods.</li>
</ul>
<p><strong>cluster IPæ˜¯é»˜è®¤çš„serviceçš„ç±»å‹ã€‚è¿™ç§serviceä¼šæš´éœ²ä¸€ä¸ªinternal IPï¼Œæ¥ä¾›ç»™ç³»ç»Ÿä¸­å…¶ä»–çš„serviceæ¥è®¿é—®è¿™å †podæä¾›çš„æœåŠ¡ï¼Œæ‰€ä»¥é€šå¸¸ä¹Ÿä¼šæœ‰portçš„éšå°„.</strong></p>
<ul>
<li>
<p>Target Portçš„è§£é‡Šï¼šTarget ports allows us to separate the port the service is available on from the port the application is listening on. TargetPort is the Port which the application is configured to listen on. Port is how the application will be accessed from the outside.<br>
<strong>è¿™å›æ¯”è¾ƒæ¸…æ¥šäº†ï¼Œserviceå…¶å®æ˜¯å°†PODæä¾›çš„æœåŠ¡è½¬å‡ºæ¥ï¼Œportæ˜¯å¼€åœ¨serviceä¸Šé¢ï¼Œè¿™æ ·å…¶ä»–çš„serviceè®¿é—®è¿™ä¸ªserviceçš„æ—¶å€™å°±æ˜¯ç”¨è¿™ä¸ªportï¼Œè€Œtarget portæ˜¯å¯¹åº”åˆ°PODçš„åº”ç”¨ä¸Šé¢çš„ã€‚æ¯”å¦‚æˆ‘ä»¬è‡ªå·±äº§å“çš„åŒ—å‘ç«¯å£çš„PODï¼Œæä¾›çš„æœåŠ¡å¼€åœ¨8080ä¸Šé¢ï¼Œyamlæ–‡ä»¶é‡Œé¢èµ·çš„serviceçš„portä¹Ÿæ˜¯8080ï¼Œå…¶å®ä¹Ÿå¯ä»¥æ”¹æˆå…¶ä»–çš„</strong></p>
</li>
<li>
<p>NodePortçš„è§£é‡Šï¼šthe NodePort exposes the service on each Nodeâ€™s IP via the defined static port. No matter which Node within the cluster is accessed, the service will be reachable based on the port number defined.<br>
<strong>å°±æ˜¯<code>get Nodes</code>çš„å‘½ä»¤å‡ºæ¥çš„Nodeå§ã€‚<code>get Nodes</code>å‘½ä»¤ç»™å‡ºçš„æ˜¯<code>hostname</code>ï¼Œæˆ‘ä»¬è‡ªå·±çš„ç¯å¢ƒé‡Œé¢ï¼Œ<code>hostname</code>ä¸€èˆ¬å®šä¹‰æ ¼å¼æ˜¯<code>node-10-210-154-52</code>,åé¢è¿™ä¸ªå°±æ˜¯nodeçš„IPã€‚è¿™äº›nodeå®é™…ä¸Šæ˜¯è™šæ‹Ÿæœºã€‚æˆ–è€…æ˜¯å®ä½“æœºï¼Œç°åœ¨åº”è¯¥éƒ½æ˜¯è™šæ‹Ÿçš„nodeã€‚æ¯”å¦‚å¯ä»¥åœ¨openstackçš„nodeé›†ç¾¤ä¸Šé¢æ­å»ºk8sçš„æœåŠ¡</strong></p>
</li>
</ul>
<ul>
<li>External IPsçš„è§£é‡Šï¼šç»™å®šmaster Nodeçš„ä¸€ä¸ªIPã€‚ç„¶åThe service is now bound to the IP address and Port 80 of the master node</li>
<li>Load Balancerçš„è§£é‡Šï¼šcloud Provideréƒ½æ˜¯æœ‰è‡ªå·±çš„load Balancerçš„ã€‚å¦‚æœæ²¡æœ‰çš„è¯ï¼Œå¯ä»¥dynamically allocate IP addresses to LoadBalancer type services.When a service requests a Load Balancer, the provider will allocate one from the 10.10.0.0/26 range defined in the configuration.è¿™ä¸ªæ˜¯ç¡®å®šçš„èŒƒå›´å—</li>
<li>ç»“åˆä¸Šé¢çš„ï¼Œæˆ‘è§‰å¾—éƒ½éœ€è¦å•Šã€‚</li>
</ul>
</li>
</ul>
<h2 id="æš´éœ²serviceçš„å‘½ä»¤"><a class="header-anchor" href="#æš´éœ²serviceçš„å‘½ä»¤"></a>æš´éœ²serviceçš„å‘½ä»¤</h2>
<ul>
<li><code>kubectl expose deployment first-deployment --port=80 --type=NodePort</code>
<ul>
<li>
<p>å°†èµ„æºæš´éœ²ä¸ºæ–°çš„Kubernetes Serviceã€‚</p>
</li>
<li>
<p>exposeåé¢çš„èµ„æºæœ‰å¾ˆå¤šç§ï¼ŒåŒ…æ‹¬ï¼špodï¼ˆpoï¼‰ï¼Œserviceï¼ˆsvcï¼‰ï¼Œreplication controllerï¼ˆrcï¼‰ï¼Œdeploymentï¼ˆdeployï¼‰ï¼Œreplica setï¼ˆrsï¼‰</p>
</li>
<li>
<p>A Kubernetes service deployment has, at least, two parts. A replication controller and a service. ç¨å¾®æœ‰ç‚¹ç†è§£äº†ã€‚ä¸€ä¸ªserviceéƒ¨ç½²çš„æ—¶å€™ä¸€èˆ¬æœ‰ä¸¤ä¸ªyamlæ–‡ä»¶</p>
</li>
<li>
<p><code>first-deployment</code>æ˜¯deploymentçš„åå­—</p>
</li>
<li>
<p>port æ˜¯å†…éƒ¨çš„ç«¯å£</p>
</li>
<li>
<p>â€“target-portæ˜¯å¤–éƒ¨è®¿é—®çš„ç«¯å£</p>
</li>
<li>
<p>å®Œæ•´è¯­æ³•ä¸ºï¼š</p>
</li>
</ul>
</li>
</ul>
<pre><code>expose (-f FILENAME | TYPE NAME) [--port=port] [--protocol=TCP|UDP] [--target-port=number-or-name] [--name=name] [--external-ip=external-ip-of-service] [--type=type]
</code></pre>
<h3 id="yamlæ–‡ä»¶"><a class="header-anchor" href="#yamlæ–‡ä»¶"></a>yamlæ–‡ä»¶</h3>
<ul>
<li>å‚è€ƒé“¾æ¥äºŒä¸­çš„yamlæ–‡ä»¶çš„ä¾‹å­å¦‚ä¸‹ï¼š</li>
</ul>
<pre><code>apiVersion: v1
kind: Service
metadata:
  name: gowebsvc
spec:
  selector:
    app: goweb
  ports:
  - name: default
    protocol: TCP
    port: 80
    targetPort: 8000
  type: ClusterIP
</code></pre>
<ul>
<li><code>selector</code>æŒ‡å®šäº†æ˜¯å“ªä¸ªpodï¼Œå› ä¸ºpodå¯èƒ½æœ‰å¾ˆå¤šï¼Œæ‰€ä»¥è¿™é‡Œç”¨çš„æ˜¯podçš„tag <code>app: goweb</code>ï¼Œå°±æ˜¯è¯´ï¼Œè¿™ä¸ªserviceæ˜¯æš´éœ²æ‰€æœ‰è¿™ä¸ªtagçš„podçš„åŠŸèƒ½çš„</li>
</ul>
<h2 id="è¯·æ±‚è½¬å‘"><a class="header-anchor" href="#è¯·æ±‚è½¬å‘"></a>è¯·æ±‚è½¬å‘</h2>
<p><code>cluster ip</code>ç±»ä¼¼VIP,ä»è¿™ä¸ªåå­—æ¥è¯´ï¼Œåº”è¯¥æ˜¯è®¤ä¸ºä¸€ç»„podå°±æ˜¯ä¸€ä¸ª<code>cluster</code>ï¼Œç¡®å®ä¹Ÿå¯ä»¥å¦‚æ­¤è®¤ä¸ºã€‚æ—¢ç„¶æ˜¯ç±»ä¼¼<code>VIP</code>ï¼Œé‚£ä¹ˆå°±å¯ä»¥è¢«è®¤ä¸ºæ˜¯<code>load banlancer</code>ï¼Œé‚£ä¹ˆå°±æœ‰ç­–ç•¥çš„é—®é¢˜äº†ã€‚<br>
ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹<code>clusterIP 10.106.202.0</code>çš„è½¬å‘ç­–ç•¥</p>
<pre><code>iptables-save | grep 10.106.202.0
</code></pre>
<p>éœ€è¦å®é™…æ“ä½œï¼Œæš‚æ—¶æ²¡æ—¶é—´ï¼Œè·³è¿‡è¿™ä¸€æ®µçš„ç»†èŠ‚ã€‚ç›®å‰å…ˆç®€å•ç†è§£ä¸€ä¸‹ï¼šå½“ä¸€æ¡<code>request</code>å‘åˆ°æŸä¸ª<code>service</code>çš„<code>cluster ip + port</code>ä¸Šé¢æ—¶ï¼Œä¼šç»è¿‡ä¸¤æ¬¡æ•°æ®é“¾è½¬å‘ï¼ˆè¿™é‡Œçš„æ•°æ®é“¾ï¼ŒæŒ‡çš„æ˜¯<code>iptables</code>é‡Œé¢çš„æ•°æ®è½¬å‘è§„åˆ™ï¼‰ï¼Œç¬¬ä¸€æ¬¡æ•°æ®é“¾è½¬å‘æ—¶å€™ä¼šè¿›è¡Œloadçš„åˆ†é…ã€‚<br>
ç¬¬ä¸€æ¡è½¬å‘é“¾å¦‚ä¸‹.<code>KUBE-SVC-SEG6BTF25PWEPDFT</code>è½¬å‘é“¾å°†requestå‡åˆ†åˆ°4ä¸ªpodä¸Šé¢ã€‚</p>
<pre><code> -A KUBE-SVC-SEG6BTF25PWEPDFT -m statistic --mode random --probability 0.25000000000 -j KUBE-SEP-5ZXTVLEM4DKNW7T2
 -A KUBE-SVC-SEG6BTF25PWEPDFT -m statistic --mode random --probability 0.33332999982 -j KUBE-SEP-EBFXI7VOCPDT2QU5
 -A KUBE-SVC-SEG6BTF25PWEPDFT -m statistic --mode random --probability 0.50000000000 -j KUBE-SEP-C3PKSXKMO2M43SPF
 -A KUBE-SVC-SEG6BTF25PWEPDFT -j KUBE-SEP-2GQCCNJGO65Z5MFS
</code></pre>
<p>ç¬¬äºŒæ¬¡è½¬å‘çš„æ—¶å€™ï¼Œä¼šå¯¹ç›®çš„åœ°åš<code>DNAT</code>ï¼ˆğŸ˜¦ å®Œå…¨ä¸çŸ¥é“è¿™æ˜¯å•¥ï¼‰ï¼Œåæ­£åšäº†è¿™ä¸ª<code>DNAT</code>ï¼Œç„¶åå°±<code>DNAT</code>åˆ°äº†<code>endpoint</code>ä¸Šé¢ã€‚</p>
<p><em>æ¯”ç…§ä¸Šé¢çš„è§„åˆ™ï¼Œå¯ä»¥çœ‹å‡º<code>KUBE-SEP-5ZXTVLEM4DKNW7T2</code>è¿™æ¡è§„åˆ™å¯¹è¯·æ±‚çš„ç›®çš„åœ°å€ä½œäº†<code>DNAT</code>åˆ°<code>10.244.1.15:8000</code>ï¼Œè¿™æ­£æ˜¯<code>goweb</code>PODç»„ä¸­<code>goweb-55c487ccd7-5t2l2</code>è¿™ä¸ªpodçš„ipåœ°å€</em></p>
<pre><code>[root@master-1 ~]# iptables-save | grep  &quot;A KUBE-SEP-5ZXTVLEM4DKNW7T2&quot; 
-A KUBE-SEP-5ZXTVLEM4DKNW7T2 -s 10.244.1.15/32 -j KUBE-MARK-MASQ
-A KUBE-SEP-5ZXTVLEM4DKNW7T2 -p tcp -m tcp -j DNAT --to-destination 10.244.1.15:8000
</code></pre>
<h3 id="endpoint"><a class="header-anchor" href="#endpoint"></a>endpoint</h3>
<ul>
<li>
<p>åœ¨serviceåˆ›å»ºçš„æ—¶å€™ï¼Œ<code>kube-proxy</code>ç»„ä»¶ï¼ˆæ¯ä¸ªk8sæœåŠ¡å™¨éƒ½ä¼šæœ‰çš„ç»„ä»¶ï¼‰ä¼šè‡ªåŠ¨åˆ›å»ºåŒåçš„<code>endpoint</code>å¯¹è±¡ã€‚</p>
</li>
<li>
<p>åŠ¨æ€åœ°è·Ÿè¸ªåŒ¹é…<code>selector</code>çš„ä¸€ç»„<code>pod</code>å½“å‰<code>ip</code>ï¼ˆ<code>pod</code>çš„<code>ip</code>åœ¨<code>pod</code>çš„<code>yaml</code>æ–‡ä»¶é‡Œé¢å¯ä»¥çŸ¥é“ï¼Œåå­—å°±æ˜¯<code>podIP</code>ï¼‰åŠç«¯å£ï¼Œå¹¶ç”Ÿæˆç›¸åº”çš„<code>iptables KUBE-SVC-xxx</code>è§„åˆ™</p>
</li>
<li>
<p><code>service</code>æ˜¯ç”¨äº†<code>endpoint</code>æ¥å¯¹podè¿›è¡ŒåŠ¨æ€çš„è·Ÿè¸ªçš„ã€‚ä¸€ä¸ª<code>pod</code>çš„IPå‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œ<code>endpoint</code>å’Œ<code>KUBE-SVC-XXX</code>è§„åˆ™ä¼šç›¸åº”å˜åŒ–</p>
</li>
<li>
<p><code>endpoint</code>æ˜¯<code>k8s</code>çš„å¦ä¸€ä¸ªå¯¹è±¡ï¼Œç”Ÿæˆä¸€ä¸ª<code>service</code>çš„æ—¶å€™ï¼Œä¼šç›¸å¯¹åº”ç”Ÿæˆä¸€ä¸ª<code>endpoint</code>.</p>
<p>$ kubectl get ep -n sheild-1 eric-act-activation-mml<br>
NAME         ENDPOINTS                           AGE<br>
eric-act-activation-mml  192.168.15.102:8111,192.168.15.102:8010   1h</p>
</li>
</ul>
<h3 id="è¯·æ±‚ä»£ç†çš„ä¸‰ç§æ–¹å¼"><a class="header-anchor" href="#è¯·æ±‚ä»£ç†çš„ä¸‰ç§æ–¹å¼"></a>è¯·æ±‚ä»£ç†çš„ä¸‰ç§æ–¹å¼</h3>
<p>å…¨æ–‡å‚è€ƒé“¾æ¥äºŒé‡Œé¢æœ‰ä¸‰ç§æ–¹å¼ã€‚ç”±äºç½‘ç»œåŸºç¡€è¾ƒå·®ï¼Œå…ˆè®°å½•åœ¨è¿™é‡Œï¼š</p>
<ul>
<li><code>Userspace</code>æ¨¡å¼ï¼šè¿™ç§æ¨¡å¼å®Œå…¨ä¾é <code>kube-proxy</code>æ¥ï¼Œ<em><code>Userspace</code>æ¨¡å¼çš„ä»£ç†è½¬å‘ä¸»è¦ä¾é <code>kube-proxy</code>å®ç°ï¼Œå·¥ä½œåœ¨ç”¨æˆ·æ€ã€‚æ‰€ä»¥ï¼Œè½¬å‘æ•ˆç‡ä¸é«˜</em></li>
<li><code>iptables</code>æ¨¡å¼: ä¹Ÿå°±æ˜¯ä¸Šé¢ç¨åŠ è§£é‡Šçš„æ–¹æ³•ï¼Œæ˜¯ç›®å‰çš„é»˜è®¤æ¨¡å¼ã€‚</li>
</ul>
<p><em>ä¸userspaceæ¨¡å¼æœ€å¤§çš„ä¸åŒç‚¹åœ¨äºï¼Œkube-proxyåªåŠ¨æ€åœ°ç»´æŠ¤iptablesï¼Œè€Œè½¬å‘å®Œå…¨é iptableså®ç°ã€‚ç”±äºiptableså·¥ä½œåœ¨å†…æ ¸æ€ï¼Œä¸ç”¨åœ¨ç”¨æˆ·æ€ä¸å†…æ ¸æ€åˆ‡æ¢ï¼Œæ‰€ä»¥ç›¸æ¯”userspaceæ¨¡å¼æ›´é«˜æ•ˆä¹Ÿæ›´å¯é ã€‚ä½†æ˜¯æ¯ä¸ªæœåŠ¡éƒ½ä¼šç”Ÿæˆè‹¥å¹²æ¡iptablesè§„åˆ™ï¼Œå¤§å‹é›†ç¾¤iptablesè§„åˆ™æ•°ä¼šéå¸¸å¤šï¼Œé€ æˆæ€§èƒ½ä¸‹é™ä¹Ÿä¸æ˜“æ’æŸ¥é—®é¢˜ã€‚</em></p>
<ul>
<li><code>ipvs</code>æ¨¡å¼: åœ¨<code>v1.9</code>ç‰ˆæœ¬ä»¥åï¼ŒæœåŠ¡æ–°å¢äº†<code>ipvs</code>è½¬å‘æ–¹å¼.</li>
</ul>
<p><em><code>ipvs</code>åŒæ ·å·¥ä½œåœ¨å†…æ ¸æ€ï¼Œè€Œä¸”åº•å±‚è½¬å‘æ˜¯ä¾é <code>hashè¡¨</code>å®ç°ï¼Œæ‰€ä»¥æ€§èƒ½æ¯”<code>iptables</code>è¿˜è¦å¥½çš„å¤šï¼ŒåŒæ­¥æ–°è§„åˆ™ä¹Ÿæ¯”<code>iptables</code>å¿«ã€‚åŒæ—¶ï¼Œè´Ÿè½½å‡è¡¡çš„æ–¹å¼é™¤äº†ç®€å•rrè¿˜æœ‰å¤šç§é€‰æ‹©ï¼Œæ‰€ä»¥å¾ˆé€‚åˆåœ¨å¤§å‹é›†ç¾¤ä½¿ç”¨ã€‚è€Œç¼ºç‚¹å°±æ˜¯å¸¦æ¥äº†é¢å¤–çš„é…ç½®ç»´æŠ¤æ“ä½œã€‚</em></p>
<h3 id="å‚è€ƒé“¾æ¥-v2"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥-v2"></a>å‚è€ƒé“¾æ¥</h3>
<ul>
<li>å‚è€ƒé“¾æ¥ï¼š
<ul>
<li><a href="https://blog.csdn.net/u011563903/article/details/86692694" target="_blank" rel="noopener">K8S kube-proxy iptables åŸç†åˆ†æ</a></li>
</ul>
</li>
</ul>
<h2 id="æœåŠ¡å‘ç°"><a class="header-anchor" href="#æœåŠ¡å‘ç°"></a>æœåŠ¡å‘ç°</h2>
<p>å…ˆåŒºåˆ†ä¸€ä¸‹ä¸Šé¢çš„è¯·æ±‚è½¬å‘å’Œè¿™é‡Œçš„æœåŠ¡å‘ç°ã€‚<br>
è¯·æ±‚çš„è¯é€šå¸¸æ˜¯ç«¯å£å·+åœ°å€å°±è¡Œå•¦ã€‚æœåŠ¡å‘ç°è¦èƒ½å¤Ÿå‘ç°è¿™ä¸ªserviceæ‰è¡Œã€‚å°±æ˜¯å¦‚ä½•è®©å¦ä¸€ä¸ªserviceçŸ¥é“è¿™ä¸ªserviceçš„ipæˆ–è€…hostnameï¼Œæˆ–è€…è®©k8så¤–çš„å®¢æˆ·çŸ¥é“æŸä¸ªserviceçš„ipå’Œç«¯å£</p>
<h3 id="å†…éƒ¨æœåŠ¡å‘ç°"><a class="header-anchor" href="#å†…éƒ¨æœåŠ¡å‘ç°"></a>å†…éƒ¨æœåŠ¡å‘ç°</h3>
<p>å†…éƒ¨æœåŠ¡å‘ç°æœ‰ä¸¤ç§æ–¹å¼ï¼šç¯å¢ƒå˜é‡å’ŒDNS</p>
<h3 id="å¤–éƒ¨æœåŠ¡å‘ç°"><a class="header-anchor" href="#å¤–éƒ¨æœåŠ¡å‘ç°"></a>å¤–éƒ¨æœåŠ¡å‘ç°</h3>
<p>å¤–éƒ¨æœåŠ¡å‘ç°ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯k8sæœåŠ¡å™¨ä»¥å¤–æ¥å‘ç°æŸä¸ªserviceæä¾›çš„æœåŠ¡</p>
<ul>
<li>å‚è€ƒé“¾æ¥ï¼š
<ul>
<li><a href="https://www.cnblogs.com/chris-cp/p/6724057.html" target="_blank" rel="noopener">k8så®æˆ˜ä¹‹Service</a></li>
</ul>
</li>
</ul>
<h4 id="nodeport"><a class="header-anchor" href="#nodeport"></a>NodePort</h4>
<ul>
<li><code>nodePort</code> å’Œ <code>node</code>æ˜¯ä¸€å¯¹ï¼Œé¦–å…ˆè¦ç†è§£ä¸€ä¸‹<code>node</code>çš„æ¦‚å¿µã€‚è¿™è¾¹çš„<code>node</code>ç›¸å½“äºæ˜¯<code>VM</code>ã€‚</li>
<li>å°±æ˜¯è¿™æ ·çš„ï¼Œæˆ‘æœ‰ä¸€å¥—ç¡¬ä»¶ï¼Œç„¶åæˆ‘åœ¨ä¸Šè¾¹æ­è™šæ‹Ÿç¯å¢ƒï¼Œæ¯”å¦‚<code>openstack</code>ï¼Œ<code>openstack</code>ä¼šå…ˆæ­å‡ºä¸€å †<code>node</code>æ¥ï¼Œç„¶åå†åœ¨è¿™å †<code>node</code>ä¸Šè¾¹è£…<code>k8s</code>,å»º<code>namespace</code>ï¼Œæ¯ä¸ª<code>namespace</code>é‡Œé¢å†å»º<code>pod</code>å•Šä¹‹ç±»çš„ã€‚</li>
<li>æ‰€ä»¥å¯ä»¥ç†è§£æˆ<code>VM</code>ï¼Œé‚£ä¹ˆè¿™ä¸ª<code>IP</code>æ˜¯å¯ä»¥è®¿é—®åˆ°çš„ã€‚</li>
<li><em><code>NodePort</code>æ˜¯ç±»å‹ä¸º<code>NodePort</code>çš„<code>Service</code>ï¼Œ<code>k8s</code>é™¤äº†ä¼šåˆ†é…ç»™<code>NodePort</code>ä¸€ä¸ªå†…éƒ¨çš„è™šæ‹Ÿ<code>IP</code>ï¼Œå¦å¤–ä¼šåœ¨æ¯ä¸€ä¸ª<code>Node</code>ä¸Šæš´éœ²ç«¯å£<code>NodePort</code>ï¼Œå¤–éƒ¨ç½‘ç»œå¯ä»¥é€šè¿‡[NodeIP]:[NodePort]è®¿é—®åˆ°æœåŠ¡ã€‚</em></li>
<li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>NodePort</code>ä¼šåœ¨æ¯ä¸ª<code>node</code>ä¸Šé¢æ³¨å†Œè‡ªå·±ã€‚æ‰€ä»¥è¿™ä¸ª<code>NodeIP</code>å¯ä»¥æ˜¯<code>cluster</code>çš„æ¯ä¸ª<code>node</code>ã€‚<em>è¯¥æ–¹å¼æŠŠæœåŠ¡æš´éœ²åœ¨æ¯ä¸ª<code>Node</code>ä¸»æœº<code>IP</code>çš„ç‰¹å®šç«¯å£ä¸Š,åŒä¸€ä¸ªæœåŠ¡åœ¨æ‰€æœ‰<code>Node</code>ä¸Šç«¯å£æ˜¯ç›¸åŒçš„ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆç›¸åº”çš„è·¯ç”±è½¬å‘åˆ°<code>ClusterIP</code></em>ã€‚æ‰€ä»¥<code>NodePort</code>çš„<code>service</code>ä¹Ÿæ˜¯æœ‰<code>cluster IP</code>çš„ã€‚</li>
</ul>
<h4 id="loadbalancer"><a class="header-anchor" href="#loadbalancer"></a>LoadBalancer</h4>
<ul>
<li><code>LoadBalancer</code>æ˜¯ç±»å‹ä¸º<code>LoadBalancer</code>çš„<code>Service</code>ï¼Œå®ƒæ˜¯å»ºç«‹åœ¨<code>NodePort Service</code>é›†ç¾¤åŸºç¡€ä¸Šçš„ï¼Œ<code>k8s</code>ä¼šåˆ†é…ç»™<code>LoadBalancer Service</code>ä¸€ä¸ªå†…éƒ¨çš„<code>è™šæ‹ŸIP</code>ï¼Œå¹¶ä¸”æš´éœ²<code>NodePort</code>ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œ<code>k8s</code>è¯·æ±‚åº•å±‚äº‘å¹³å°åˆ›å»ºä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨ï¼Œå°†æ¯ä¸ª<code>Node</code>ä½œä¸ºåç«¯ï¼Œè´Ÿè½½å‡è¡¡å™¨å°†è½¬å‘è¯·æ±‚åˆ°<code>[NodeIP]:[NodePort]</code></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/hexo_blog/2019/08/22/5G/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/hexo_blog/2019/08/22/5G/" itemprop="url">5G</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-08-22T14:04:36+08:00">
                2019-08-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>ä½œä¸ºé€šä¿¡è¡Œä¸šçš„ä¸€åè½¯ä»¶å¼€å‘äººå‘˜ï¼Œæˆ‘è¦å¼€å§‹å­¦ä¹ 5Gå•¦ã€‚ğŸ˜ƒ</p>
<p>é‡Œé¢æœ‰éå¸¸å¤šçš„æ–°ç½‘å…ƒå¼•å…¥ã€‚å„ç§ç¼©å†™æ¼«å¤©é£èˆ ğŸ˜¢</p>
<h2 id="å‚è€ƒé“¾æ¥"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2>
<ul>
<li><a href="https://medium.com/5g-nr/5g-service-based-architecture-sba-47900b0ded0a" target="_blank" rel="noopener">5G Service-Based Architecture (SBA)</a></li>
<li><a href="https://www.grandmetric.com/2018/03/02/5g-core-network-functions/" target="_blank" rel="noopener">5G Core Network Functions</a></li>
</ul>
<h2 id="5gc-æ¦‚è¿°"><a class="header-anchor" href="#5gc-æ¦‚è¿°"></a>5GC æ¦‚è¿°</h2>
<ul>
<li><code>5G</code>é‡Œé¢çš„æ–°çš„<code>core network</code>ä¸€èˆ¬å«åš<code>NR</code>ï¼Œä½†æ˜¯ä¹Ÿæœ‰çš„åœ°æ–¹ï¼Œæ¯”å¦‚éœ“è™¹å›½ï¼Œç§°ä¸º<code>next generation</code></li>
<li><code>SA</code>å’Œ<code>NSA</code>ï¼š<code>SA</code>å°±æ˜¯<code>standalone</code>,<code>NSA</code>å°±æ˜¯<code>non standslone</code>ã€‚è¿™è¾¹çš„<code>SA</code>å…¶å®å°±æ˜¯è¯´åªæœ‰<code>5G</code>ï¼Œåé¢å°±æ˜¯<code>4G</code>å’Œ<code>5G</code>å¹¶å­˜ã€‚ä¸åŒçš„è¿è¥å•†ä¼šæœ‰ä¸åŒçš„ç½‘ç»œçŠ¶å†µã€‚
<ul>
<li>ç°åœ¨æ­£å¤„äºä¸€ä¸ªè¿‡æ¸¡æœŸé—´ï¼Œä¹Ÿå¯èƒ½ä¼šé•¿æœŸå­˜åœ¨ï¼Œå‡ºç°äº†ä¸€äº›åœ¨4Gçš„ç½‘å…ƒä¸Šé¢å¼€å‘5Gçš„åŠŸèƒ½ï¼Œç„¶åä½œä¸º5Gçš„ç½‘å…ƒæ¥ç”¨çš„æƒ…å†µã€‚</li>
</ul>
</li>
<li>é€šå¸¸æˆ‘ä»¬å…³å¿ƒçš„<code>5GC</code>æ˜¯<code>5G corenetwork</code>çš„ç¼©å†™ã€‚ç„¶å<code>5G</code>çš„æ ¸å¿ƒæœ‰ä¸‰å¤§ç±»: <code>SBA - service based architecture</code>, <code>CUPS - Control and User Plane Separation</code> å’Œ ç½‘ç»œåˆ‡ç‰‡<br>
<strong>æ‰€ä»¥5GCå’ŒNRæ˜¯ä¸€ä¸ªä¸œè¥¿?</strong></li>
<li>é…ç½®è¿˜æ˜¯å’Œ4Gä¸€æ ·çš„ã€‚ç»Ÿä¸€æ¥é…ç½®çš„ã€‚<code>E&amp;M</code>ç»Ÿä¸€æ¥åšï¼Œå› ä¸ºç°åœ¨å¹³å°è½¯ä»¶æ˜¯ä¸€è‡´ï¼Œæ‰€ä»¥RANå’Œcoreéƒ½ä¸€æ ·ï¼Œéƒ½ç”¨ä¸€ä¸ªæ¥åšé…ç½®</li>
<li><code>UDC</code>æ¢äº†ä¸ªåå­—å«<code>UDR</code></li>
</ul>
<h3 id="sba"><a class="header-anchor" href="#sba"></a>SBA</h3>
<ul>
<li>
<p><code>SBA</code> æ„Ÿè§‰å’Œè½¯ä»¶æ¶æ„ä¸Šé¢çš„å¾®æœåŠ¡æœ‰ç‚¹å¼‚æ›²åŒå·¥çš„æ„Ÿè§‰ã€‚<code>4G</code>æ—¶ä»£æ˜¯å„ç§å„æ ·çš„åè®®ï¼Œæ¯ä¸¤ä¸ªç½‘å…ƒä¹‹é—´å°±å¯èƒ½æœ‰ä¸€ç§åè®®ï¼Œå¹¶ä¸”è¿˜å„ä¸ç›¸åŒã€‚ä½†æ˜¯åˆ°äº†<code>5G</code>çš„æ—¶å€™å°±æ˜¯å¤§å®¶ç»Ÿä¸€éƒ½æ˜¯ç”¨<code>HTTP</code>åè®®äº†ã€‚ç„¶åå„ä¸ªç½‘å…ƒåªæ˜¯æä¾›<code>service</code></p>
</li>
<li>
<p>æ‰€ä»¥SBAæ˜¯ä¸€ç§æ¶æ„</p>
<p><img src="https://www.grandmetric.com/wp-content/uploads/2018/03/5G_Core_Network.png" alt></p>
</li>
</ul>
<h2 id="5g-nr"><a class="header-anchor" href="#5g-nr"></a>5G NR</h2>
<p><code>NR</code>æŒ‡çš„æ˜¯<code>new Radio</code>ã€‚åœ¨<code>5G</code>é‡Œé¢åˆ†ä¸ºäº†<code>NE - Network Element</code>å’Œ<code>NF - Network Function</code>ä¸¤ä¸ªæ¦‚å¿µã€‚é¡¾åæ€ä¹‰ï¼Œ<code>NF</code>æ˜¯å¾€å¤–æä¾›æœåŠ¡çš„</p>
<ul>
<li><code>NF</code>æ˜¯ä¸€ä¸ªåŠŸèƒ½ï¼Œ3GPPé‡Œé¢å®šä¹‰çš„ï¼ŒNEæ˜¯ä¸€ä¸ªå®é™…çš„ç½‘å…ƒã€‚ä¸€ä¸ªNEå¯èƒ½ä¼šå®ç°å¤šä¸ªNFã€‚</li>
</ul>
<h3 id="amf"><a class="header-anchor" href="#amf"></a>AMF</h3>
<p>ä¸æ¥å…¥ç½‘ç›¸å…³</p>
<h4 id="smf"><a class="header-anchor" href="#smf"></a>SMF</h4>
<p>å¯èƒ½æœ‰ä¸€äº›ä¸provisionç›¸å…³çš„</p>
<h3 id="nef-network-exposure-function"><a class="header-anchor" href="#nef-network-exposure-function"></a>NEF - Network Exposure Function</h3>
<h4 id="scef-å’Œ-mtc-iwf"><a class="header-anchor" href="#scef-å’Œ-mtc-iwf"></a>SCEF å’Œ MTC - IWF</h4>
<ul>
<li><code>(MTC - IWF) Machine Type Communications - Interwording Function</code>,</li>
</ul>
<h4 id="nefæ˜¯ä»€ä¹ˆ"><a class="header-anchor" href="#nefæ˜¯ä»€ä¹ˆ"></a>NEFæ˜¯ä»€ä¹ˆ</h4>
<ul>
<li>NEF provides a mechanism for securely exposing services and features of the 5G core.</li>
<li><code>NEF</code>æ˜¯å’Œ<code>SMF</code>è¿æ¥åœ¨ä¸€èµ·çš„ã€‚å°†<code>core</code>é‡Œé¢çš„åŠŸèƒ½æš´éœ²ç»™å¤–ç•Œçš„åº”ç”¨</li>
</ul>
<h3 id="nrf"><a class="header-anchor" href="#nrf"></a>NRF</h3>
<h4 id="nrfæ˜¯ä»€ä¹ˆ"><a class="header-anchor" href="#nrfæ˜¯ä»€ä¹ˆ"></a>NRFæ˜¯ä»€ä¹ˆ</h4>
<ul>
<li><code>NF Repository function (NRF)</code> supports: service discovery function, maintains NF profile and available NF instances. (not present in EPC world)ã€‚</li>
<li>æ›¿æ¢äº†åŸæ¥<code>4G</code>é‡Œé¢çš„<code>ENUM</code>å’Œ<code>AAA</code></li>
<li><code>NRF</code>çš„åŠŸèƒ½çœ‹èµ·æ¥æ¯”è¾ƒç®€å•ï¼Œæœ‰ä»¥ä¸‹ï¼š
<ul>
<li>Service registration and discovery function so that Network Functions can discover each other.</li>
<li>Maintains NF profile and available NF instances</li>
<li>å—¯ï¼Œå°±æ˜¯ä»¥ä¸Šè¯´çš„ï¼Œ<code>NR</code>ä¼šå°†è‡ªå·±æ³¨å†Œåˆ°<code>NRF</code>é‡Œé¢ï¼Œæ³¨å†Œæ—¶å€™ä¼šå¸¦ä¸Šä¸å°‘ä¿¡æ¯ï¼Œæ¯”å¦‚èƒ½æä¾›çš„æœåŠ¡ï¼Œè‡ªå·±è®¤å¯çš„èƒ½è®¿é—®æœåŠ¡çš„<code>NR</code>ä¹‹ç±»ï¼ŒåŒæ—¶ä¼šå°†è‡ªå·±çš„åå­—å‘Šè¯‰ç»™<code>NRF</code>ã€‚è¿˜æœ‰è®¢é˜…åŠŸèƒ½ã€‚å°±æ˜¯åœ¨<code>NRF</code>è®¢é˜…è‡ªå·±å…³æ³¨å“ªäº›<code>NF</code>çš„å“ªäº›service</li>
<li><code>NR</code>å¯ä»¥é€šè¿‡<code>NRF</code>æ¥è®¿é—®å…¶ä»–<code>NR</code>ã€‚è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</li>
<li><code>NRF</code>åœ¨å‘Šè¯‰åŒæ—¶ä¼šé¢å‘ä¸€ä¸ª<code>token</code>ï¼Œåšä¸€äº›åˆæ­¥çš„éªŒè¯ã€‚</li>
</ul>
</li>
</ul>
<p><img src="https://miro.medium.com/max/1008/1*VfK1R5ie3DRElDFHjrI-kw.png" alt></p>
<p><em>Network Repository Function service registration and discovery</em> (Credit: <a href="http://www.3gpp.org/ftp/information/presentations/Presentations_2017/webinar-ct-status-11-2017.pdf" target="_blank" rel="noopener">3GPP</a>)</p>
<ul>
<li>å®é™…çš„éƒ¨ç½²å’ŒåŠŸèƒ½å¯èƒ½ä¼šæ›´åŠ å¤æ‚ï¼Œä¾‹å¦‚ï¼Œ
<ul>
<li>æ¯ä¸ªç½‘ç»œåˆ‡ç‰‡å¯ä»¥æœ‰è‡ªå·±çš„<code>NRF</code></li>
<li>æˆ‘å¤§ä¸­ååœ°åŸŸå¹¿é˜”ï¼Œè¿˜ä¼šæœ‰åœ°åŸŸçš„æ¦‚å¿µï¼Œä¸€ä¸ªä¸å¤Ÿã€‚</li>
<li>é‚£ä¹ˆä¸€ä¸ªä¸Šæµ·äººæ¼«æ¸¸åˆ°åŒ—äº¬ï¼Œè”ä¸Šäº†åŒ—äº¬çš„<code>NRF</code>,åŒ—äº¬çš„<code>NRF</code>å¾—å’Œä¸Šæµ·çš„è¿›è¡Œé€šä¿¡ã€‚å¦‚æœæ¼«æ¸¸åˆ°äº†å¢ƒå¤–ï¼Œ å°±æ›´åŠ å¤æ‚äº†ã€‚</li>
<li><code>NRF</code>ä¹Ÿå¯ä»¥ç›‘æ§å„ä¸ªç½‘å…ƒçš„çŠ¶æ€ï¼Œæˆ–è€…æä¾›æ›´åŠ å¤æ‚çš„åŠŸèƒ½</li>
</ul>
</li>
<li>åœ¨<code>R16</code>é‡Œé¢æå‡ºäº†ä¸€ä¸ªproxyçš„æ¦‚å¿µï¼Œ<code>SCP - service Communication proxy</code>ï¼Œå› ä¸º<code>NRF</code>çš„ç½‘ç»œé€šä¿¡è¿‡äºç¹æ‚ï¼Œé€ æˆäº†å¾ˆå¤§çš„è´Ÿæ‹…ï¼Œæ‰€ä»¥å¼•å…¥çš„ã€‚</li>
</ul>
<h4 id="scp"><a class="header-anchor" href="#scp"></a>SCP</h4>
<h3 id="nssf"><a class="header-anchor" href="#nssf"></a>NSSF</h3>
<ul>
<li><code>NSSF</code>çš„æ•°æ®åˆ†ä¸º<code>static</code>å’Œ<code>synamic</code>çš„æ•°æ®ã€‚å‰è€…å­˜åœ¨<code>UDM</code>é‡Œé¢ï¼Œåè€…åœ¨<code>NSSF</code>é‡Œé¢ã€‚</li>
<li><code>UE</code>è¿å…¥çš„æ—¶å€™ä¼šç”³è¯·ä½¿ç”¨æŸç§<code>slice</code>ï¼Œç„¶åç½‘ç»œä¼šè¿”å›è®¸å¯ï¼Œå­˜å‚¨çš„æ—¶å€™å¯ä»¥å­˜åœ¨<code>UDM</code>é‡Œé¢</li>
<li>åˆ‡ç‰‡åˆ†ä¸ºæ¥å…¥ç½‘ï¼Œ<code>RAN</code>å’Œæ ¸å¿ƒç½‘ï¼Œæ¥å…¥ç½‘æ˜¯é¢‘æ®µç­‰çš„åˆ‡ç‰‡ï¼Œç›®å‰æ²¡æœ‰åˆé€‚çš„solutionï¼Œè€Œæ ¸å¿ƒç½‘çš„åˆ‡ç‰‡å®é™…ä¸Šå°±æ˜¯æ‹‰ä¸€å¥—å°å‹çš„æ ¸å¿ƒç½‘èµ·æ¥ï¼Œè™šæ‹Ÿçš„ï¼Œé‡Œé¢å¯èƒ½<code>AMF</code>æ˜¯ç‹¬ç«‹çš„ï¼Œè€Œ<code>PCF</code>å°±æ˜¯å…±ç”¨çš„ã€‚</li>
</ul>
<h3 id="pcf-policy-control-function"><a class="header-anchor" href="#pcf-policy-control-function"></a>PCF -  Policy Control Function</h3>
<ul>
<li><code>PCF</code>å…¶å®å°±æ˜¯<code>4G</code>é‡Œé¢çš„<code>PCRF</code>ã€‚éƒ½æ˜¯åš<code>policy control</code>çš„</li>
<li><code>PCF</code>å¯ä»¥æ”¯æŒ<code>AMF</code>çš„<code>policy control</code>å’Œç½‘ç»œåˆ‡ç‰‡çš„<code>policy control</code></li>
<li><code>PCF</code>ç†è§£<code>UE</code>çº§åˆ«çš„ï¼Œå°±æ˜¯è¿™ä¸ª<code>UE</code>å¯ä»¥ä½¿ç”¨å“ªäº›<code>AMF</code>å’Œ<code>NSSF</code>ã€‚</li>
</ul>
<h2 id="5gåŸºç«™å’Œæ¥å…¥ç½‘çš„æ¼”è¿›"><a class="header-anchor" href="#5gåŸºç«™å’Œæ¥å…¥ç½‘çš„æ¼”è¿›"></a>5GåŸºç«™å’Œæ¥å…¥ç½‘çš„æ¼”è¿›</h2>
<p>ç”±äºå·¥ä½œç¼˜æ•…ï¼Œæ¥è§¦åˆ°çš„åŸºæœ¬æ˜¯æ ¸å¿ƒç½‘ï¼Œè¯è¯´åˆšåˆšå…¥è¡Œçš„æ—¶å€™ï¼Œæˆ‘æ˜¯åšæ¥å…¥ç½‘çš„æ¥ç€ã€‚<br>
ä½†æ˜¯å…¶å®ï¼Œ5Gè™½ç„¶æ˜¯æ ¸å¿ƒç½‘å˜åŒ–æœ€å¤§ï¼Œæ¥å…¥ç½‘ä¹Ÿæ˜¯æœ‰æ”¹å˜çš„</p>
<h3 id="å‚è€ƒé“¾æ¥-v2"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥-v2"></a>å‚è€ƒé“¾æ¥</h3>
<ul>
<li><a href="https://blog.csdn.net/ityouknow/article/details/81351317" target="_blank" rel="noopener">ç¬¬ä¸€æ¬¡æœ‰äººæŠŠ5Gè®²çš„è¿™ä¹ˆç®€å•æ˜äº†</a></li>
<li><a href="https://blog.csdn.xn--ne5Gt-vq5hmb652jn0tuwkpp6bfuycjqfvo0b/cf2SudS8x8F0v/article/details/78778384" target="_blank" rel="noopener">è¯¦è§£5Gçš„å…­å¤§å…³é”®æŠ€æœ¯</a></li>
</ul>
<h3 id="5gçš„æ”¹å˜"><a class="header-anchor" href="#5gçš„æ”¹å˜"></a>5Gçš„æ”¹å˜</h3>
<ul>
<li>é«˜é¢‘æ®µä¼ è¾“ï¼šé¢‘ç‡è¶Šé«˜ï¼Œèƒ½ä½¿ç”¨çš„é¢‘ç‡èµ„æºè¶Šä¸°å¯Œã€‚é¢‘ç‡èµ„æºè¶Šä¸°å¯Œï¼Œèƒ½å®ç°çš„ä¼ è¾“é€Ÿç‡å°±è¶Šé«˜ã€‚</li>
<li>å¾®åŸºç«™ï¼šè¿™ä¸ªè€æ—©å°±æœ‰äº†ã€‚å—¯ï¼ŒåŸºç«™è¶Šå°è¶Šå¥½ï¼Œè¦†ç›–å¥½ï¼Œè€Œä¸”èƒ½æä¸€å¤§å †ã€‚é«˜é¢‘æ®µä¼ è¾“ï¼Œè·ç¦»çŸ­ï¼Œæ­£å¥½ç”¨ä¸€å¤§å †å°åŸºç«™</li>
<li>ï¼­assive MIMOï¼ˆå¤§è§„æ¨¡å¤šå¤©çº¿æŠ€æœ¯ï¼‰</li>
<li>D2Dï¼š è¿™ä¸ªæŠ€æœ¯è¿˜æ˜¯ä¸é”™çš„ï¼Œå°±æ˜¯è¯´å¦‚æœé å¾—è¿‘ï¼Œæ‰‹æœºä¹‹é—´ç›´æ¥è¿›è¡Œè¿æ¥ï¼Œä¸éœ€è¦èµ°åŸºç«™äº†ã€‚ä½†æ˜¯åé¢æŠ€æœ¯å¦‚ä½•æ”¯æŒçš„ï¼Œå¹¶æ²¡æœ‰æåˆ°</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/hexo_blog/2019/08/16/OAuth2-0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/hexo_blog/2019/08/16/OAuth2-0/" itemprop="url">OAuth2.0</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-08-16T10:22:26+08:00">
                2019-08-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/security/" itemprop="url" rel="index">
                    <span itemprop="name">security</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>è¿™ä¸ªOauthå§ï¼Œæˆ‘æ„Ÿè§‰æˆ‘å‡ å¹´å‰å°±å¬åˆ°äº†ï¼Œå¯æƒœè¿˜æ˜¯æ²¡å¼„æ˜ç™½ã€‚å¿…é¡»æ‰¿è®¤é‚£äº›ä¼ æ¥ä¼ å»å•Šï¼Œå®¹æ˜“ææ··æ·†å’Œå¿˜ã€‚<br>
å—¯ï¼Œå†™å®Œäº†ä¹Ÿè¿˜æ˜¯æœ‰åŠæ‡‚ä¸æ‡‚çš„æ„Ÿè§‰ï¼Œä¸è¿‡å¥½æ­¹æ˜¯ä¸ªåŠæ‡‚äº† ğŸ˜‚</p>
<h3 id="å‚è€ƒé“¾æ¥"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h3>
<ul>
<li><a href="https://coolshell.cn/articles/19395.html" target="_blank" rel="noopener">HTTP API è®¤è¯æˆæƒæœ¯</a>ï¼šæ¥è‡ªé…·å£³ï¼Œå†™å¾—å¾ˆæ¸…æ¥šï¼Œä¸€æ­¥ä¸€æ­¥ã€‚æ„Ÿè§‰çœ‹è¿™ç¯‡å°±èƒ½äº†è§£å‰ä¸–ä»Šç”Ÿäº†ã€‚æŒºå¥½ã€‚<br>
æ‰€ä»¥è¿™ç¯‡åšå®¢å°±æ˜¯ä»¥é…·å£³è¿™ç¯‡ä¸ºåŸºç¡€æ¥å­¦ä¹ çš„</li>
</ul>
<h3 id="http-basic"><a class="header-anchor" href="#http-basic"></a>HTTP Basic</h3>
<ul>
<li>ä¸Šè¿°å‚è€ƒé“¾æ¥é‡Œé¢è¯´å¾—å¾ˆæ¸…æ¥šã€‚å…¶å®å°±æ˜¯<code>user:password</code>ç”¨<code>Base64</code>ç¼–ç åè®®è¿›è¡Œç¼–ç ï¼Œç„¶åä¼ è¾“</li>
<li>ä½†æ˜¯å¯ä»¥çœ‹åˆ°è¿™é‡Œä»…ä»…æ˜¯åŠ å¯†åè®®ï¼Œæ‰€ä»¥é€šå¸¸ä¼šå’ŒHTTPSé…åˆèµ·æ¥ï¼Œç”¨<code>TLS/SSL</code>çš„å®‰å…¨åŠ å¯†æ–¹å¼æ¥ä¼ è¾“</li>
<li>å°±æ˜¯å°†ç¼–ç åçš„å­—ç¬¦æ”¾åœ¨HTTPåè®®çš„<code>Authenticate: Basic</code>é‡Œé¢ã€‚</li>
<li>éœ€è¦æ³¨æ„çš„ç‚¹æ˜¯ï¼š
<ul>
<li>ç¼–ç åè®®å’ŒåŠ å¯†åè®®ä¸ä¸€æ ·, <code>Base64</code>å°±æ˜¯ä¸ªç¼–ç ï¼Œ<code>RSA/AES</code>æ‰æ˜¯åŠ å¯†ï¼Œ<code>MD5</code>å°±åªæ˜¯å–æ‘˜è¦çš„</li>
<li><code>HTTP Basic</code>æ–¹å¼å°†å¯†ç å’Œç”¨æˆ·åæ”¾åœ¨å…¬ç½‘ä¸Šé¢ä¼ è¾“ï¼Œå­˜åœ¨é£é™©</li>
</ul>
</li>
</ul>
<h3 id="digital-access"><a class="header-anchor" href="#digital-access"></a>Digital Access</h3>
<ul>
<li>å‚è€ƒé“¾æ¥ï¼š
<ul>
<li><a href="https://www.cnblogs.com/huey/p/5490759.html" target="_blank" rel="noopener">HTTP - æ‘˜è¦è®¤è¯</a></li>
<li><a href="https://www.cnblogs.com/xzwblog/p/6834663.html" target="_blank" rel="noopener">HTTPè®¤è¯ä¸httpsç®€ä»‹</a></li>
<li><a href="https://en.wikipedia.org/wiki/Digest_access_authentication" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘HTTPæ‘˜è¦è®¤è¯</a></li>
</ul>
</li>
<li>æ‘˜è¦è®¤è¯ä¸åŸºç¡€è®¤è¯æ˜¯å…¼å®¹çš„ï¼Œä½†æ˜¯è¿›è¡Œäº†å¦‚ä¸‹ä¿®æ”¹ï¼š
<ul>
<li>æ°¸è¿œä¸ä¼šä»¥æ˜æ–‡æ–¹å¼åœ¨ç½‘ç»œä¸Šå‘é€å¯†ç ã€‚</li>
<li>å¯ä»¥é˜²æ­¢æ¶æ„ç”¨æˆ·æ•è·å¹¶é‡æ”¾è®¤è¯çš„æ¡æ‰‹è¿‡ç¨‹ã€‚</li>
<li>å¯ä»¥æœ‰é€‰æ‹©åœ°é˜²æ­¢å¯¹æŠ¥æ–‡å†…å®¹çš„ç¯¡æ”¹ã€‚</li>
<li>é˜²èŒƒå…¶ä»–å‡ ç§å¸¸è§çš„æ”»å‡»æ–¹å¼ã€‚</li>
</ul>
</li>
<li>è¿˜æ˜¯ç»´åŸºç™¾ç§‘æ¯”è¾ƒæ¸…æ¥šã€‚æ‘˜è¦è®¤è¯ä¼šä½¿ç”¨MD5çš„æ–¹å¼æ¥åŠ å¯†ç”¨æˆ·åå’Œå¯†ç ã€‚ç›¸å¯¹æ¥è¯´ï¼ŒåŸºç¡€è®¤è¯ä»…ä»…æ˜¯ä½¿ç”¨äº†ç¼–ç æ–¹å¼ï¼Œè€Œä¸æ˜¯åŠ å¯†æ–¹å¼ã€‚</li>
<li>åŒæ—¶ï¼Œæ‘˜è¦è®¤è¯ä½¿ç”¨äº†<code>nonce values</code>æ¥é˜»æ­¢<code>replay attacks</code><strong><em>ä¸çŸ¥é“ç¿»è¯‘æˆä»€ä¹ˆï¼Œé‡æ¼”æ”»å‡»ï¼Ÿ</em></strong></li>
<li>ä½†æ˜¯æ•´ä¸ªè¿‡ç¨‹å…¶å®å…³é”®æ˜¯ç”¨æˆ·çš„passwordï¼Œè¿™ä¸ªpasswordå¦‚æœä¸å¤Ÿå¤æ‚ï¼Œå…¶å®æ˜¯å¯ä»¥è¢«æš´åŠ›ç ´è§£çš„ï¼Œè€Œä¸”ï¼Œæ•´ä¸ªè¿‡ç¨‹æ˜¯éå¸¸å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ã€‚ <strong><em>è¿™ç‚¹æˆ‘è¿˜æ²¡ç†è§£</em></strong></li>
</ul>
<p><img src="https://raw.githubusercontent.com/sallyslove/Pictures/master/Security/OAuth2.0/http_digital_access_nonce.png" alt><br>
<strong>nonce è¯´æ˜å›¾</strong></p>
<ul>
<li>ä»¥ä¸‹æ˜¯è‡ªå·±ç”»çš„ç®€æ˜çš„æµç¨‹å›¾ï¼Œè¿˜æ˜¯æ¯”è¾ƒæ¸…æ¥šçš„ã€‚
<ul>
<li>[]ä»£è¡¨é‡Œé¢çš„æ•°å€¼</li>
<li><code>nonce</code>æ˜¯æœåŠ¡å™¨ç«¯ç”Ÿæˆçš„éšæœºæ•°ã€‚ <code>cnonce</code>æ˜¯å®¢æˆ·ç«¯ç”Ÿæˆçš„</li>
<li>å¦‚æœå¤šäº†<code>auth</code>ï¼Œé‚£ä¹ˆè¿˜è¦å‘é€<code>HA2</code>ï¼Œé‡Œé¢çš„<code>method</code>å°±æ˜¯æŒ‡<code>GET</code>æ“ä½œï¼Œ <code>entity body</code>æŒ‡çš„æ˜¯<code>HTTP request</code>çš„æ•°æ®</li>
<li><code>opaque</code>çœ‹èµ·æ¥ä¹Ÿæ˜¯ä¸€ä¸ªéšæœºæ•°ï¼Œä¸çŸ¥é“æ˜¯å•¥ã€‚</li>
</ul>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/sallyslove/Pictures/master/Security/OAuth2.0/http_digital_access.png.png" alt></p>
<h3 id="jwt-json-web-tokens"><a class="header-anchor" href="#jwt-json-web-tokens"></a>JWT â€“ JSON Web Tokens</h3>
<p>æœ¬æ¥æƒ³è·³è¿‡å…¶ä¸­å‡ ä¸ªï¼Œç›´æ¥å­¦ä¹ 2.0çš„ï¼Œè²Œä¼¼ä¸å¯è¡Œã€‚å­¦ä¹ æ—¶å€™è¿˜æ˜¯ä¸€æ­¥æ­¥æ¥ï¼Œä¸ç„¶å°±çœ‹ä¸æ˜ç™½äº†ã€‚<br>
æŸ¥åšå®¢çš„æ—¶å€™ï¼Œåˆçœ‹åˆ°é˜®å¤§ç¥çš„åšå®¢äº†ã€‚ä¸çŸ¥é“æœ‰æ²¡æœ‰äººèƒ½çœ‹åˆ°æˆ‘çš„åšå®¢ï¼ŒğŸ˜‡<br>
è¯è¯´çœ‹åˆ°è¯„è®ºé‡Œæœ‰äººæŠ¨å‡»é˜®å¤§ç¥è¯´æ²¡è´¨é‡çš„ï¼Œå—¯ï¼Œæˆ‘çš„è¿˜æ˜¯ç•™ç€è‡ªå·±çœ‹å§ã€‚ğŸ˜‚</p>
<h4 id="å‚è€ƒé“¾æ¥-v2"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥-v2"></a>å‚è€ƒé“¾æ¥</h4>
<ul>
<li><a href="https://www.jianshu.com/p/576dbf44b2ae" target="_blank" rel="noopener">ä»€ä¹ˆæ˜¯ JWT â€“ JSON WEB TOKEN</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html" target="_blank" rel="noopener">JWT â€“ JSON Web Tokens</a>: é˜®å¤§ç¥çš„æ–‡ç« ï¼Œè¿˜æ¯”è¾ƒæ–°ï¼Œå»å¹´çš„ã€‚å˜›ï¼Œè¿™æŠ€æœ¯ä¸æ–°ã€‚è¯è¯´é…·å£³çš„æ˜¯ä»Šå¹´çš„ã€‚</li>
<li><a href="https://jwt.io/introduction/" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ï¼š ç¬¬ä¸€ç¯‡åšå®¢åªæ˜¯ç¿»è¯‘ï¼Œæ€»çš„æ¥è¯´ï¼ŒJWTä¸æ˜¯å¾ˆå¤æ‚çš„ï¼Œçœ‹äº†æ„Ÿè§‰è›®ç®€å•ã€‚æ¯”æ‘˜è¦è¿˜ç®€å•ä¸€ç‚¹ã€‚</li>
</ul>
<h4 id="session-è®¤è¯æ–¹å¼"><a class="header-anchor" href="#session-è®¤è¯æ–¹å¼"></a>session è®¤è¯æ–¹å¼</h4>
<ul>
<li>
<p>åŸºäº<code>session</code>çš„è®¤è¯æ–¹å¼ï¼Œå…¶å®å¾ˆå¥½ç†è§£çš„ã€‚è·Ÿæˆ‘ä»¬äº§å“é‡Œé¢çš„æŸç§åè®®ç±»ä¼¼ï¼Œç¬¬ä¸€æ¬¡ç™»é™†æ—¶å€™ï¼Œå®¢æˆ·ç«¯é€šè¿‡ç”¨æˆ·åå’Œå¯†ç è®¿é—®ï¼Œç„¶åæœåŠ¡å™¨ç«¯è¿”å›ä¸€ä¸ª<code>sessionId</code>ã€‚</p>
</li>
<li>
<p>åç»­è®¿é—®çš„æ—¶å€™ï¼Œå°±ç”¨è¿™ä¸ª<code>sessionId</code>æ¥è®¿é—®ï¼ŒæœåŠ¡å™¨ç«¯å†é€šè¿‡è¿™ä¸ª<code>sessionId</code>æ¥æŸ¥è¯¢åˆ°è¿™ä¸ªç”¨æˆ·çš„æ‰€æœ‰ä¿¡æ¯ã€‚åŒ…æ‹¬ç”¨æˆ·åå•Šï¼Œå¯†ç å•Šï¼Œè®¿é—®æƒé™å•Šï¼Œç™»å½•æ—¶é•¿å•Šï¼Œæˆ‘çŒœçš„ï¼Œåº”è¯¥æœ‰è¿™äº›ä¿¡æ¯ã€‚</p>
</li>
<li>
<p>äº’è”ç½‘æ—¶ä»£ï¼Œè¿™ä¸ª<code>sessionId</code>ä¼šè¢«æµè§ˆå™¨ç«¯å†™å…¥åˆ°è‡ªå·±çš„<code>cookie</code>é‡Œé¢ã€‚<strong>ç°åœ¨è¿˜æœ‰å—ï¼Œæˆ‘å’‹æ²¡çœ‹åˆ°<code>sessionId</code>å­—æ ·</strong></p>
</li>
<li>
<p>è¿™ç§æ–¹å¼çš„é—®é¢˜çœ‹èµ·æ¥æœ‰ä¸¤ä¸ªæ¯”è¾ƒä¸å¥½(ç…ç€è¿™ä¹ˆç®€å•ï¼Œè‚¯å®šä¸è¡Œå•Šï¼Œæˆ‘ä»Šå¤©è„‘å†…å°å‰§åœºæ¯”è¾ƒå¤šå•Š)ï¼š</p>
<ul>
<li>ä¸€ä¸ªå®‰å…¨é—®é¢˜ï¼ŒåŸºäº<code>cookie</code>æ¥åšçš„ï¼Œæƒ³ä¹ŸçŸ¥é“ä¸å®‰å…¨ï¼Œ<code>cookie</code>è¢«è¯»å–ä¹‹åå°±ä¸æˆäº†ã€‚</li>
<li>æ‰©å±•æ€§ä¸å¥½ï¼Œè¿™ä¸ªå°±æ¯”è¾ƒå¤æ‚ï¼Œæœ‰å„ç§æ‰©å±•æ€§ï¼Œæ¯”å¦‚<code>sessionId</code>å­˜åœ¨æœåŠ¡å™¨ç«¯çš„å†…å­˜é‡Œé¢ï¼Œé‚£ä¹ˆå†…å­˜å®¢æˆ·ç«¯æ•°é‡æ¶¨äº†ï¼ŒæœåŠ¡å™¨å°±æ’‘ä¸ä½äº†ï¼›å†æ¯”å¦‚ï¼ŒåŒä¸€ä¸ªå®¢æˆ·ï¼Œå„ç§ç”¨å¾®ä¿¡ç™»å½•ï¼Œè¿™ä¸ª<code>session</code>æ²¡æ³•åœ¨ä¸åŒæœåŠ¡å™¨ä¹‹é—´è¿›è¡Œå…±äº«ï¼Œé™¤éå†å¼•å…¥ä¸­è½¬ï¼Œä½†æ˜¯ä¸­è½¬ä¸€æŒ‚å°±å®Œè›‹ã€‚</li>
</ul>
</li>
<li>
<p>ç„¶åå¯¹äºä¸Šè¿°çš„é—®é¢˜ï¼Œå°±æƒ³äº†ä¸€ä¸ªåŠæ³•æ¥è§£å†³ï¼Œå°±æ˜¯æœåŠ¡å™¨ç«¯ä¸å†å­˜å‚¨å®¢æˆ·ä¿¡æ¯ï¼Œè€Œæ˜¯æ‰€æœ‰ä¿¡æ¯éƒ½æ”¾åœ¨å®¢æˆ·ç«¯ï¼ŒæœåŠ¡å™¨ç«¯åªæ˜¯åŠ ä¸€ä¸ªç­¾åã€‚å®¢æˆ·ç«¯åé¢æ¯æ¬¡è®¿é—®éƒ½å¸¦ä¸Šè‡ªå·±æ‰€æœ‰ä¿¡æ¯ã€‚</p>
<ul>
<li>è¯è¯´ï¼Œè¿™ä¸æ˜¯æ¯”å¸¦<code>sessionId</code>è¦å¸¦çš„ä¸œè¥¿å¤šå˜›ã€‚æ¯æ¬¡éƒ½å¸¦ï¼Œå¤šéº»çƒ¦å‘ã€‚å¥½å¤„æ˜¯æœåŠ¡å™¨å°±ä¸éœ€è¦å­˜å‚¨ä¿¡æ¯ï¼Œæ— çŠ¶æ€äº†ã€‚</li>
<li>è¿™ä¸ªç­¾åæˆ‘ç†è§£å°±æ˜¯å—¯ï¼Œè¿™ä¸ªå®¢æˆ·æˆ‘è€äººå®¶è®¤è¯è¿‡äº†è¿™æ ·çš„ã€‚é—®é¢˜æ˜¯è®¤è¯è¿‡äº†å°±ä¸è®¤è¯äº†ï¼Ÿåº”è¯¥æ˜¯ä¸è®¤è¯äº†ã€‚<strong><em>é—®é¢˜åœ¨äºè¿™ä¸ªç­¾åæ€ä¹ˆåšçš„ï¼ŒæœåŠ¡å™¨ç«¯å¦‚ä½•çŸ¥é“è¿™ä¸ªç”¨æˆ·æ˜¯è®¤è¯è¿‡çš„ï¼Œåˆæ³•çš„å‘¢ï¼Ÿæ¯”å¦‚æˆ‘å¾®ä¿¡ç™»å½•äº†ä¸€ä¸ªï¼Œæˆ‘å†ç™»å½•å¦ä¸€ä¸ªæœåŠ¡å™¨ï¼Œç¬¬äºŒä¸ªæœåŠ¡å™¨æ€ä¹ˆä¿¡ä»»æˆ‘å‘¢ã€‚æˆ‘æƒ³è¿™é‡Œç†è§£æœ‰ç‚¹é—®é¢˜ï¼Œä¸åŒçš„æœåŠ¡å™¨ï¼Œåº”è¯¥æ˜¯ç›¸åŒçš„åº”ç”¨å’ŒåŠŸèƒ½ã€‚æ‰€ä»¥è½¯ä»¶ä¸Šæ˜¯ä¸€å¥—ã€‚</em></strong></li>
</ul>
</li>
</ul>
<h4 id="jwt-header"><a class="header-anchor" href="#jwt-header"></a>JWT Header</h4>
<ul>
<li>JWTå…¶å®å°±ä¸‰ä¸ªéƒ¨åˆ†ï¼Œheaderï¼Œpayloadå’Œç­¾åï¼Œåœ¨åŒä¸€è¡Œã€‚å¦‚ä¸‹ï¼š</li>
</ul>
<pre><code>Header.Payload.Signature
</code></pre>
<ul>
<li>Headeræ˜¯JSONæ ¼å¼ï¼Œé‡Œé¢æœ‰ç®—æ³•å’Œä»¤ç‰Œ(token)ç±»å‹ï¼Œ<strong><em>ç¬¬ä¸€æ¬¡çŸ¥é“<code>token</code>åŸæ¥ä¸­æ–‡ç¿»è¯‘æˆä»¤ç‰Œï¼Œè¿™æ˜¯ä¸ªå¤šä¹ˆç†Ÿæ‚‰çš„è¯ç»„å•Šï¼ŒNå¹´å‰å­¦ç½‘ç»œæ—¶å€™æ²¡å°‘å¬åˆ°ã€‚ä»¤ç‰Œä»¤ç‰Œä»¤ç‰Œçš„ï¼ŒåŸæ¥æ˜¯tokenï¼Œç¬é—´æ„Ÿè§‰å¾ˆå¤šä¸œè¥¿æ›´æ˜ç™½äº†ï¼Œæœç„¶çœ‹å¤§ç¥çš„åšå®¢æœ‰æ— é™å¥½å¤„</em></strong></li>
<li>ä¸‹é¢æ˜¯é˜®å¤§ç¥åšå®¢é‡Œé¢çš„ä¾‹å­ï¼Œé»˜è®¤æ˜¯<code>HMAC SHA256</code>ï¼ˆå†™æˆ HS256ï¼‰ã€‚ä»¤ç‰Œç±»å‹å°±æ˜¯<code>JWT</code>ã€‚è¿™æ ·æœåŠ¡å™¨å¯ä»¥çŸ¥é“è¿™æ¬¡å®¢æˆ·ç«¯å‘æ¥çš„ä¿¡æ¯æ˜¯æ¥å—è¿‡<code>JWT</code>è®¤è¯çš„ã€‚</li>
<li>è¯è¯´è®¤è¯æ–¹å¼å…¶å®ä¹Ÿæ˜¯ä¸€ç§åè®®å•Šã€‚ç‰¹æ®Šçš„åè®®ã€‚åªæ˜¯ä¹‹å‰çš„<code>HTTP Basic</code>å’Œ<code>Digital Access</code>æ—¶å€™ä¸çŸ¥é“æœåŠ¡å™¨ç«¯æ˜¯å¦å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ã€‚å‰è€…æˆ‘æƒ³åº”è¯¥æ˜¯å­˜å‚¨çš„ï¼Œåè€…åº”è¯¥ä¹Ÿæ˜¯å­˜å‚¨çš„ï¼Œå¦åˆ™æ— æ³•è¿›è¡Œæ ¡éªŒã€‚</li>
</ul>
<pre><code>{
  &quot;alg&quot;: &quot;HS256&quot;,
  &quot;typ&quot;: &quot;JWT&quot;
}
</code></pre>
<ul>
<li><em>å°†ä¸Šé¢çš„JSONå¯¹è±¡ä½¿ç”¨Base64URLç®—æ³•è½¬æˆå­—ç¬¦ä¸²</em> é˜®å¤§ç¥çš„å®åœ¨æ¸…æ¥šï¼Œæˆ‘æ„Ÿè§‰æˆ‘åœ¨åŠ è¯»ä¹¦ç¬”è®°ã€‚</li>
<li><strong><em>ä¹‹å‰è¯´è¿‡Base64åªæ˜¯ç¼–ç ç®—æ³•ï¼Œç®—ä¸å¾—åŠ å¯†ç®—æ³•ï¼Œæ‰€ä»¥å…¶å®JWTçš„è¿™éƒ¨åˆ†å¹¶ä¸ååˆ†å®‰å…¨</em></strong></li>
</ul>
<h4 id="jwt-payload"><a class="header-anchor" href="#jwt-payload"></a>JWT payload</h4>
<ul>
<li>payloadçš„è¯ï¼Œå®˜æ–¹å®šäº†å‡ ä¸ªå­—æ®µã€‚å‡ ç¯‡åšå®¢é‡Œé¢è²Œä¼¼æ²¡æœ‰è¯´åˆ°å¦‚ä½•å®ç°çš„ã€‚</li>
</ul>
<pre><code>iss (issuer)ï¼šç­¾å‘äºº
exp (expiration time)ï¼šè¿‡æœŸæ—¶é—´
sub (subject)ï¼šä¸»é¢˜
aud (audience)ï¼šå—ä¼—
nbf (Not Before)ï¼šç”Ÿæ•ˆæ—¶é—´
iat (Issued At)ï¼šç­¾å‘æ—¶é—´
jti (JWT ID)ï¼šç¼–å·
</code></pre>
<ul>
<li>ä¹Ÿå¯ä»¥å®šä¹‰è‡ªå·±çš„å­—æ®µã€‚åŒæ ·æ˜¯<code>Base64</code>ç¼–ç ï¼Œæ‰€ä»¥ä¸æ˜¯åŠ å¯†çš„ã€‚</li>
</ul>
<h4 id="jwt-signiture"><a class="header-anchor" href="#jwt-signiture"></a>JWT Signiture</h4>
<ul>
<li>
<p>ç­¾åæ ¼å¼å¦‚ä¸‹ï¼š</p>
<pre><code>HMACSHA256(
   base64UrlEncode(header) + &quot;.&quot; + base64UrlEncode(payload),secret)
</code></pre>
</li>
<li>
<p>æ„Ÿè§‰å®‰å…¨æ€§å®Œå…¨å°±åœ¨è¿™ä¸ªæœåŠ¡å™¨ç«¯çš„ç§˜é’¥ï¼Œ<code>secret</code>å•Šã€‚ç®—æ³•å°±æ˜¯headeré‡Œé¢æŒ‡å®šçš„åŠ å¯†ç®—æ³•ã€‚</p>
</li>
</ul>
<h4 id="æµç¨‹å›¾"><a class="header-anchor" href="#æµç¨‹å›¾"></a>æµç¨‹å›¾</h4>
<p><img src="https://upload-images.jianshu.io/upload_images/1821058-2e28fe6c997a60c9.png?imageMogr2/auto-orient/" alt></p>
<p><em>æ¥è‡ªä¸Šé¢çš„å‚è€ƒé“¾æ¥1é‡Œé¢</em></p>
<h4 id="æ‰©å±•å’Œå°ç»“"><a class="header-anchor" href="#æ‰©å±•å’Œå°ç»“"></a>æ‰©å±•å’Œå°ç»“</h4>
<h5 id="æ‰©å±•"><a class="header-anchor" href="#æ‰©å±•"></a>æ‰©å±•</h5>
<ul>
<li>åœ¨é…·å£³æ–‡ç« é‡Œé¢æåˆ°äº†éªŒè¯æœåŠ¡å™¨ã€‚é€šå¸¸å®ç°ä¸­ï¼Œæˆ‘æƒ³æœåŠ¡å™¨åº”è¯¥ä¹Ÿä¼šå°†ä¿¡æ¯å‘é€åˆ°éªŒè¯æœåŠ¡å™¨æ¥è¿›è¡Œ<code>secret</code>çš„åŠ å¯†å’Œç­¾åçš„è§£å¯†</li>
<li>åŒæ—¶è¿˜æåˆ°äº†ä½¿ç”¨<code>RSA</code>åŠ å¯†ç®—æ³•æ¥æ›¿ä»£<code>HMAC-SHA256</code>ç®—æ³•ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ã€‚</li>
</ul>
<h5 id="å°ç»“"><a class="header-anchor" href="#å°ç»“"></a>å°ç»“</h5>
<ul>
<li>çœ‹èµ·æ¥JWTè¿˜æ˜¯æ¯”è¾ƒæµè¡Œçš„æŠ€æœ¯ï¼Œè®¨è®ºå¾ˆå¤šï¼Œä»¥ä¸‹ï¼š
<ul>
<li><em>JWT çš„æœ€å¤§ç¼ºç‚¹æ˜¯ï¼Œç”±äºæœåŠ¡å™¨ä¸ä¿å­˜ session çŠ¶æ€ï¼Œå› æ­¤æ— æ³•åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­åºŸæ­¢æŸä¸ª tokenï¼Œæˆ–è€…æ›´æ”¹ token çš„æƒé™ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦ JWT ç­¾å‘äº†ï¼Œåœ¨åˆ°æœŸä¹‹å‰å°±ä¼šå§‹ç»ˆæœ‰æ•ˆï¼Œé™¤éæœåŠ¡å™¨éƒ¨ç½²é¢å¤–çš„é€»è¾‘ã€‚</em> çœ‹è¯„è®ºè§£é‡Šï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘æ‰‹æœºç™»å½•äº†æˆ‘çš„å¾®ä¿¡ï¼Œ ipadä¹Ÿç™»å½•äº†ã€‚é‚£ä¹ˆè¿™ä¸¤ä¸ªæ˜¯å½¼æ­¤ç‹¬ç«‹çš„ï¼Œipadç™»å½•æ²¡æ³•æŠŠæ‰‹æœºç™»å½•çš„è¸¢å‡ºæ¥ã€‚</li>
<li>JWTä¸åº”è¯¥ä½¿ç”¨ HTTP åè®®æ˜ç ä¼ è¾“ï¼Œè¦ä½¿ç”¨ HTTPS åè®®ä¼ è¾“</li>
</ul>
</li>
</ul>
<h3 id="oauth2-0"><a class="header-anchor" href="#oauth2-0"></a>OAuth2.0</h3>
<h4 id="å‚è€ƒé“¾æ¥-v3"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥-v3"></a>å‚è€ƒé“¾æ¥</h4>
<ul>
<li><a href="http://www.ruanyifeng.com/blog/2019/04/oauth_design.html" target="_blank" rel="noopener">OAuth 2.0 çš„ä¸€ä¸ªç®€å•è§£é‡Š</a>: é˜®å¤§ç¥çš„åšå®¢ï¼Œç®€å•æ¸…æ™°æ˜äº†ï¼Œç¡®å®å¤§æœ‰è£¨ç›Šï¼Œè¿™ä¸ªå°åŒºå¿«é€’å‘˜å•¥çš„ï¼Œæ„Ÿè§‰æˆ‘å¦ˆéƒ½èƒ½æ˜ç™½</li>
<li><a href="http://www.ruanyifeng.com/blog/2019/04/oauth-grant-types.html" target="_blank" rel="noopener">OAuth 2.0 çš„å››ç§æ–¹å¼</a>é˜®å¤§ç¥çš„åšå®¢ï¼Œç³»åˆ—ä½œå“</li>
</ul>
<h4 id="ç®€ä»‹"><a class="header-anchor" href="#ç®€ä»‹"></a>ç®€ä»‹</h4>
<ul>
<li>
<p><code>OAuth 2.0</code>ä¾èµ–äº<code>TLS/SSL</code>çš„é“¾è·¯åŠ å¯†æŠ€æœ¯<code>HTTPS</code>ã€‚</p>
</li>
<li>
<p>å®Œå…¨æ”¾å¼ƒäº†ç­¾åçš„æ–¹å¼ï¼Œè®¤è¯æœåŠ¡å™¨å†ä¹Ÿä¸è¿”å›ä»€ä¹ˆ<code>token</code>,<code>secret</code>çš„å¯†é’¥äº†ã€‚</p>
</li>
<li>
<p><code>Auth 2.0</code>æ˜¯å®Œå…¨ä¸åŒäº1.0 çš„ï¼Œä¹Ÿæ˜¯ä¸å…¼å®¹çš„.</p>
</li>
<li>
<p><code>Facebook</code>çš„<code>Graph API</code>åªæ”¯æŒ<code>OAuth 2.0</code>åè®®ï¼Œ<code>Google</code>å’Œ <code>Microsoft Azure</code>ä¹Ÿæ”¯æŒ<code>Auth 2.0</code>ï¼Œå›½å†…çš„å¾®ä¿¡å’Œæ”¯ä»˜å®ä¹Ÿæ”¯æŒä½¿ç”¨<code>OAuth 2.0</code>ã€‚</p>
</li>
<li>
<p><code>OAuth2.0</code>ä¸€å…±æœ‰4ä¸ªflowã€‚åœ¨é…·å£³ä¸Šé¢é˜è¿°äº†å…¶ä¸­ä¸»è¦çš„ä¸¤ä¸ªflowã€‚</p>
<pre><code>æˆæƒç ï¼ˆauthorization-codeï¼‰
éšè—å¼ï¼ˆimplicitï¼‰
å¯†ç å¼ï¼ˆpasswordï¼‰ï¼š
å®¢æˆ·ç«¯å‡­è¯ï¼ˆclient credentialsï¼‰
</code></pre>
</li>
<li>
<p><code>OAuth</code> å°±æ˜¯ä¸€ç§æˆæƒæœºåˆ¶ã€‚æ•°æ®çš„æ‰€æœ‰è€…å‘Šè¯‰ç³»ç»Ÿï¼ŒåŒæ„æˆæƒç¬¬ä¸‰æ–¹åº”ç”¨è¿›å…¥ç³»ç»Ÿï¼Œè·å–è¿™äº›æ•°æ®ã€‚ç³»ç»Ÿä»è€Œäº§ç”Ÿä¸€ä¸ªçŸ­æœŸçš„è¿›å…¥ä»¤ç‰Œï¼Œç”¨æ¥ä»£æ›¿å¯†ç ï¼Œä¾›ç¬¬ä¸‰æ–¹åº”ç”¨ä½¿ç”¨ã€‚</p>
<ul>
<li>æˆ‘ä»¬æœ‰<code>client</code>,<code>Authorization server</code>,<code>Resource owner</code>å’Œ<code>Resource server</code>ã€‚é‚£ä¹ˆï¼Œå¯¹ç…§èµ·æ¥ï¼Œ<code>client</code>æ˜¯ç¬¬ä¸‰æ–¹åº”ç”¨ï¼Œ<code>Authorization server</code>æ˜¯éªŒè¯æœåŠ¡å™¨ï¼Œ <code>Resource server</code>æ˜¯èµ„æºæœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯è¢«è®¿é—®çš„èµ„æºä¿å­˜çš„åœ°æ–¹ã€‚<code>Resource Owner</code>æ˜¯ç»ˆç«¯ç”¨æˆ·ã€‚</li>
<li>æ¯”å¦‚è¯´ï¼Œæˆ‘è®¿é—®å¾®ä¿¡ï¼Œå¾®ä¿¡è¦æ±‚ç™»å½•ï¼Œä¼šå°†æˆ‘çš„è¯·æ±‚è½¬åˆ°éªŒè¯æœåŠ¡å™¨ä¸Šé¢ï¼Œæˆ‘é€šè¿‡éªŒè¯ï¼Œé‚£ä¹ˆå¾®ä¿¡è¿™ä¸ªåº”ç”¨ä¼šä»èµ„æºæœåŠ¡å™¨ä¸Šé¢è·å–èµ„æºï¼Œæˆ‘ä½œä¸ºç»ˆç«¯ç”¨æˆ·å°±å¯ä»¥ä½¿ç”¨å¾®ä¿¡äº†ã€‚è¿™é‡Œæˆ‘å°±æ˜¯<code>Resource Owner</code>, å¾®ä¿¡æ˜¯<code>client</code>ã€‚</li>
</ul>
</li>
</ul>
<h4 id="oauth2-0-è¯¦è§£"><a class="header-anchor" href="#oauth2-0-è¯¦è§£"></a>OAuth2.0 è¯¦è§£</h4>
<h5 id="authorization-code"><a class="header-anchor" href="#authorization-code"></a>Authorization Code</h5>
<ul>
<li>æµç¨‹å¦‚ä¸‹ã€‚æ„Ÿè§‰æ²¡å•¥å¥½è¯´çš„ï¼Œæ•´ä¸ªæµç¨‹æŒºæ¸…æ¥šçš„ã€‚
<ul>
<li><em>ä¸ç®¡å“ªç§æµç¨‹ï¼Œ ç¬¬ä¸‰æ–¹åº”ç”¨ç”³è¯·ä»¤ç‰Œä¹‹å‰ï¼Œéƒ½å¿…é¡»å…ˆåˆ°ç³»ç»Ÿå¤‡æ¡ˆï¼Œè¯´æ˜è‡ªå·±çš„èº«ä»½ï¼Œç„¶åä¼šæ‹¿åˆ°ä¸¤ä¸ªèº«ä»½è¯†åˆ«ç ï¼šå®¢æˆ·ç«¯ IDï¼ˆclient IDï¼‰å’Œå®¢æˆ·ç«¯å¯†é’¥ï¼ˆclient secretï¼‰ã€‚åº”ç”¨è‡ªé˜®å¤§ç¥çš„åšå®¢</em></li>
<li><code>code</code>å°±æ˜¯ä»£è¡¨<code>authorization code</code>ã€‚</li>
<li><code>redirect_uri</code>æ„æ€æ˜¯æˆ‘è·³è½¬å›ç¬¬ä¸‰æ–¹åº”ç”¨çš„åœ°å€</li>
<li><code>scope</code>æ˜¯ç›¸å…³çš„æƒé™</li>
<li><code>state</code> æ˜¯ä¸€ä¸ªéšæœºçš„å­—ç¬¦ä¸²ï¼Œä¸»è¦ç”¨äºé˜²<code>CSRF</code>æ”»å‡»ã€‚<code>CSRF - Cross-site request forgery</code>æ”»å‡»ï¼Œä¸­æ–‡ç¿»è¯‘æ˜¯è·¨ç«™è¯·æ±‚ä¼ªé€ ã€‚</li>
<li><code>authorization server</code>è¿”å›<code>authorization code</code>æ—¶å€™ï¼Œå…¶å®æ˜¯å¸¦åœ¨<code>url</code>é‡Œé¢çš„ã€‚</li>
</ul>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/sallyslove/Pictures/master/Security/OAuth2.0/oauth2.0_authorization_code.png" alt="è‡ªå·±ç”»çš„æµç¨‹å›¾"></p>
<ul>
<li>
<p><code>authorization code</code>çš„æ ¼å¼å¦‚ä¸‹ã€‚é‡Œé¢çš„<code>state</code>å’Œç¬¬ä¸€æ­¥é‡Œé¢çš„ä¸€æ ·ã€‚</p>
<pre><code>  https://example-client.com/callback?
  code=Yzk5ZDczMzRlNDEwYlrEqdFSBzjqfTG
  &amp;state=xcoiv98CoolShell3kch
</code></pre>
</li>
<li>
<p><code>token</code>ä»¤ç‰Œçš„æ ·å¼å¦‚ä¸‹ï¼š</p>
</li>
</ul>
<ul>
<li>
<p><code>access_token</code>å°±æ˜¯è®¿é—®è¯·æ±‚ä»¤ç‰Œäº†</p>
</li>
<li>
<p><code>refresh_token</code>ç”¨äºåˆ·æ–°<code>access_token</code></p>
</li>
<li>
<p><code>id_token</code>æ˜¯<code>JWT</code>çš„<code>token</code>ï¼Œå…¶ä¸­ä¸€èˆ¬ä¼šåŒ…å«ç”¨æˆ·çš„<code>OpenID</code></p>
<pre><code>{
    &quot;access_token&quot;: &quot;iJKV1QiLCJhbGciOiJSUzI1NiI&quot;,
    &quot;refresh_token&quot;: &quot;1KaPlrEqdFSBzjqfTGAMxZGU&quot;,
    &quot;token_type&quot;: &quot;bearer&quot;,
    &quot;expires&quot;: 3600,
    &quot;id_token&quot;: &quot;eyJ0eXAiOiJKV1QiLCJhbGciO.eyJhdWQiOiIyZDRkM...&quot;
}
</code></pre>
</li>
</ul>
<h5 id="client-credential-flow"><a class="header-anchor" href="#client-credential-flow"></a>Client Credential Flow</h5>
<ul>
<li>æ„Ÿè§‰è¿™ä¸ªä¸éœ€è¦å¤šå†™äº†ã€‚å…¶å®å°±æ˜¯ä¸Šé¢çš„æµç¨‹ä¸­æ²¡æœ‰ç”¨æˆ·ï¼Œå°±æ˜¯æ²¡æœ‰<code>Resource Owner</code>ã€‚<code>client</code>ç›´æ¥æ‹¿è‡ªå·±çš„<code>clientId</code>å’Œ<code>client-secret</code>å»åšæ ¡éªŒå’Œæˆæƒäº†ã€‚</li>
</ul>
<h5 id="ä¸€äº›ç–‘é—®"><a class="header-anchor" href="#ä¸€äº›ç–‘é—®"></a>ä¸€äº›ç–‘é—®</h5>
<p>OAuth2.0æˆ‘è¿˜æ˜¯æœ‰äº›ç–‘é—®å•Šï¼š</p>
<ul>
<li>ä¸ºå•¥è¦åœ¨<code>token</code>é‡Œé¢å¸¦ä¸Š<code>id_token</code>å‘¢ï¼Œ è¿™ä¸æ˜¯æš´éœ²äº†å˜›</li>
<li>å¦‚ä½•ä½¿ç”¨<code>refresh_token</code>æ¥åˆ·æ–°<code>access_token</code>å‘¢ã€‚è™½ç„¶å¾ˆæ˜æ˜¾è¿™ä¸ªæ˜¯ä¸€ä¸ªå¯é€‰é¡¹</li>
</ul>
<h4 id="å®ç°"><a class="header-anchor" href="#å®ç°"></a>å®ç°</h4>
<ul>
<li>é˜®å¤§ç¥çš„åšå®¢é‡Œé¢è¿˜æœ‰ä¸€éƒ¨åˆ†å®ç°ã€‚æˆ‘å¾ˆæƒŠè®¶çš„å‘ç°ï¼Œå“å“Ÿå–‚ï¼ŒåŸæ¥æˆ‘åœ¨åŠ åšå®¢çš„è¯„è®ºæ—¶å€™ç”¨äº†å‘€ï¼Œ<code>Oauth2.0</code> ğŸ˜Š ,ä½†æ˜¯æˆ‘å½“æ—¶URLä¹±å¡«ä¸€æ°”äº†ã€‚</li>
<li><em>æ‰€è°“ç¬¬ä¸‰æ–¹ç™»å½•ï¼Œå®è´¨å°±æ˜¯ OAuth æˆæƒ</em></li>
<li>å‚è€ƒé“¾æ¥ï¼š
<ul>
<li><a href="http://www.ruanyifeng.com/blog/2019/04/github-oauth.html" target="_blank" rel="noopener">GitHub OAuth ç¬¬ä¸‰æ–¹ç™»å½•ç¤ºä¾‹æ•™ç¨‹</a></li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/hexo_blog/2019/08/13/Micro-Service/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/hexo_blog/2019/08/13/Micro-Service/" itemprop="url">Micro Service</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-08-13T13:41:09+08:00">
                2019-08-13
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/docker/" itemprop="url" rel="index">
                    <span itemprop="name">docker</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>åœ¨å­¦ä¹ ä¸€äº›<code>micro service</code>ç›¸å…³ï¼Œè®°å½•åœ¨è¿™é‡Œã€‚<br>
ç°åœ¨éƒ½æ˜¯è¯´<code>micro service</code>ï¼Œä½†æ˜¯ä»€ä¹ˆæ˜¯<code>micro service</code>ï¼Œå¯èƒ½ä¸åŒçš„äººæœ‰ä¸åŒçš„å®šä¹‰ï¼Œä½†æ˜¯å•çº¯åœ°åªæ˜¯å°†è½¯ä»¶éƒ¨ç½²åˆ°<code>docker</code>æˆ–è€…<code>k8s</code>ä¸Šé¢å»ï¼Œå¯èƒ½å¹¶ä¸å®Œå…¨ç¬¦åˆ<code>micro service</code>ï¼Œæ‰€ä»¥å­¦ä¹ ä¸€ä¸‹ã€‚<br>
å°†ä¸€äº›å­¦ä¹ åˆ°çš„tipså’Œç†å¿µè®°å½•ä¸‹æ¥ï¼Œæœ€åå½¢æˆè‡ªå·±çš„ç†è§£ã€‚<br>
å­¦ä¹ äº†ä¸€é˜µï¼Œæ„Ÿè§‰è¿˜æ˜¯ä¸ä¸€æ ·çš„ï¼Œæœ‰ä¸€å¥—æ¶æ„ä½“ç³»çš„ï¼Œè®°å½•åœ¨è¿™é‡Œã€‚</p>
<h3 id="ä»€ä¹ˆæ˜¯micro-service"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯micro-service"></a>ä»€ä¹ˆæ˜¯micro service</h3>
<ul>
<li>åªå ç”¨éœ€è¦çš„å†…å­˜å’Œå¤„ç†å™¨å¤„ç†èƒ½åŠ›</li>
<li>å¦‚æœæ˜¯å¤„ç†æ•°æ®çš„ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå¤„ç†inventory dataçš„<code>micro service</code>ï¼Œé‚£ä¹ˆè¿™ä¸ª<code>micro service</code>ä»…ä»…éœ€è¦åœ¨æ„inventory dataã€‚è€Œä¸éœ€è¦è€ƒè™‘å…¶ä»–æ•°æ®çš„å½±å“ã€‚</li>
<li><code>micro service</code>ä¸å—è¯­è¨€é™åˆ¶ï¼Œä¸åŒè¯­è¨€çš„<code>micro service</code>ä»æ—§å¯ä»¥è”åˆèµ·æ¥çš„å®Œæˆä¸€ä¸ªsolutionçš„</li>
</ul>
<h4 id="awsçš„ç†è§£"><a class="header-anchor" href="#awsçš„ç†è§£"></a>AWSçš„ç†è§£</h4>
<ul>
<li>
<p>å‚è€ƒé“¾æ¥ï¼š<a href="https://aws.amazon.com/microservices/" target="_blank" rel="noopener">AWSå¾®æœåŠ¡ç†è§£</a></p>
</li>
<li>
<p>æ¯ä¸ªæœåŠ¡éƒ½æ˜¯ç‹¬ç«‹æä¾›æœåŠ¡çš„æ¨¡å—ï¼Œå¯ä»¥ç‹¬ç«‹çš„å¼€å‘ã€å‡çº§ã€éƒ¨ç½²å’Œæ‰©å±•</p>
</li>
<li>
<p>æ¯ä¸ªæœåŠ¡ä¸åº”è¯¥å’Œä»»ä½•å…¶ä»–æœåŠ¡å…±äº«ä»£ç </p>
</li>
<li>
<p>æœåŠ¡é—´çš„ä»»ä½•äº¤äº’éƒ½åº”è¯¥é€šè¿‡<code>API</code>æ¥è¿›è¡Œ</p>
</li>
<li>
<p>æ¯ä¸ªæœåŠ¡éƒ½æ˜¯</p>
</li>
</ul>
<h4 id="å¾®è½¯çš„ç†è§£"><a class="header-anchor" href="#å¾®è½¯çš„ç†è§£"></a>å¾®è½¯çš„ç†è§£</h4>
<ul>
<li>å‚è€ƒé“¾æ¥ï¼š<a href="https://docs.microsoft.com/en-us/azure/architecture/guide/architecture-styles/microservices" target="_blank" rel="noopener">å¾®è½¯æ–‡ç« </a></li>
</ul>
<h3 id="micro-service-combination"><a class="header-anchor" href="#micro-service-combination"></a>micro service combination</h3>
<ul>
<li><code>micro service</code>æœ¬èº«æ˜¯ä¸€ä¸ª<code>complete application</code>ï¼Œå®ƒç‹¬ç«‹å®ŒæˆæŸä¸ªåŠŸèƒ½ï¼Œå¯ä»¥æœ‰interfaceæˆ–è€…æ²¡æœ‰ï¼Œå¯ä»¥è®¿é—®æ•°æ®åº“ï¼Œä¹Ÿå¯ä»¥ä¸è®¿é—®ã€‚</li>
<li>å¾ˆå¤š<code>micro service</code>è”åˆèµ·æ¥ï¼Œæˆä¸ºä¸€ä¸ªsolutionã€‚</li>
<li>é»˜è®¤åªéœ€è¦çŸ¥é“å¯¹æ–¹çš„<code>endpoint</code>å°±å¯ä»¥è¿›è¡Œé€šä¿¡ã€‚å…¶å®ä¸ä¸€å®šæ˜¯<code>http</code>åè®®çš„ï¼Œä¹Ÿæœ‰ä¸€äº›å…¶ä»–çš„å¾ˆæµè¡Œçš„æ€»çº¿æ–¹å¼ã€‚</li>
<li><strong><em>each micro service has to offer an API endpoint! é€šå¸¸éƒ½æ˜¯RESTçš„endpointï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥æ˜¯<code>wisdom endpoint</code></em></strong></li>
</ul>
<h3 id="micro-serviceç‰¹ç‚¹"><a class="header-anchor" href="#micro-serviceç‰¹ç‚¹"></a>micro serviceç‰¹ç‚¹</h3>
<ul>
<li>å¢åŠ äº†scalabilityã€‚è¯è¯´è¿™ä¸ªå§ï¼Œå…¶å®å¾ˆå¤æ‚ã€‚çœ‹æˆ‘å¦å¤–ä¸€ç¯‡åšå®¢ã€‚è€Œä¸”æœªå¿…å¤šåŠ podï¼Œèƒ½åŠ›å°±ä¸€å®šä¸Šå‡å•Š</li>
<li>ä»ä¸‹é¢æ‚è°ˆé‡Œé¢çš„å‡ ç¯‡æ–‡ç« é‡Œé¢çœ‹èµ·æ¥ï¼Œå¤§å®¶éƒ½è®¤ä¸º<code>micro service</code>ä¹‹åï¼Œæ¨¡å—ä¹‹é—´åŸºæœ¬æ˜¯å®Œå…¨è§£è€¦çš„ï¼Œå¤§å®¶éƒ½å¼€å¼€å¿ƒå¿ƒçš„å…¨æ ˆå¼å°±å…³å¿ƒè‡ªå·±çš„æ¨¡å—ï¼Œä»éœ€æ±‚åˆ°åæœŸå®¢æˆ·ç»´æŠ¤ï¼Œå®Œå…¨è‡ªä¸»ï¼Œä¸ç”¨ç®¡å…¶ä»–æ¨¡å—ã€‚<em>A benefit of microservices is that each team can be responsible for releasing their services independently and without coordination with other teams.</em>
<ul>
<li>ä½†æ˜¯ï¼Œè¿™æ€ä¹ˆå¯èƒ½å•Šã€‚å°±æˆ‘ä»¬è‡ªå·±çš„äº§å“æ¥è¯´ï¼Œå°¤å…¶æ˜¯é‚£äº›<code>lib</code>åº“ä¸€æ ·çš„æ¨¡å—ï¼Œä¸€å‡çº§ï¼Œæ‰€æœ‰çš„éƒ½å¾—åŠ¨ã€‚æ²¡æ˜ç™½ã€‚æ²¡æœ‰æ˜ç™½å‘€ã€‚</li>
<li>é™¤éæ‰€æœ‰çš„å°æ¨¡å—éƒ½åƒä¸ªäº§å“ä¸€æ ·è¿è¥ã€‚æ¯”å¦‚æä¾›å®‰å…¨ç®¡ç†åŠŸèƒ½çš„æ¨¡å—ï¼Œå‰©ä¸‹è°ƒç”¨å®ƒçš„æ¨¡å—æŒ‰ç…§è‡ªå·±çš„éœ€æ±‚è¿›è¡Œå‡çº§ã€‚</li>
<li><strong><em>å—¯ï¼Œç¡®å®ä¹Ÿæ˜¯æœ‰äº§å“è¿™ä¹ˆåšçš„ï¼Œä½†æ˜¯è¿™æ ·å°±ä¼šæœ‰å¾ˆå¤šèµ„æºæ¶ˆè€—å§ã€‚è¿™ç‚¹åœ¨å¤§ç‰›çš„åˆ†äº«ä¸­ä¹ŸæåŠè¿‡ï¼ŒO&amp;Mçš„åŠŸèƒ½æ˜¯å…¬ç”¨çš„ï¼Œä½†æ˜¯ä¼šå ç”¨èµ„æºã€‚</em></strong></li>
<li><strong><em>ä½†æ˜¯å¦‚æœå¤§å®¶éƒ½ç”¨åŒä¸€ä»½ï¼Œè°ˆä»€ä¹ˆå¾®æœåŠ¡å“¦ã€‚é‚£ä¹ˆ<code>lib</code>åº“å°±ä¸åº”è¯¥å ç”¨èµ„æºã€‚æˆ–è€…å ç”¨èµ„æºçš„å°±ä¸åº”è¯¥åšæˆ<code>lib</code>åº“ï¼Ÿ</em></strong></li>
<li><code>google</code>æ€ä¹ˆåšçš„ï¼Ÿåº”è¯¥ä¹Ÿæ˜¯æœ‰ä¸åŒçš„äº§å“å§ã€‚</li>
</ul>
</li>
</ul>
<h4 id="ä¼˜åŠ¿"><a class="header-anchor" href="#ä¼˜åŠ¿"></a>ä¼˜åŠ¿</h4>
<ul>
<li>
<p>æ”¹åŠ¨ï¼šä¸€ä¸ªå¾®å°çš„æ”¹åŠ¨éœ€è¦å¾ˆå¤šå·¥ä½œå»åšï¼Œä¸€ä¸ªå¾®å°çš„æ”¹åŠ¨ä¼šå½±å“å¾ˆå¤šéƒ¨åˆ†ï¼Œå¢åŠ ä¸€ä¸ªéœ€è¦èµ„æºçš„æ¨¡å—ï¼Œéœ€è¦å¢åŠ æ•´ä¸ªç³»ç»Ÿçš„èµ„æºï¼Œè€Œä¸æ˜¯åªå¢åŠ éœ€è¦å¢åŠ çš„éƒ¨åˆ†</p>
</li>
<li>
<p>æ‰©å±•ï¼šåŸºæœ¬ä¸Šå°±æ˜¯æŒ‡<code>load scalability</code>,åœ¨monolithichæ—¶ä»£ï¼Œæ‰©å±•æ˜¯æ‰©å±•æ‰€æœ‰çš„æ¨¡å—ï¼Œå°±æ˜¯å¤åˆ¶å‡ºæ–°çš„ä¸€ä»½ç³»ç»Ÿæ¥ã€‚è€Œå¾®æœåŠ¡æ—¶å€™ï¼Œæ˜¯æ‰©å±•éœ€è¦æ‰©å±•çš„éƒ¨åˆ†ï¼Œè¿™ç‚¹å¾ˆæœ‰ä¼˜åŠ¿</p>
<ul>
<li>æ‰€ä»¥ä»ä»¥ä¸Šä¸¤ç‚¹æ¥è¯´ï¼Œä¸€ä¸ªå¾®æœåŠ¡åœ¨éƒ¨ç½²å’Œæ‰©å±•ä¸Šé¢ï¼Œä»ä¸šåŠ¡è§’åº¦æ¥è¯´ï¼Œå°±æ˜¯serviceè§’åº¦æ¥è¯´ï¼Œåº”è¯¥æ˜¯ç‹¬ç«‹çš„ã€‚<strong><em>é‚£ä¹ˆåè¿‡æ¥æˆç«‹å—ï¼Ÿå°±æ˜¯è¯´ä¸€ä¸ªpodæˆ–è€…serviceï¼Œå¯ä»¥ç‹¬ç«‹éƒ¨ç½²ï¼Œç‹¬ç«‹æ‰©å±•ï¼Œä½†æ˜¯å¹¶ä¸èƒ½æä¾›ç‹¬ç«‹çš„æœåŠ¡ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯è¾¹ç•Œå®šä¹‰å¾—ä¸å¯¹å‘¢</em></strong></li>
<li><em>We define libraries as components that are linked into a program and called using in-memory function calls, while services are out-of-process components who communicate with a mechanism such as a web service request, or remote procedure call.</em></li>
</ul>
</li>
<li>
<p>æ–¹ä¾¿CIå’ŒCD</p>
</li>
<li>
<p>å‚è€ƒé“¾æ¥</p>
<ul>
<li><a href="https://martinfowler.com/articles/microservices.html" target="_blank" rel="noopener">Microservices Architecture</a>:</li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MjM5MjEwNTEzOQ==&amp;mid=401500724&amp;idx=1&amp;sn=4e42fa2ffcd5732ae044fe6a387a1cc3#rd" target="_blank" rel="noopener">ä¸Šä¸€ç¯‡çš„ä¸­æ–‡ç¿»è¯‘</a></li>
</ul>
</li>
</ul>
<h4 id="é€†åŠ¿"><a class="header-anchor" href="#é€†åŠ¿"></a>é€†åŠ¿</h4>
<p>å¾®æœåŠ¡ä¹Ÿæ˜¯ä¼šæœ‰ä¸€äº›é—®é¢˜å’Œéš¾ç‚¹çš„ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>è¿›ç¨‹é—´é€šä¿¡ä¼šæ¯”è¿›ç¨‹å†…é€šä¿¡ä»£ä»·å¤§å¾ˆå¤šï¼Œæ‰€ä»¥åº”è¯¥è°¨æ…è®¾è®¡è¾¹ç•Œã€‚<em>remote APIs need to be coarser-grained, which is often more awkward to use.</em> ä¸æ˜¯å¾ˆç†è§£è¿™å¥è¯</li>
<li>Consequently the teams are cross-functional, including the full range of skills required for the development: user-experience, database, and project management. æ‰€ä»¥å˜›ï¼Œæˆ‘å°±è¯´å¯¹æŠ€æœ¯äººå‘˜çš„è¦æ±‚è¶Šå‘é«˜äº†ã€‚è™½è¯´æ˜¯teamï¼Œä½†æ˜¯è¿™ç§teamä¹Ÿå¾ˆä¸å¥½æ­é…çš„å¥½ä¸å¥½ã€‚</li>
<li>å¹¶ä¸”è¿™ç§æ–¹å¼ï¼Œå°†å›¢é˜Ÿå’Œè‡ªå·±å¼€å‘çš„äº§å“ç»‘åœ¨äº†ä¸€èµ·ã€‚æ„Ÿè§‰å›åˆ°äº†ä»¥æ¨¡å—æ¥ç»„ç»‡teamçš„å¹´ä»£ã€‚å®åœ¨æ˜¯æœ‰åˆ©æœ‰å¼Šã€‚è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼ŒæŒ‰ç…§ç°åœ¨æ¨èçš„ï¼Œå°†ä¸€éƒ¨åˆ†supportçš„äº‹åŠ¡å½’åˆ°äº†æŠ€æœ¯å›¢é˜Ÿé‡Œé¢ï¼Œé‚£ä¹ˆæœ‰å‘å‰å»¶ä¼¸å—ï¼Ÿè¯è¯´è–ªæ°´å‘¢ï¼Œå¾—æ¶¨è–ªå•Š</li>
</ul>
<h3 id="å¾®æœåŠ¡æ¶æ„"><a class="header-anchor" href="#å¾®æœåŠ¡æ¶æ„"></a>å¾®æœåŠ¡æ¶æ„</h3>
<p>å…³äºå¾®æœåŠ¡æ¶æ„çš„æ–‡ç« çœŸæ˜¯å¤šå¦‚ç‰›æ¯›ã€‚ä¸€æœä¸€å¤§æŠŠã€‚çœ‹äº†é™ˆæ™§æ¨èçš„ä¸€ç¯‡æ®è¯´å…¥é—¨çº§è‹±æ–‡æ–‡ç« ï¼Œç¡®å®æ¸…æ™°æ˜äº†ã€‚è¯è¯´å¾ˆå¤šä¸­æ–‡ç¿»è¯‘ç®€ç›´æ˜¯æƒ¨ä¸å¿ç¹å•Šã€‚çœŸå¿ƒæƒ¨ä¸å¿ç¹ï¼</p>
<p>çœ‹äº†æ€»è§‰å¾—æœ‰æœ‰ç‚¹å¿ƒæƒŠå•Šï¼Œä»<code>warterful</code>åˆ°<code>agile</code>ï¼Œä»<code>monolithic</code>åˆ°<code>micro service</code>ï¼Œå¯¹å¼€å‘äººå‘˜çš„è¦æ±‚æ˜¯è¶Šæ¥è¶Šé«˜äº†å•Šã€‚ğŸ˜¦</p>
<p>è¿˜èƒ½ä¸èƒ½æ„‰å¿«åœ°åšå¼€å‘äº†å•Šï¼Ÿ<br>
<em>The microservice approach to division is different, splitting up into services organized around business capability</em></p>
<p>è¿˜å¾—æœ‰<code>business capability</code>ï¼Œè¯è¯´æŠ€æœ¯äººå‘˜ç†è§£çš„<code>business capability</code>æ­£ç¡®å—</p>
<h3 id="æ‚è°ˆ"><a class="header-anchor" href="#æ‚è°ˆ"></a>æ‚è°ˆ</h3>
<ul>
<li>
<p>æ—©ä¸Šæ— å¿ƒå·¥ä½œï¼Œæ‘¸é±¼é…±æ²¹ï¼Œçœ‹äº†å‡ ç¯‡æ–‡ç« ï¼Œè§‰å¾—è¿˜ä¸é”™ã€‚ ğŸ˜… è¯è¯´<code>InfoQ</code>å°±æ˜¯åšç¿»è¯‘å·¥ä½œçš„å˜›ï¼Œå’‹äº‘è®¡ç®—é‚£è¾¹å…¨æ˜¯ç¿»è¯‘å•Šã€‚</p>
</li>
<li>
<p><a href="https://medium.com/better-programming/how-microservices-architecture-impacted-the-culture-of-software-development-6bba363ecdf1" target="_blank" rel="noopener">How Microservices Architecture Impacted the Culture of Software Development</a>:</p>
<ul>
<li>è¿™ç¯‡æ–‡ç« çš„è§‚ç‚¹å¾ˆæ˜¯ä¸é”™ï¼Œå«ä¹‰å°±æ˜¯è¯´å†™ä»£ç å¾ˆæœ‰è¶£å•Šï¼Œæƒ³å¹²å˜›å°±å¹²å˜›ï¼ŒæŠŠè‡ªå·±è„‘å­é‡Œé¢çš„æƒ³æ³•å®ç°å‡ºæ¥ã€‚å¯æ˜¯å·¥ä½œä»¥åå°±éƒé—·äº†ï¼Œå…¨æ˜¯äº›æ¨¡ç³Šçš„è´£ä»»ï¼Œè§„å®šå¥½äº†çš„æ¡†æ¶ï¼Œè§„å®šå¥½äº†çš„æ•°æ®åº“ï¼Œè§„å®šå¥½äº†çš„è¯­è¨€ã€‚ç¡®å®å¦‚æ­¤ï¼Œä¸€å¤©å¤©æ¶ˆç£¨äº†æ„å¿—å’Œèƒ½åŠ›</li>
<li>ç°åœ¨æœ‰äº†<code>micro service</code>ï¼Œç…ç€å¤§å®¶éƒ½æŒºå¼€å¿ƒçš„ï¼Œæœ‰äº†è¿™ä¸ªé¼“åŠ¨ï¼Œä¼¼ä¹ä¹è¶£åˆå›æ¥äº†ä¸€ç‚¹ï¼Œå¯ä»¥åˆ†ä¸ºå¾ˆå°çš„<code>repo</code>ï¼Œå¯ä»¥è‡ªè¡Œé€‰æ‹©å„ç§ä¸åŒçš„è¯­è¨€å’ŒæŠ€æœ¯ï¼Œç„¶åä¸€èµ·åšæˆä¸ºä¸€ä¸ªäº§å“ã€‚ç”šè‡³å¯ä»¥æœ‰äº§å“å’Œå”®åçš„èŒè´£ã€‚</li>
<li>å˜›ï¼Œæ–‡ç« æœ€åè¿˜è¯´ï¼Œè¿™ä¸ªå¹¶ä¸å…³<code>micro service</code>çš„å…³ç³»ï¼Œæ‰€è°“çš„<code>monolithic</code>ä¹Ÿåº”è¯¥å¯ä»¥åšåˆ°ã€‚</li>
</ul>
</li>
<li>
<p><a href="https://medium.com/@steven.lemon182/why-our-team-cancelled-our-move-to-microservices-8fd87898d952" target="_blank" rel="noopener">Why our team cancelled our move to microservices</a></p>
<ul>
<li>åŸæ–‡å¾ˆé•¿ï¼Œä¸‹é¢çš„è¯„è®ºä¹Ÿååˆ†ä¹‹å¤šï¼Œå®åœ¨ä¸ç®—ä¸€æŠŠå¤´èƒ½çœ‹å®Œçš„</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/hexo_blog/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/hexo_blog/page/4/">4</a><a class="extend next" rel="next" href="/hexo_blog/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Lynn Shen</p>
              <p class="site-description motion-element" itemprop="description">35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/hexo_blog/archives/">
              
                  <span class="site-state-item-count">38</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/hexo_blog/categories/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">åˆ†ç±»</span>
                </a>
              </div>
            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Lynn Shen</span>

  
</div>


  <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/hexo_blog/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/hexo_blog/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/hexo_blog/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/hexo_blog/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/hexo_blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/hexo_blog/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/hexo_blog/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/hexo_blog/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/hexo_blog/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/hexo_blog/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/hexo_blog/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  







<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://billts.site/extra_css/gitment.css">
        <script src="https://billts.site/js/gitment.js"></script>
    
<!-- END LOCAL -->

    

    







  





  

  

  

  
  

  

  

  

</body>
</html>
