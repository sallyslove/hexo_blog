<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/hexo_blog/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/hexo_blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/hexo_blog/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/hexo_blog/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/hexo_blog/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/hexo_blog/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/hexo_blog/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦">
<meta property="og:type" content="website">
<meta property="og:title" content="è·¬æ­¥">
<meta property="og:url" content="https://sallyslove.github.io/hexo_blog/page/3/index.html">
<meta property="og:site_name" content="è·¬æ­¥">
<meta property="og:description" content="35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="è·¬æ­¥">
<meta name="twitter:description" content="35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/hexo_blog/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://sallyslove.github.io/hexo_blog/page/3/">





  <title>è·¬æ­¥</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/hexo_blog/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">è·¬æ­¥</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">ä¸ç§¯è·¬æ­¥ï¼Œæ— ä»¥è‡³åƒé‡Œ</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/hexo_blog/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/hexo_blog/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/hexo_blog/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            å½’æ¡£
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/hexo_blog/2019/02/27/K8sæ¦‚å¿µç†è§£/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/hexo_blog/2019/02/27/K8sæ¦‚å¿µç†è§£/" itemprop="url">K8sæ¦‚å¿µç†è§£</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-02-27T14:44:21+08:00">
                2019-02-27
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/docker/" itemprop="url" rel="index">
                    <span itemprop="name">docker</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="k8sæ¦‚å¿µ"><a class="header-anchor" href="#k8sæ¦‚å¿µ"></a>K8sæ¦‚å¿µ</h2>
<p>è¿™ç¯‡æ˜¯ä»K8sçš„å¸¸ç”¨å‘½ä»¤åˆ†å‡ºæ¥çš„ï¼Œå®åœ¨æ˜¯æ¦‚å¿µæ¯”è¾ƒå¤šï¼Œè·Ÿå¸¸ç”¨å‘½ä»¤æ‚åœ¨ä¸€èµ·ä¸åˆé€‚äº†ã€‚</p>
<h3 id="deployment"><a class="header-anchor" href="#deployment"></a>deployment</h3>
<ul>
<li>è¿™å‡ è€…çš„å…³ç³»æ¯”è¾ƒå¤æ‚ã€‚è¿˜éœ€è¦è¿›ä¸€æ­¥å»çœ‹ã€‚ç›®å‰å…ˆè®°å½•ä¸€ä¸‹ï¼š<code>deployment</code>æ˜¯å®é™…çš„<code>deploy</code>ï¼Œç„¶å<code>pod</code>æ˜¯æ ¹æ®<code>replica</code>é‡Œé¢çš„è®¾å®šæ¥èµ·çš„ã€‚æ‰€ä»¥ï¼Œå¦‚æœå°†<code>deployment</code>åˆ é™¤æ‰ï¼Œé‚£ä¹ˆç›¸åº”çš„<code>pod</code>å’Œ<code>replica set</code>éƒ½ä¼šæ²¡æœ‰</li>
</ul>
<h4 id="deployment-specè¯¦è§£"><a class="header-anchor" href="#deployment-specè¯¦è§£"></a>deployment specè¯¦è§£</h4>
<p>ç½‘ä¸ŠåŸºæœ¬æœç´¢ä¸åˆ°è¿™æ–¹é¢çš„ä¿¡æ¯ã€‚åº”è¯¥æ˜¯yamlæ–‡ä»¶é‡Œé¢çš„å„ä¸ªå­—æ®µå¤ªè¿‡ç›¸ä¼¼äº†ã€‚</p>
<ul>
<li><code>spec</code>è¯¦è§£ï¼š
<ul>
<li><code>metadata</code>ï¼šå…ƒæ•°æ®ï¼ŒåŒ…å«åå­—ï¼Œæ ‡ç­¾å’Œäº§å“å£°æ˜ã€‚å…ƒæ•°æ®å°±æ˜¯è¯´åŸºç¡€ä¿¡æ¯ï¼Œç™½æ</li>
</ul>
</li>
</ul>
<h4 id="deploymentå‚è€ƒé“¾æ¥"><a class="header-anchor" href="#deploymentå‚è€ƒé“¾æ¥"></a>deploymentå‚è€ƒé“¾æ¥</h4>
<ul>
<li><a href="http://www.ruanyifeng.com/blog/2007/03/metadata.html" target="_blank" rel="noopener">å…ƒæ•°æ®å‚è€ƒé“¾æ¥</a></li>
</ul>
<h3 id="pod"><a class="header-anchor" href="#pod"></a>Pod</h3>
<p><code>pod</code>å®åœ¨æ˜¯<code>K8s</code>é‡Œé¢å¾ˆé‡è¦çš„ä¸€ä¸ªæ¦‚å¿µï¼Œä¹Ÿæ˜¯å¾ˆå®½æ³›çš„ä¸€ä¸ªæ¦‚å¿µã€‚å¾ˆå¤šéƒ½å¯ä»¥æ˜¯ä¸€ä¸ª<code>pod</code>ã€‚</p>
<ul>
<li>All containers described as Pods.åŒ…æ‹¬replication cotronllerï¼Œ serviceï¼Œ deploymentã€‚<br>
<strong>ä¸çŸ¥é“æ˜¯ä¸æ˜¯æ‰€æœ‰çš„serviceç±»å‹éƒ½ä¼šè¢«å½“åšæ˜¯podï¼Œè¿™ä¸€ç‚¹æœ‰å¾…ç¡®è®¤</strong></li>
<li>A pod is a collection of containers that makes up a particular application, for example Redis.<br>
<strong>è¿™å¥æ²¡æœ‰å¾ˆæ˜ç™½å•Šï¼Œä¸æ˜¯è¯´podæ˜¯ä¸€ä¸ªcontainerå˜›ï¼Œåˆå˜æˆä¸€å †containeräº†</strong><br>
<strong>ç»è¿‡ä¸€æ®µæ—¶é—´çš„å­¦ä¹ ï¼Œæˆ‘æƒ³è¿™é‡Œå¯èƒ½æŒ‡çš„æ˜¯initContainerä¹‹ç±»çš„ï¼Œæ‰€ä»¥ä¸€ä¸ªpodé‡Œé¢å¯èƒ½æ˜¯æœ‰å¾ˆå¤šcontainerçš„</strong></li>
</ul>
<h3 id="services"><a class="header-anchor" href="#services"></a>Services</h3>
<p>serviceæ˜¯K8sé‡Œé¢å¦ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œè€Œä¸”å®åœ¨æ˜¯æœ‰ç‚¹å¤æ‚ã€‚ç±»å‹æ¯”è¾ƒå¤šã€‚K8sä¸­æ–‡æ–‡æ¡£é‡Œé¢çš„åè¯è§£é‡Šè¿˜æ˜¯æ¯”è¾ƒæ¸…æ¥šçš„ï¼Œå¹¶ä¸”ç»™å‡ºäº†ä¸ºä»€ä¹ˆéœ€è¦serviceï¼Œserviceå’Œpodæœ‰ä»€ä¹ˆåŒºåˆ«</p>
<p>æŒªåˆ°å¦ä¸€ç¯‡å•ç‹¬çš„åšå®¢é‡Œé¢äº†ã€‚</p>
<ul>
<li>å‚è€ƒé“¾æ¥
<ul>
<li><a href="https://www.kubernetes.org.cn/kubernetes-services" target="_blank" rel="noopener">åè¯è§£é‡Š Services</a></li>
</ul>
</li>
</ul>
<h3 id="configmap"><a class="header-anchor" href="#configmap"></a>configmap</h3>
<ul>
<li><em>In Kubernetes, a ConfigMap is simply a container for storing configuration data. Other things, like pods, can access the data in a ConfigMap.</em></li>
</ul>
<h3 id="secrets"><a class="header-anchor" href="#secrets"></a>secrets</h3>
<h3 id="persistentvolumnclumns"><a class="header-anchor" href="#persistentvolumnclumns"></a>PersistentVolumnClumns</h3>
<ul>
<li>PVCåœ¨å®šä¹‰çš„æ—¶å€™æœ‰ä¸ªstorageclassã€‚è¿™ä¸ªstorageclassæ˜¯å®šä¹‰åœ¨<code>kube-system</code>çš„namespaceé‡Œé¢çš„</li>
<li>åœ¨å®‰è£…æ—¶å€™ï¼Œshare Cç›˜é‡åˆ°äº†é—®é¢˜ï¼Œç”¨â€œdocker for desktopâ€çš„é»˜è®¤çš„storageclassï¼šhostpathæ¥åˆ›PVCï¼Œå°±èµ·ä¸æ¥äº†ã€‚äºæ˜¯åœ¨å¤§ç¥çš„æ•™å¯¼ä¸‹å¦åˆ›äº†ä¸€ä¸ªStorageClassï¼Œå°†å…¶æ˜ å°„åˆ°docker machineçš„è™šæœºé‡Œé¢ã€‚è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</li>
<li>åœ¨å°è¯•è§£å†³è¿™ä¸ªCç›˜æ²¡æ³•shareçš„é—®é¢˜æ—¶å€™å‚è€ƒäº†å¾ˆå¤šèµ„æ–™ã€‚å·¥ä½œç”µè„‘ç”±äºç³»ç»Ÿå…³ç³»ï¼Œæ²¡æœ‰åŠæ³•åˆ›å»ºadministrator groupçš„userï¼Œæ‰€ä»¥ç»•ä¸è¿‡å»ã€‚</li>
<li>å‚è€ƒçš„é“¾æ¥æœ‰ï¼š
<ul>
<li><a href="https://dotblogs.com.tw/swater111/2017/01/26/101009" target="_blank" rel="noopener">share Cç›˜æ€»ç»“</a>ï¼šè¿™ç¯‡èµ„æ–™è¿˜æ˜¯ä¸é”™çš„ï¼Œé‡Œé¢æ±‡æ€»äº†å¯èƒ½é‡åˆ°çš„å¥½å‡ ä¸ªé—®é¢˜ã€‚</li>
<li><a href="https://blogs.msdn.microsoft.com/stevelasker/2016/06/14/configuring-docker-for-windows-volumes/" target="_blank" rel="noopener">share Cç›˜å®¶é‡Œå’‹æ•´</a></li>
<li><a href="https://tomssl.com/2018/01/11/sharing-your-c-drive-with-docker-for-windows-when-using-azure-active-directory-azuread-aad/" target="_blank" rel="noopener">local useræ–¹æ³•</a></li>
</ul>
</li>
</ul>
<h3 id="namespace"><a class="header-anchor" href="#namespace"></a>namespace</h3>
<ul>
<li>
<p>å½“å›¢é˜Ÿæˆ–é¡¹ç›®ä¸­å…·æœ‰è®¸å¤šç”¨æˆ·æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨Namespaceæ¥åŒºåˆ†ã€‚</p>
</li>
<li>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œç›¸åŒNamespaceä¸­çš„å¯¹è±¡å°†å…·æœ‰ç›¸åŒçš„è®¿é—®æ§åˆ¶ç­–ç•¥ã€‚</p>
</li>
<li>
<p>Kubernetesä»ä¸¤ä¸ªåˆå§‹çš„Namespaceå¼€å§‹ï¼š</p>
<ul>
<li>
<p>default</p>
</li>
<li>
<p>kube-system ç”±Kubernetesç³»ç»Ÿåˆ›å»ºçš„å¯¹è±¡çš„Namespace</p>
</li>
<li>
<p>è‡ªå·±ç”µè„‘ä¸Šé¢è£…å¥½çš„docker for desktopé‡Œé¢æœ‰ä»¥ä¸‹çš„namespace</p>
<pre><code>$ kubectl get namespaces
NAME           STATUS    AGE
default        Active    15d
docker         Active    15d
kube-public    Active    15d
kube-system    Active    15d
</code></pre>
</li>
</ul>
</li>
<li>
<p>å¤§å¤šæ•°<code>Kubernetes</code>èµ„æºï¼ˆä¾‹å¦‚<code>pod</code>ã€<code>services</code>ã€<code>replication controllers</code>æˆ–å…¶ä»–ï¼‰éƒ½åœ¨æŸäº›Namespaceä¸­ï¼Œä½†Namespaceèµ„æºæœ¬èº«å¹¶ä¸åœ¨Namespaceä¸­ã€‚è€Œä½çº§åˆ«èµ„æºï¼ˆå¦‚<code>Node</code>å’Œ<code>persistentVolumes</code>ï¼‰ä¸åœ¨ä»»ä½•Namespaceä¸­ã€‚</p>
</li>
<li>
<p><code>Events</code>æ˜¯ä¸€ä¸ªä¾‹å¤–ï¼šå®ƒä»¬å¯èƒ½æœ‰ä¹Ÿå¯èƒ½æ²¡æœ‰Namespaceï¼Œå…·ä½“å–å†³äº<code>Events</code>çš„å¯¹è±¡ã€‚</p>
</li>
<li>
<p>å‚è€ƒé“¾æ¥ï¼š<a href="http://docs.kubernetes.org.cn/242.html" target="_blank" rel="noopener">Kubernetes Namespaces</a></p>
</li>
</ul>
<h3 id="replication-controller"><a class="header-anchor" href="#replication-controller"></a>replication controller</h3>
<ul>
<li>The replication controller defines how many instances should be running, the Docker Image to use, and a name to identify the service.<br>
<strong>å†³å®šå¤šå°‘ä¸ªinstanceå¯ä»¥ç†è§£ï¼Œä¸åŒçš„instanceå¯ä»¥ä½¿ç”¨ä¸åŒçš„imageå—</strong></li>
</ul>
<h3 id="ingress"><a class="header-anchor" href="#ingress"></a>Ingress</h3>
<ul>
<li>Ingressï¼šAn Ingress enables inbound connections to the cluster, allowing external traffic to reach the correct Pod.å‰ä¸€å¥æ²¡çœ‹æ‡‚ã€‚</li>
<li>Ingress enables externally-reachable urls, load balance traffic, terminate SSL, offer name based virtual hosting for a Kubernetes cluster.</li>
<li>é€šå¸¸æƒ…å†µä¸‹ï¼Œserviceå’Œpodçš„IPä»…å¯åœ¨é›†ç¾¤å†…éƒ¨è®¿é—®ã€‚é›†ç¾¤å¤–éƒ¨çš„è¯·æ±‚éœ€è¦é€šè¿‡è´Ÿè½½å‡è¡¡è½¬å‘åˆ°serviceåœ¨Nodeä¸Šæš´éœ²çš„NodePortä¸Šï¼Œç„¶åå†ç”±kube-proxyå°†å…¶è½¬å‘ç»™ç›¸å…³çš„Podã€‚è€ŒIngresså°±æ˜¯ä¸ºè¿›å…¥é›†ç¾¤çš„è¯·æ±‚æä¾›è·¯ç”±è§„åˆ™çš„é›†åˆ</li>
<li>Ingress.yamlé‡Œé¢çš„ä¿¡æ¯ä¸å¯èƒ½å®Œå…¨åˆ—è¿™é‡Œï¼Œæœ‰ä»¥ä¸‹ä¸€äº›å…ƒç´ å’Œç±»å‹:
<ul>
<li>Kind: namespace ä»è¿™è¾¹çœ‹ingressçš„å®è´¨æ˜¯namespaceï¼Ÿ</li>
<li>Kindï¼šsecret  typeï¼šOpaqueï¼Œé‡Œé¢çš„æ•°æ®çœ‹èµ·æ¥æ˜¯è¯ä¹¦å½¢å¼ The default server secret is a self-signed certificate for other Nginx example SSL connections and is required by the Nginx Default Example.</li>
<li>Kindï¼šServiceAccount: The ServiceAccount defines the account with a set of permissions on how to access the cluster to access the defined Ingress Rules.</li>
<li>Kindï¼šConfigMap</li>
<li>ç°åœ¨çœ‹æ¥ï¼Œä¸Šé¢è¿™ä¸€æ®µæœ‰ç‚¹è¯¯è§£ã€‚å› ä¸ºå½“æ—¶æ˜¯å­¦ä¹ k8sçš„åœ¨çº¿trainingï¼Œæˆ‘æƒ³è¿™ä¸ªIngress.yamlåªä¸è¿‡æ˜¯éƒ¨ç½²ä¸€ä¸ªå…ƒç´ ã€‚çœŸæ­£èµ·ä½œç”¨çš„æ˜¯ingress-rules.yamlæ–‡ä»¶ã€‚è¿™ä¸ªæ‰æ˜¯å¦‚ä½•ç”Ÿæˆä¸€ä¸ªingressã€‚</li>
</ul>
</li>
<li>è¿˜æœ‰ä¸ªingress-rulesçš„yamlæ–‡ä»¶ã€‚é‡Œé¢çš„å†…å®¹å¦‚ä¸‹ï¼š
<ul>
<li>Kind: Ingress è¿™ä¸ªruleå°±æ˜¯ruleï¼Œå“ªä¸ªendPointè¿›å“ªä¸ªdeployment</li>
<li>æ¯ä¸ªIngresséƒ½éœ€è¦é…ç½®rulesï¼Œç›®å‰Kubernetesä»…æ”¯æŒhttpè§„åˆ™ã€‚æ‰€ä»¥æœ€å…³é”®çš„å°±æ˜¯rule</li>
</ul>
</li>
<li>å‚è€ƒé“¾æ¥ï¼š
<ul>
<li><a href="https://www.kubernetes.org.cn/ingress" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£ åè¯è§£é‡Šï¼šIngress</a></li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/hexo_blog/2019/02/26/Helmå…¥é—¨/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/hexo_blog/2019/02/26/Helmå…¥é—¨/" itemprop="url">Helmå…¥é—¨</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-02-26T15:50:36+08:00">
                2019-02-26
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/docker/" itemprop="url" rel="index">
                    <span itemprop="name">docker</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="helm"><a class="header-anchor" href="#helm"></a>Helm</h2>
<p><code>Helm</code>å…¥é—¨ç¯‡ã€‚æ„Ÿè§‰æœ‰ç‚¹ç±»ä¼¼<code>maven</code>ï¼Œæ€»å½’æœ‰è¿™æ ·ä¸€ä¸ªç®¡ç†å·¥å…·ã€‚å…¶å®æ˜¯æƒ³çœ‹<code>Ingress</code>çš„ï¼Œå¯æ˜¯ä¸çœ‹<code>Helm</code>ï¼Œ<code>yaml</code>çœ‹ä¸æ‡‚å‘€ã€‚åªå¥½æ»šå›æ¥çœ‹<code>Helm</code>ã€‚</p>
<p>å†™äº†ä¸€é˜µä¹‹åå†çœ‹çœ‹ï¼Œä¼šå‘ç°æœ‰äº›çœ‹ä¸æ˜ç™½çš„åœ°æ–¹ã€‚æœç„¶ï¼Œæˆ‘å†™åšå®¢çš„é£æ ¼å’Œä¸Šå­¦å¹´ä»£è®°ç¬”è®°çš„é£æ ¼ä¸€æ ·ï¼Œå–œæ¬¢ç®€ç•¥è€Œä¸å¤Ÿè¯¦å°½å•Šã€‚è¿™æ˜¯è¯´å¥½å¤šå¹´æ²¡æœ‰å˜åŒ–å’Œè¿›æ­¥å˜› ğŸ˜‚</p>
<h3 id="helmæ˜¯ä»€ä¹ˆ"><a class="header-anchor" href="#helmæ˜¯ä»€ä¹ˆ"></a>Helmæ˜¯ä»€ä¹ˆ</h3>
<ul>
<li><code>Helm</code>æ˜¯åœ¨Kubernetesä¸­å®‰è£…éƒ¨ç½²å®¹å™¨çš„ä¸€ä¸ªå·¥å…·ã€‚</li>
<li><em>Helm is a tool for managing Kubernetes charts.</em></li>
<li><code>Helm</code>ç”±<code>Helm</code>å®¢æˆ·ç«¯ã€<code>Tiller</code>æœåŠ¡å™¨ç«¯å’Œ<code>Chart</code>ä»“åº“æ‰€ç»„æˆ
<ul>
<li><code>Helm</code>å®¢æˆ·ç«¯ï¼š å®¢æˆ·ç«¯äº¤äº’</li>
<li><code>Tiller</code>æœåŠ¡å™¨ç«¯ï¼š è£…åœ¨k8sçš„clusteré‡Œé¢ï¼Œç®¡ç†<code>chart</code></li>
<li><code>Chart</code>ä»“åº“ï¼šåˆ›å»º<code>Kubernetes</code>åº”ç”¨å®ä¾‹çš„ä¿¡æ¯é›†åˆ
<ul>
<li><code>Chart</code>ç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼Œç¬¬ä¸€ä¸ªéƒ¨åˆ†æ˜¯A description of the package (Chart.yaml)</li>
<li>One or more templates, which contain Kubernetes manifest filesã€‚è¿™ä¸ªtemplatesçš„è¯ï¼Œåº”è¯¥ä¹Ÿæ˜¯yamlæ–‡ä»¶å§ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="å¸¸ç”¨çš„helmå‘½ä»¤"><a class="header-anchor" href="#å¸¸ç”¨çš„helmå‘½ä»¤"></a>å¸¸ç”¨çš„helmå‘½ä»¤</h3>
<ul>
<li><code>helm status &lt;namespace&gt;</code> æŸ¥çœ‹<code>Helm</code>çš„çŠ¶æ€</li>
<li><code>helm install</code>: å®é™…å°†<code>helm</code>é‡Œé¢çš„å†…å®¹å®‰è£…åˆ°å½“å‰çš„<code>k8s</code>ä¸Šé¢ã€‚æ¯”å¦‚æˆ‘åˆ›äº†ä¸€ä¸ª<code>configMap.yaml</code>çš„<code>templete</code>ï¼Œé‚£ä¹ˆå°±ä¼šå®‰è£…ä¸Šå»ã€‚
<ul>
<li>å¦‚æœåªæ˜¯æƒ³çœ‹çœ‹<code>template</code>çš„<code>rending</code>ï¼Œé‚£ä¹ˆä½¿ç”¨å‘½ä»¤<code>helm install ./mychart --debug --dry-run</code></li>
<li>å¦‚æœæƒ³ä¼ å€¼è¿›å»ï¼Œå¯ä»¥ä½¿ç”¨<code>-f</code> å‘½ä»¤ï¼Œæ¯”å¦‚<code>helm install -f myvals.yaml ./mychart</code>ã€‚è¿™æ ·ä¼ çš„å€¼ï¼Œå¯ä»¥ç”¨<code>.Value</code>æ¥è®¿é—®</li>
<li>å•ç‹¬ä¼ å€¼æ˜¯<code>--set foo=bar</code>ï¼Œ<code>--set</code>æ¯”æ–‡ä»¶çš„çº§åˆ«é«˜ï¼Œå¯ä»¥è¦†ç›–æ–‡ä»¶é‡Œé¢çš„å€¼</li>
<li>ä»¥ä¸‹å‘½ä»¤é‡Œé¢å°†<code>livenessProbe.httpGet</code>åˆ é™¤æ‰äº†ã€‚</li>
</ul>
</li>
</ul>
<pre><code>helm install stable/drupal --set image=my-registry/drupal:0.1.0 --set livenessProbe.exec.command=[cat,docroot/CHANGELOG.txt] --set livenessProbe.httpGet=null

$ helm install ./mychart
  NAME:   guiding-ocelot
  LAST DEPLOYED: Mon Aug 19 17:23:00 2019
  NAMESPACE: gear-1
  STATUS: DEPLOYED

  RESOURCES:
      ==&gt; v1/ConfigMap
      NAME               DATA  AGE
      mychart-configmap  1     0s
</code></pre>
<ul>
<li>
<p><code>helm get manifest &lt;release name&gt;</code>: æ¯”å¦‚ä¸Šé¢çš„è¿™ä¸ª<code>guiding-ocelot</code></p>
<pre><code> $ helm get manifest guiding-ocelot

 ---
  # Source: myChart/templates/configmap.yaml
  apiVersion: v1
  kind: ConfigMap
  metadata:
    name: mychart-configmap
  data:
    myvalue: &quot;Hello World&quot;
</code></pre>
</li>
<li>
<p><code>helm init</code>:å®‰è£…tilleræœåŠ¡å™¨ç«¯</p>
<ul>
<li>åœ¨å·¥ä½œä¸­ç¢°åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨åš<code>helm init</code>çš„æ—¶å€™æ²¡æœ‰å¸¦ä¸Š<code>--client-only</code>é€‰é¡¹ï¼Œç»“æœå°†æœåŠ¡å™¨ç«¯çš„<code>Tiller</code>ç»™æ›´æ–°äº†ã€‚</li>
<li>è¯è¯´æˆ‘åœ¨åšå®¢ä¸Šé¢è¿™æ ·å†™äº†å•Šã€‚å…¶å®å®¢æˆ·ç«¯ä¹Ÿæ˜¯æ›´æ–°çš„</li>
</ul>
</li>
<li>
<p><code>helm delete --purge &lt;release name&gt;</code></p>
</li>
<li>
<p><code>helm repo add &lt;repo name&gt; &lt;repo address&gt;</code></p>
</li>
<li>
<p><code>helm create &lt;chart name&gt;</code>: ç”Ÿæˆä¸€ä¸ªç›®å½•</p>
<pre><code>$ find myChart/
  myChart/
  myChart/.helmignore
  myChart/Chart.yaml
  myChart/charts
  myChart/templates
  myChart/templates/deployment.yaml
  myChart/templates/ingress.yaml
  myChart/templates/NOTES.txt
  myChart/templates/service.yaml
  myChart/templates/tests
  myChart/templates/tests/test-connection.yaml
  myChart/templates/_helpers.tpl
  myChart/values.yaml
</code></pre>
</li>
</ul>
<h3 id="helm-chart"><a class="header-anchor" href="#helm-chart"></a>Helm Chart</h3>
<h3 id="helm-template"><a class="header-anchor" href="#helm-template"></a>Helm Template</h3>
<ul>
<li>å‚è€ƒä»¥ä¸Šï¼Œé»˜è®¤ç”Ÿæˆä¸€å¥—chartçš„æ—¶å€™ä¼šç”Ÿæˆtemplateç›®å½•ã€‚
<ul>
<li><em>NOTES.txt: The â€œhelp textâ€ for your chart. This will be displayed to your users when they run helm install.</em></li>
<li><em>deployment.yaml: A basic manifest for creating a Kubernetes deployment</em></li>
<li><em>service.yaml: A basic manifest for creating a service endpoint for your deployment</em></li>
<li>_ <em>helpers.tpl: A place to put template helpers that you can re-use throughout the chart</em></li>
</ul>
</li>
</ul>
<h4 id="template-values"><a class="header-anchor" href="#template-values"></a>Template Values</h4>
<ul>
<li>
<p>E.g. <code>nameï¼š</code>ï¼Œä¸‹é¢è¿™ä¸ªä¾‹å­é‡Œé¢ç”¨<code>release name</code> æ¥åšå‰ç¼€ã€‚è¯è¯´è¿™ä¸ª<code>release name</code>åœ¨å“ªé‡Œå®šä¹‰çš„ï¼Œæˆ‘æ²¡æ‰¾åˆ°ã€‚</p>
<ul>
<li>
<p><em>So we could read <code>.Release.Name</code> as â€œstart at the top namespace, find the <code>Release</code> object, then look inside of it for an object called <code>Name</code>â€.</em></p>
</li>
<li>
<p><code>.Release</code>è¡¨ç¤º<code>Release</code>æ˜¯é¡¶çº§çš„object</p>
<pre><code>apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
data:
  myvalue: &quot;Hello World&quot;
</code></pre>
</li>
</ul>
</li>
<li>
<p>é¡¶çº§çš„è‡ªå¸¦çš„objectåŒ…æ‹¬ï¼š <code>Release</code>,<code>Value</code>,<code>Chart</code>,<code>Template</code>, <code>Capabilities</code>è¿˜æœ‰<code>File</code>ã€‚åä¸¤ä¸ªè¿˜ä¸æ˜¯å¾ˆç†è§£</p>
<ul>
<li>
<p><code>Release</code>é‡Œé¢åŒ…å«å¾ˆå¤šå˜é‡ï¼Œæœ‰<code>Release.Time</code>,<code>Release.Namespace</code>, <code>Release.Revision</code>,è¯¦æƒ…å¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£</p>
</li>
<li>
<p><code>Values</code>é‡Œé¢çš„å…¶å®æ˜¯ä»<code>values.yaml</code>é‡Œé¢æ¥çš„</p>
</li>
<li>
<p><code>Template</code>: åŒ…å«å½“å‰æ­£åœ¨æ‰§è¡Œçš„<code>template</code>çš„ä¿¡æ¯</p>
</li>
<li>
<p><code>Chart</code> é‡Œé¢çš„å°±æ˜¯<code>chart.yaml</code>æ¥çš„ã€‚æ¯”å¦‚</p>
<pre><code>{{.Chart.Name}}-{{.Chart.Version}} 
</code></pre>
</li>
</ul>
</li>
</ul>
<h4 id="template-functions"><a class="header-anchor" href="#template-functions"></a>Template Functions</h4>
<ul>
<li>
<p><em>Helm has over 60 available functions.</em> å…¶ä¸­ä¸€äº›æ˜¯è°ƒç”¨<code>GO</code>è¯­è¨€é‡Œé¢<code>tamplate</code>å®šä¹‰çš„å‡½æ•°ã€‚åœ¨<a href="https://godoc.org/text/template" target="_blank" rel="noopener">Go Template Function</a>å¯ä»¥æŸ¥è¯¢åˆ°</p>
</li>
<li>
<p>å…¶å®<code>Helm Template</code>å¹¶ä¸æ˜¯Helmè‡ªèº«åšå‡ºæ¥çš„ï¼Œå…¶å®æ˜¯ä»Goè¿™äº›æ¥çš„ã€‚å°±æ˜¯ä¸ªæ‹¿æ¥å†é›†æˆä¸€ä¸‹ã€‚å¹¶ä¸æ˜¯Helmè‡ªå·±çš„ã€‚</p>
</li>
<li>
<p><code>Helm functions</code>æ”¯æŒç®¡é“<code>pipeline</code>ã€‚è¿™é‡Œçš„<code>pipeline</code>å’Œ<code>Unix</code>é‡Œé¢çš„åŒæ ·å«ä¹‰ã€‚å¦‚ä¸‹é¢çš„ä¾‹å­é‡Œé¢çš„ï¼š</p>
<pre><code>food: {{ .Values.favorite.food | upper | quote }}
drink: {{ .Values.favorite.drink | repeat 5 | quote }}
</code></pre>
</li>
</ul>
<h5 id="å¸¸ç”¨å‡½æ•°"><a class="header-anchor" href="#å¸¸ç”¨å‡½æ•°"></a>å¸¸ç”¨å‡½æ•°</h5>
<ul>
<li>
<p><code>default</code>ï¼šç”¨æ¥æŒ‡å®šé»˜è®¤å€¼</p>
<pre><code>  drink: {{ .Values.favorite.drink | default "tea" | quote }}
</code></pre>
</li>
<li>
<p><code>toyaml</code>: è½¬æˆyamlæ ¼å¼ <strong><em>å…¶å®ä¸æ˜ç™½å•¥å«åšYamlæ ¼å¼</em></strong></p>
</li>
</ul>
<h5 id="å‡½æ•°æ§åˆ¶å’Œæ“ä½œè¿ç®—ç¬¦"><a class="header-anchor" href="#å‡½æ•°æ§åˆ¶å’Œæ“ä½œè¿ç®—ç¬¦"></a>å‡½æ•°æ§åˆ¶å’Œæ“ä½œè¿ç®—ç¬¦</h5>
<ul>
<li><code>Helm Template</code>çš„å‡½æ•°æ˜¯å¯ä»¥å¼•å…¥é€»è¾‘æ§åˆ¶çš„</li>
<li>è¿ç®—ç¬¦æœ‰ï¼š
<ul>
<li><code>if/else</code> for creating conditional blocksï¼š <code>if</code>åˆ¤æ–­æœ‰ç‚¹ä¸ä¸€æ ·çš„æ˜¯ç©ºçš„å­—ç¬¦ä¸²æˆ–è€…ç©ºçš„é›†åˆä¹Ÿä¼šè¢«è®¤ä¸ºæ˜¯<code>false</code>ï¼Œè¿˜æœ‰æ•°å­—0</li>
<li><code>with</code> to specify a scope</li>
<li><code>range</code> which provides a â€œfor eachâ€-style loop</li>
</ul>
</li>
</ul>
<h6 id="function-if-else"><a class="header-anchor" href="#function-if-else"></a>Function if/else</h6>
<ul>
<li>
<p>é€»è¾‘ç¨å¾®æœ‰ç‚¹éš¾ç†è§£ã€‚å°±æ˜¯<code>if</code>è¯­å¥é‡Œé¢çš„å†…å®¹æ˜¯åˆ¤æ–­æ¡ä»¶æˆç«‹çš„æ—¶å€™åŒ…å«çš„ã€‚ç„¶åå…³ç³»è¿ç®—ç¬¦åœ¨å‰ï¼Œè¿™é‡Œæ˜¯<code>or</code>è¿ç®—ç¬¦</p>
<pre><code>  {{/* include the body of this if statement when the variable .Values.anUnsetVariable is set or .values.aSetVariable is not set */}}
  {{ if or .Values.anUnsetVariable (not    .Values.aSetVariable) }}
   {{ ... }}
  {{ end }}
</code></pre>
</li>
</ul>
<h6 id="function-range"><a class="header-anchor" href="#function-range"></a>Function Range</h6>
<ul>
<li>
<p><code>range</code>ç›¸å½“äºæ˜¯<code>foreach</code>,æ¯”å¦‚ä»¥ä¸‹æ˜¯ä¸€ä¸ª<code>slice</code>ï¼Œå…¶å®å°±æ˜¯åˆ—è¡¨ã€‚</p>
<pre><code>pizzaToppings:
 - mushrooms
 - cheese
 - peppers
 - onions
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥è¿™æ ·æ“ä½œï¼š</p>
<pre><code> toppings: |-
  {{- range .Values.pizzaToppings }}
  - {{ . | title | quote }}
  {{- end }}
</code></pre>
<ul>
<li>ä»¥ä¸Š<code>range</code>å‡½æ•°éå†<code>pizzaToppings</code>é‡Œé¢çš„æ¯ä¸ªæ•°å€¼ï¼Œ <code>.</code>ä»£è¡¨å…¶ä¸­æ¯ä¸ªæ•°å€¼ï¼Œä¼ é€’ç»™<code>title</code>å’Œ<code>quote</code>å‡½æ•°ã€‚</li>
<li><code>|-</code>ä»£è¡¨ä»¥ä¸‹å†…å®¹æ˜¯ä¸€ä¸ªé•¿å­—ç¬¦ä¸²ã€‚å› ä¸º<code>Configmap</code>åªæ”¯æŒé”®å€¼å¯¹ã€‚</li>
</ul>
</li>
<li>
<p><code>range</code>ä¹Ÿå¯ä»¥å’Œ<code>list</code>åˆå¹¶èµ·æ¥ç”¨ã€‚å¦‚ä¸‹ï¼š</p>
<pre><code> sizes: |-
 {{- range list "small" "medium" "large" }}
  - {{ . }}
 {{- end }}
</code></pre>
<ul>
<li>å¼•å·é‡Œé¢çš„ç»„æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åå†éå†å­—ç¬¦ä¸²</li>
</ul>
</li>
<li>
<p><code>range</code>ä¹Ÿå¯ä»¥å’Œå…¶ä»–é›†åˆå‡½æ•°è”åˆä½¿ç”¨ï¼Œæ¯”å¦‚<code>dict</code>å’Œ<code>map</code></p>
</li>
</ul>
<h6 id="function-with"><a class="header-anchor" href="#function-with"></a>Function with</h6>
<ul>
<li>
<p><code>.</code>æŒ‡çš„æ˜¯å½“å‰ä½œç”¨åŸŸï¼Œæ¯”å¦‚<code>.Values</code>ï¼Œå°±æ˜¯åœ¨å½“å‰ä½œç”¨åŸŸçš„<code>Value</code>é‡Œé¢</p>
</li>
<li>
<p>ä½¿ç”¨<code>with</code>å‡½æ•°å¯ä»¥æ”¹å˜ä½œç”¨åŸŸï¼Œç”¨æ³•å’Œ<code>if</code>ç±»ä¼¼ã€‚å¦‚ä¸‹ï¼š</p>
<pre><code>{{ with PIPELINE }}
# restricted scope
{{ end }}
</code></pre>
</li>
</ul>
<h5 id="ç©ºæ ¼å’Œç©ºè¡Œ"><a class="header-anchor" href="#ç©ºæ ¼å’Œç©ºè¡Œ"></a>ç©ºæ ¼å’Œç©ºè¡Œ</h5>
<ul>
<li>
<p>è¿™å°±æ˜¯ä¸ºå•¥æ¯è¡Œéƒ½ä¸¤ä¸ªå¤§æ‹¬å·åŠ å°æ¨ªçº¿çš„ç¼˜æ•…ï¼Œç…ç€ä¸€å †å°æ¨ªçº¿å®åœ¨æ— è¯­å•Šã€‚è¿™ä¸ªä¸¤ä¸ªå¤§æ‹¬å·åŠ å°æ¨ªçº¿markdownè¿˜æ‰“ä¸å‡ºæ¥ï¼ŒOMG ğŸ˜•</p>
<ul>
<li>
<p>ä»¥ä¸‹çš„è¯­å¥ä¼šäº§ç”Ÿä¸€ä¸ª<code>Json</code>å­—æ®µ<code>mugï¼štrue</code>å¹¶ä¸”æ²¡æœ‰ç©ºè¡Œ</p>
<pre><code>{{ if and .Values.favorite.drink (eq .Values.favorite.drink "coffee") }}mug: true{{ end }}
</code></pre>
</li>
<li>
<p>ä½†æ˜¯å¦‚æœæ˜¯ä»¥ä¸‹è¯­å¥å°±ä¼šäº§ç”Ÿåœ¨è¿™ä¸ªå­—æ®µä¹‹å‰ç”Ÿæˆä¸€ä¸ªç©ºè¡Œã€‚ä¼°è®¡<code>helm</code>å°±æ˜¯ç®€å•çš„å°†<code>if</code>è¯­å¥çš„ä¸€è¡Œç»™ç”¨ç©ºæ ¼æ›¿ä»£äº†</p>
<pre><code>{{if eq .Values.favorite.drink "coffee"}}
 mug: true
{{end}}
</code></pre>
</li>
<li>
<p>æ‰€ä»¥ä¸Šé¢çš„è¯­å¥å…¶å®è¾ƒä¸ºæ¸…æ™°ï¼Œå´å¿…é¡»ç”¨ä»¥ä¸‹æ ·å¼æ›¿ä»£ï¼Œè¿™æ ·<code>Helm</code>å°±çŸ¥é“å°†è¿™è¾¹çš„ç©ºæ ¼éƒ½åˆ é™¤æ‰</p>
<pre><code>{{- if eq .Values.favorite.drink "coffee"}}
 mug: true
{{- end}}
</code></pre>
</li>
<li>
<p>For the details on whitespace control in templates,see the Official <a href="https://godoc.org/text/template" target="_blank" rel="noopener">Go template documentation</a></p>
</li>
</ul>
</li>
<li>
<p>ä¹Ÿå¯ä»¥æ›´ä¸ºç²¾ç¡®å¾—æ§åˆ¶ç©ºæ ¼ï¼Œå¦‚ä¸‹ã€‚è¿™ç§ç”¨æ³•åœ¨ä»£ç é‡Œä¹Ÿçœ‹åˆ°å¾ˆå¤šã€‚</p>
<pre><code>{{indent 2 "mug:true"}}
</code></pre>
</li>
<li>
<p>è¿˜å¯ä»¥ç”¨<code>*</code>ç¬¦å·ï¼Œ<em>Just for the sake of making this point clear, letâ€™s adjust the above, and substitute an <code>*</code> for each whitespace that will be deleted following this rule. an <code>*</code> at the end of the line indicates a newline character that would be removed</em> æ²¡çœ‹çš„å¤ªæ˜ç™½ã€‚è¿™ä¸ª<code>*</code>æ˜¯å¹²å˜›ç”¨çš„ã€‚</p>
<pre><code>**{{- if eq .Values.favorite.drink "coffee"}}
  mug: true*
**{{- end}}
</code></pre>
</li>
</ul>
<h4 id="å˜é‡"><a class="header-anchor" href="#å˜é‡"></a>å˜é‡</h4>
<ul>
<li>
<p>å˜é‡æ˜¯ç”¨<code>:=</code>æ¥å®šä¹‰çš„ã€‚</p>
</li>
<li>
<p>å¦‚ä¸‹ã€‚åŸæœ¬åœ¨ä½¿ç”¨äº†<code>with</code>ä¹‹åä½œç”¨åŸŸå·²ç»æ”¹å˜äº†ï¼Œæ‰¾ä¸åˆ°<code>Release</code>äº†ï¼Œä½†æ˜¯ä½¿ç”¨äº†å˜é‡ï¼Œå°±åˆå¯ä»¥è®¿é—®äº†ã€‚</p>
<pre><code>data:
myvalue: &quot;Hello World&quot;
{{- $relname := .Release.Name -}}
{{- with .Values.favorite }}
drink: {{ .drink | default "tea" | quote }}
food: {{ .food | upper | quote }}
release: {{ $relname }}
{{- end }}
</code></pre>
</li>
<li>
<p>å¯ä»¥å’Œ<code>range</code>ç»“åˆèµ·æ¥ç”¨ã€‚</p>
<ul>
<li>
<p>éå†ä¸€ä¸ªåˆ—è¡¨ã€‚<code>index</code>å˜é‡æ˜¯ä¸‹æ ‡ï¼Œä»<code>0</code>å¼€å§‹</p>
<pre><code>toppings: |-
  {{- range $index, $topping := .Values.pizzaToppings }}
    {{ $index }}: {{ $topping }}
  {{- end }}
</code></pre>
</li>
<li>
<p>é”®å€¼å¯¹ã€‚æ³¨æ„<code>Values.favorite</code>æ˜¯é”®å€¼å¯¹çš„é›†åˆã€‚æ‰€ä»¥ç¬¬ä¸€æ¬¡æ˜¯ä¸€å¯¹ï¼Œç¬¬äºŒæ¬¡æ˜¯ç¬¬äºŒå¯¹</p>
<pre><code>{{- range $key, $val := .Values.favorite }}
  {{ $key }}: {{ $val | quote }}
{{- end}}
</code></pre>
</li>
</ul>
</li>
<li>
<p>å˜é‡æ˜¯æœ‰ä½œç”¨åŸŸçš„ã€‚é¡¶å±‚å£°æ˜çš„å°±æ˜¯æ•´ä¸ª<code>template</code>å¯ç”¨ï¼Œ<code>range</code>é‡Œé¢å£°æ˜çš„ï¼Œå°±æ˜¯<code>range</code>é‡Œé¢å¯ç”¨ã€‚æ¯”å¦‚ä¸Šé¢è¿™ä¸ªä¾‹å­ï¼Œå‡ºäº†<code>end</code>å°±æ²¡ç”¨äº†ã€‚</p>
</li>
<li>
<p><strong>æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ <code>$</code>ï¼Œä»£è¡¨æ ¹ä½œç”¨åŸŸï¼</strong></p>
</li>
</ul>
<h4 id="å·²å‘½åçš„template"><a class="header-anchor" href="#å·²å‘½åçš„template"></a>å·²å‘½åçš„Template</h4>
<p>å°±æ˜¯ä»‹ç»ä¸€ä¸‹å¦‚ä½•å¼•ç”¨å•Šï¼Œå‘½åä¹‹ç±»ã€‚éœ€è¦æ³¨æ„çš„æ˜¯åå­—æ˜¯å…¨å±€çš„ï¼Œä¸ç®¡è¿™ä¸ª<code>template</code>æ˜¯ä¸æ˜¯åŒ…åœ¨å…¶ä»–çš„<code>template</code>é‡Œé¢ã€‚<br>
__éœ€è¦çš„ä¸€ç‚¹æ˜¯ï¼Œåå­—ä¸­æœ‰ä¸‹åˆ’çº¿çš„<code>template</code>æ˜¯ä¸ä¼šè¢«éƒ¨ç½²åˆ°<code>kubernate</code>ä¸Šé¢çš„ã€‚ä½†æ˜¯å¯ä»¥è¢«å…¶ä»–<code>template</code>å¼•ç”¨</p>
<h5 id="define"><a class="header-anchor" href="#define"></a>define</h5>
<ul>
<li>
<p>ä½¿ç”¨<code>define</code>å¯ä»¥åœ¨ä¸€ä¸ª<code>template</code>å†…éƒ¨åˆ›å»ºä¸€ä¸ªæ–°çš„<code>template</code>ã€‚è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code>{{- define "mychart.labels" }}
  labels:
    generator: helm
    date: {{ now | htmlDate }}
{{- end }}
</code></pre>
</li>
<li></li>
</ul>
<h5 id="templateå’Œinclude"><a class="header-anchor" href="#templateå’Œinclude"></a>templateå’Œinclude</h5>
<ul>
<li>
<p><code>template</code>æ„Ÿè§‰å’Œ<code>include</code>æœ‰ç‚¹ç›¸ä¼¼ã€‚æ˜¯è°ƒç”¨ç”¨<code>define</code>å®šä¹‰çš„<code>template</code>çš„ã€‚å¦‚ä¸‹ï¼š</p>
<pre><code>metadata:
  name: {{ .Release.Name }}-configmap
  {{- template "mychart.labels" }}
</code></pre>
</li>
<li>
<p>é€šå¸¸è¿™ç±»<code>template</code>ä¼šè¢«æ”¾åœ¨<code>_helpers.tpl</code>æ–‡ä»¶é‡Œé¢ã€‚æˆ‘çš„æ„Ÿè§‰æ˜¯ï¼Œè¿™ç±»<code>template</code>å¾ˆåƒ<code>util</code>å‡½æ•°ï¼Œç„¶åæ”¾åœ¨ä¸€ä¸ªé›†ä¸­çš„æ–‡ä»¶é‡Œé¢ã€‚ä¸€èˆ¬ä¼šåœ¨å‰é¢åŠ ä¸€ä¸ªæ³¨é‡Šï¼Œå¦‚ä¸‹çš„æ ¼å¼ï¼š</p>
<pre><code>{{/* ... */}}
</code></pre>
</li>
<li>
<p>ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ä¸Šé¢ä¾‹å­çš„è°ƒç”¨ï¼Œå¹¶æ²¡æœ‰ç»™ä»»ä½•çš„ä½œç”¨åŸŸï¼Œè€Œ<code>template</code>çš„é»˜è®¤ä½œç”¨åŸŸä¸ºç©ºã€‚å¦‚ä¸‹çš„<code>template</code>é‡Œé¢çš„<code>.Chart</code>æ˜¯æ— æ³•ç”Ÿæ•ˆçš„ã€‚æ‰€ä»¥è°ƒç”¨æ—¶å€™åº”è¯¥ç”¨ä»¥ä¸‹å½¢å¼ã€‚è¿™æ ·ä¼ å…¥ä¸€ä¸ªä½œç”¨åŸŸå°±å¯ä»¥äº†ã€‚</p>
<pre><code>{{/* Generate basic labels */}}
  {{- define "mychart.labels" }}
    labels:
      generator: helm
      date: {{ now | htmlDate }}
      chart: {{ .Chart.Name }}
      version: {{ .Chart.Version }}
  {{- end }}
  

{{- template "mychart.labels" .}}
</code></pre>
</li>
<li>
<p>è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œ<code>template</code>æœ‰ç‚¹ç±»ä¼¼<code>inline</code>ï¼Œå°±æ˜¯ç®€å•çš„å°†å†…å®¹å±•å¼€ï¼Œå¹¶ä¸è€ƒè™‘ç¼©è¿›çš„é—®é¢˜ã€‚ä¸ºæ­¤ï¼Œå¼•å…¥äº†<code>include</code>ï¼Œ <code>include</code>å¯ä»¥ç”¨<code>pipeline</code>æ¥æŒ‡å®šç¼©è¿›ã€‚æ¨èä½¿ç”¨<code>include</code>æ¥æ›¿ä»£<code>template</code></p>
<pre><code>{{- include "mychart.app" . | nindent 2 }}
</code></pre>
</li>
</ul>
<h4 id="å¼•ç”¨æ–‡ä»¶"><a class="header-anchor" href="#å¼•ç”¨æ–‡ä»¶"></a>å¼•ç”¨æ–‡ä»¶</h4>
<ul>
<li>
<p><code>.File</code>å¯ä»¥å°†æ–‡ä»¶åŒ…å«è¿›æ¥ã€‚éœ€è¦æ³¨æ„çš„æœ‰ï¼Œ<code>template</code>ç›®å½•ä¸‹é¢çš„æ–‡ä»¶æ²¡æ³•è¢«åŒ…å«ã€‚å¦‚ä¸‹ä¾‹å­ã€‚<code>.File.Get</code>å°±æ˜¯è¯»å–æ–‡ä»¶çš„å†…å®¹çš„å‡½æ•°</p>
<pre><code> {{- $files := .Files }}
 {{- range list "config1.toml" "config2.toml" "config3.toml" }}
  {{ . }}: |-
    {{ $files.Get . }}
 {{- end }}
</code></pre>
</li>
</ul>
<h3 id="å‚è€ƒæ–‡æ¡£"><a class="header-anchor" href="#å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h3>
<ul>
<li><a href="https://www.cnblogs.com/Erik_Xu/p/8893725.html" target="_blank" rel="noopener">Helmä»‹ç»</a></li>
<li><a href="https://github.com/helm/helm" target="_blank" rel="noopener">Helm GitHubé¡µé¢</a></li>
<li><a href="https://helm.sh/docs/using_helm/#quickstart-guide" target="_blank" rel="noopener">Helmä½¿ç”¨æ–‡æ¡£</a></li>
<li><a href="https://helm.sh/docs/chart_template_guide/" target="_blank" rel="noopener">Helmå®˜æ–¹æ–‡æ¡£</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/hexo_blog/2019/02/26/Liveness-Readiness/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/hexo_blog/2019/02/26/Liveness-Readiness/" itemprop="url">Liveness & Readiness</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-02-26T14:29:11+08:00">
                2019-02-26
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/docker/" itemprop="url" rel="index">
                    <span itemprop="name">docker</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="liveness-readiness"><a class="header-anchor" href="#liveness-readiness"></a>Liveness &amp; Readiness</h2>
<h3 id="readiness"><a class="header-anchor" href="#readiness"></a>Readiness</h3>
<ul>
<li>Readiness Probes checks if an application is ready to start processing traffic.</li>
<li>This probe solves the problem of the container having started, but the process still warming up and configuring itself meaning itâ€™s not ready to receive traffic.</li>
<li>The configuration is as following:<br>
readinessProbe:<br>
httpGet:<br>
path: /<br>
port: 80<br>
initialDelaySeconds: 1<br>
timeoutSeconds: 1</li>
</ul>
<h3 id="liveness"><a class="header-anchor" href="#liveness"></a>Liveness</h3>
<ul>
<li>Liveness Probes ensure that the application is healthy and capable of processing requests.</li>
<li>The configuration is as following:<br>
livenessProbe:<br>
httpGet:<br>
path: /<br>
port: 80<br>
initialDelaySeconds: 1<br>
timeoutSeconds: 1</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/hexo_blog/2019/02/22/Jetty-Graceful-shutdown/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/hexo_blog/2019/02/22/Jetty-Graceful-shutdown/" itemprop="url">Jetty Graceful shutdown</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-02-22T15:21:42+08:00">
                2019-02-22
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/Other/" itemprop="url" rel="index">
                    <span itemprop="name">Other</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="jetty"><a class="header-anchor" href="#jetty"></a>Jetty</h2>
<p>å·¥ä½œä¸­éœ€è¦äº†è§£Jettyå¯åœçš„ä¸€äº›çŸ¥è¯†ï¼Œå¯èƒ½ä¸èƒ½çœ‹åˆ°å…¨è²Œï¼Œè¿™è¾¹è®°å½•ä¸‹æ¥ã€‚æ¯•ç«Ÿä¸æ˜¯webçš„äº§å“ã€‚äº†è§£å¾—è¿˜ä¸å¤Ÿæ·±å…¥å•Šã€‚</p>
<h3 id="what-is-graceful-shutdown"><a class="header-anchor" href="#what-is-graceful-shutdown"></a>what is graceful shutdown</h3>
<ul>
<li>Graceful shutdown of a server, context or connector is when existing request/connections are allowed to gracefully complete while no new requests and/or connections are accepted.</li>
<li>It is configured on the Server instance with the setGracefulShutdown(long) method. Heres an example of setting this via the jetty.xml file, where we specify a â€œgraceâ€ period of 30000 milliseconds:<br>
<set name="gracefulShutdown">30000</set></li>
<li>The parameter may be already not used any more</li>
</ul>
<h3 id="how-it-works"><a class="header-anchor" href="#how-it-works"></a>How it works</h3>
<ul>
<li>As soon as the shutdown command is given, the container will close the connectors so that they do not accept any more inbound connections.</li>
<li>æ‰€ä»¥åœ¨<code>ServerControllerImpl</code>é‡Œé¢ï¼Œå¦‚æœHTTPçš„é…ç½®å‚æ•°æ˜¯falseï¼ŒConnectorç¡®å®æ˜¯ä¸€ä¸Šæ¥å°±åœæ‰äº†ã€‚ä½†æ˜¯æ€ä¹ˆéƒ½åˆ°<code>JettyServerçš„</code>getContextï¼ˆï¼‰`å‡½æ•°é‡Œé¢çš„</li>
<li><code>ServerControllerImpl</code> åº”è¯¥æ˜¯HTTP serverçš„controller</li>
</ul>
<pre><code> if (!ServerControllerImpl.this.configuration.isHttpEnabled()) {
                connectorsx = ServerControllerImpl.this.jettyServer.getConnectors();
                if (connectorsx != null) {
                     ...
                      this.stopConnector(backupConnector);
                            ServerControllerImpl.this.jettyServer.removeConnector(backupConnector);
  ...
</code></pre>
<ul>
<li>This will inform most load balancers that the server is no longer part of the cluster.</li>
<li>The contexts are closed so that they do not accept any more requests, but the requests currently inside the container will drain out and the Server instance will shutdown after the grace period expires.<br>
not very sure here. It seems that connector and context are different. I think the connector is more related with port. But context is more related with servlet.</li>
</ul>
<h3 id="elements"><a class="header-anchor" href="#elements"></a>Elements</h3>
<p>æˆ‘ç†è§£åœ¨æ•´ä¸ªjetty server shutdownçš„æ—¶å€™æœ‰å‡ ä¸ªä¸œè¥¿ï¼š connectorã€contextã€serverã€‚ä»¥ä¸‹æ˜¯ç†è§£ï¼Œä¸ä¸€å®šå‡†ç¡®ï¼š</p>
<ul>
<li>servlet æ˜¯åœ¨contexté‡Œé¢çš„ï¼Œcontextä¸€æ—¦stopæ‰ï¼Œservletä¹Ÿä¼šè·Ÿç€destroyã€‚contextæ˜¯WebAppHttpContextï¼Œservletæ˜¯å…¶ä¸­çš„ä¸€ä¸ªweb Elementã€‚</li>
<li>æœ‰ä¸‰ä¸ªcontextï¼Œä¸€ä¸ªæ˜¯HttpServiceContextï¼Œ ä¸€ä¸ªæ˜¯WebAppHttpContextï¼Œè¿˜æœ‰servletçš„contextã€‚WebAppHttpContextæ˜¯jetty stop contextæ—¶å€™åœæ‰çš„ï¼Œæ¯ä¸ªweb appå¯¹åº”ä¸€ä¸ªã€‚å‰è€…æ˜¯jetty serveråœæ‰çš„æ—¶å€™åœæ‰çš„ã€‚æ„Ÿè§‰serveråœæ‰çš„æ—¶å€™ï¼ŒwebAppHttpContextä¸ä¸€å®šéƒ½ç»“æŸäº†ã€‚ä½†æ˜¯jetty serveråœæ‰çš„æ—¶å€™ï¼ŒHttpServiceContextæ˜¯åœæ­¢äº†ã€‚servletçš„contextç»“æ„æ˜¯servleté‡Œé¢çš„ä¸€ä¸ªinternal classï¼Œè·Ÿæ¯ä¸ªuriç»‘å®šã€‚</li>
<li>connectoræ˜¯åœ¨jettyé‡Œé¢å®šä¹‰çš„,æœ‰å‡ ç§connectorï¼Œæ¯”å¦‚<code>org.eclipse.jetty.server.ssl.SslSelectChannelConnector</code>ï¼Œ<code>org.eclipse.jetty.server.nio.SelectChannelConnector</code>ã€‚</li>
</ul>
<p>åœ¨Connectorçš„interfaceé‡Œé¢æœ‰ä¸ªmaxIdleTimeoutçš„å‚æ•°ï¼Œæ ‡ç¤ºè¿™ä¸ªconnectionåœ¨idleæ—¶å€™ä¼šç­‰å¤šä¹…ä»ESTABLISHçŠ¶æ€å˜æˆTIME_WAITçŠ¶æ€ã€‚ä½†æ˜¯å¹¶æ²¡æœ‰åœ¨ä»£ç é‡Œé¢æ‰¾åˆ°è°ƒç”¨çš„åœ°æ–¹ã€‚</p>
<p>___ è¿™ä¸ªæ˜¯åœ¨åœçš„æ—¶å€™è°ƒç”¨çš„é‚£ä¸ªå—ï¼Ÿæœç„¶å†™blogè¦å†æ¸…æ¥šä¸€ç‚¹æ‰å¥½___</p>
<ul>
<li>Connectoræ˜¯åœ¨jettyçš„é…ç½®æ–‡ä»¶é‡Œé¢é…ç½®çš„</li>
</ul>
<h3 id="jettyå¯åŠ¨è¿‡ç¨‹"><a class="header-anchor" href="#jettyå¯åŠ¨è¿‡ç¨‹"></a>Jettyå¯åŠ¨è¿‡ç¨‹</h3>
<p>å¤§éƒ¨åˆ†webå®¹å™¨çš„å¯åŠ¨è¿‡ç¨‹éƒ½å·®ä¸å¤šï¼Œåˆ†ä¸ºå¦‚ä¸‹å‡ æ­¥ï¼š</p>
<ul>
<li>åˆ›å»ºç”¨äºè¿æ¥çš„connectorï¼Œåˆ›å»ºçº¿ç¨‹æ± </li>
<li>æ‰«æå½“å‰çš„webç¨‹åºçš„éƒ¨ç½²ç›®å½•ï¼Œä¸ºä»–ä»¬åˆ›å»ºä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œå¹¶å¯¹ä»–ä»¬è¿›è¡Œpathçš„è·¯ç”±è®¾ç½®ï¼Œè¿™ä¸ªçš„åå­—æ˜¯WebAppHttpContext</li>
<li>åˆå§‹åŒ–åˆ›å»ºçš„webç¨‹åºä¸Šä¸‹æ–‡ï¼Œè¿™é‡Œå°±åŒ…æ‹¬åˆ›å»ºservletå•¥çš„ã€‚ï¼Œåˆå§‹åŒ–linstenerå•¥çš„ã€‚å¹¶åšå¥½è‡ªå·±çš„pathè·¯ç”±ã€‚.</li>
<li>å¯åŠ¨connectorï¼Œå¼€å§‹ç›‘å¬ï¼Œæ•´ä¸ªserverå¼€å§‹è¿è¡Œ</li>
<li>æ²¡çœ‹å‡ºæ¥HttpServiceContextæ˜¯ä»€ä¹ˆ</li>
<li>å‚è€ƒæ–‡æ¡£ï¼š
<ul>
<li><a href="https://blog.csdn.net/kobejayandy/article/details/20291953" target="_blank" rel="noopener">Jettyçš„Serveråˆ›å»ºä¸å¯åŠ¨</a></li>
</ul>
</li>
</ul>
<h3 id="filter-servlet-listeneré¡ºåº"><a class="header-anchor" href="#filter-servlet-listeneré¡ºåº"></a>Filterã€Servletã€Listeneré¡ºåº</h3>
<h4 id="å¯åŠ¨é¡ºåº"><a class="header-anchor" href="#å¯åŠ¨é¡ºåº"></a>å¯åŠ¨é¡ºåº</h4>
<ul>
<li>filterçš„åˆå§‹åŒ–æ˜¯web serverå¯åŠ¨çš„æ—¶å€™åˆå§‹åŒ–çš„</li>
<li>servletçš„åˆå§‹åŒ–æ˜¯æ”¶åˆ°å¯¹åº”çš„ç¬¬ä¸€æ¡requestæ—¶å€™è¿›è¡Œçš„</li>
<li>æ‰§è¡Œæ—¶å€™æ˜¯å…ˆæ‰§è¡Œfilterï¼Œå†æ‰§è¡Œservlet</li>
<li>ä»å¯åŠ¨æ—¥å¿—æ¥çœ‹ï¼Œå¯åŠ¨çš„é¡ºåºä¸ºlistener-&gt;Filter-&gt;servlet.</li>
</ul>
<h4 id="åœæ­¢é¡ºåº"><a class="header-anchor" href="#åœæ­¢é¡ºåº"></a>åœæ­¢é¡ºåº</h4>
<ul>
<li>å®¹å™¨å…³é—­æˆ–è€…contexté‡æ–°éƒ¨ç½²ï¼Œè¿™æ—¶å€™servletå…ˆdestroyæ‰</li>
<li>servletä¹‹åæ‰æ˜¯filterå…³é—­</li>
</ul>
<h4 id="å‚è€ƒèµ„æ–™"><a class="header-anchor" href="#å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4>
<ul>
<li><a href="https://www.jianshu.com/p/612c3a6673b2" target="_blank" rel="noopener">Listenerã€Filterã€Servletæ‰§è¡Œé¡ºåº</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/hexo_blog/2019/02/15/å¸¸ç”¨k8så‘½ä»¤è®°å½•/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/hexo_blog/2019/02/15/å¸¸ç”¨k8så‘½ä»¤è®°å½•/" itemprop="url">å¸¸ç”¨k8så‘½ä»¤è®°å½•</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-02-15T14:15:01+08:00">
                2019-02-15
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/docker/" itemprop="url" rel="index">
                    <span itemprop="name">docker</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="å¸¸ç”¨k8så‘½ä»¤"><a class="header-anchor" href="#å¸¸ç”¨k8så‘½ä»¤"></a>å¸¸ç”¨k8så‘½ä»¤</h2>
<p>è¿™ç¯‡è®°å½•ä¸€ä¸‹å¸¸ç”¨çš„k8så‘½ä»¤ï¼Œæˆ‘æ€•æˆ‘ä¼šå¿˜å•Š  -_-#<br>
æ²¡é”™ï¼Œè¿™æ˜¯dockeré‚£ç¯‡çš„å§å¦¹ç¯‡å“¦ã€‚æ£’æ£’å“’:P</p>
<ul>
<li><code>kubectl cluster-info</code></li>
<li><code>kubectl get nodes</code></li>
<li><code>kubectl run first-deployment --image=katacoda/docker-http-server --port=80</code>
<ul>
<li>è¿™æ ·å°±æœ‰ä¸€ä¸ªpodå•¦ã€‚åœ¨get pods commandé‡Œé¢èƒ½çœ‹åˆ°ä¸€ä¸ªpod</li>
<li><code>-port</code>ä»æ—§æ˜¯å†…éƒ¨çš„ç«¯å£</li>
<li>å¤–éƒ¨ç«¯å£å¯ä»¥ç”¨<code>--hostport=8001</code>æŒ‡å®šï¼Œ ä½†æ˜¯è¿™æ ·åšçš„è¯ï¼Œ Under the covers, this exposes the Pod via Docker Port Mapping. As a result, you will not see the service listed using <code>kubectl get svc</code>ã€‚ç›®å‰çš„ç†è§£æ˜¯ï¼Œå› ä¸ºæ˜¯ç”¨çš„dockerçš„æ–¹æ³•ï¼Œæ‰€ä»¥k8sä¸çŸ¥é“
<ul>
<li>ç”¨docker pså‘½ä»¤èƒ½çœ‹åˆ°è¿™ä¸ªcontainerï¼Œç„¶åå¯ä»¥æ³¨æ„åˆ°æœ‰ä¸¤ä¸ªpsè¿›ç¨‹ã€‚å…¶ä¸­ä¸€ä¸ªæ˜¯pausedçŠ¶æ€ï¼Œç„¶åæˆ‘ä»¬çš„ç«¯å£8001å…¶å®å¼€åœ¨è¿™ä¸ªpausedçš„psä¸Šé¢ã€‚</li>
<li>The ports are exposed on the Pod, not the http container itself. The Pause container is responsible for defining the network for the Pod. Other containers in the pod share the same network namespace. This improves network performance and allow multiple containers to communicate over the same network interfaceâ€¦æ„Ÿè§‰è¿™æ®µè§£é‡Šå¾ˆå…³é”®å•Šã€‚è¿™ä¸ªcontainerçš„åå­—æ˜¯ï¼š k8s_POD_â€œhttpexposedâ€,æœ€åä¸€ä¸ªå­—æ®µæ˜¯æˆ‘ä»¬èµ·çš„podçš„åå­—</li>
</ul>
</li>
<li><code>--replicas</code>ï¼š å¤åˆ¶å› å­</li>
</ul>
</li>
<li><code>kubectl get pods</code>
<ul>
<li>æ‰€ä»¥get podsçš„è¯ï¼Œä¼šæŠŠreplication cotronllerï¼Œ serviceï¼Œ deploymentéƒ½ç»™æ‰“å°å‡ºæ¥</li>
</ul>
</li>
<li><code>kubectl get rc</code>
<ul>
<li>å°†replication controlleræ‰“å°å‡ºæ¥ã€‚</li>
</ul>
</li>
<li><code>kubectl get services</code></li>
<li><code>kubectl get deployments</code>
<ul>
<li>æ„Ÿå—ä¸€ä¸‹è¿™ä¸¤ä¸ªçš„åŒºåˆ«</li>
</ul>
</li>
</ul>
<pre><code>  $ kubectl get pods
     NAME                           READY     STATUS    RESTARTS   AGE
     http-7b77c4cd66-74zqx          1/1       Running   0          4s
     http-7b77c4cd66-fhlmx          1/1       Running   0          19m
     http-7b77c4cd66-xrbpf          1/1       Running   0          4s
     httpexposed-5c4cf8b7d8-qprzc   1/1       Running   0          11m
  $ kubectl get deployments
     NAME          DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
     http          3         3         3            3           19m
     httpexposed   1         1         1            1           11m
</code></pre>
<ul>
<li><code>kubectl describe deployment http</code></li>
<li><code>kubectl describe svc http</code> èƒ½çœ‹åˆ°å¾ˆå¤šä¿¡æ¯ï¼ŒåŒ…æ‹¬æ•´ä¸ªclusterå¯¹å¤–çš„ipï¼Œå„ä¸ªnodeçš„å†…éƒ¨ipä¹‹ç±»</li>
<li><code>kubectl scale --replicas=3 deployment http</code> scaleçš„å‘½ä»¤</li>
<li><code>kubectl create -f deployment.yaml</code> é€šè¿‡yamlæ–‡ä»¶åˆ›å»ºä¸€ä¸ªdeployment
<ul>
<li><code>kubectl create -f service.yaml</code> ä¹Ÿå¯ä»¥é€šè¿‡yamlæ–‡ä»¶åˆ›å»ºservice</li>
<li>ymalæ–‡ä»¶é‡Œé¢çš„å†…å®¹è¿˜ä¸æ˜¯éå¸¸æ¸…æ¥šã€‚å‚è€ƒ<a href="https://blog.csdn.net/luanpeng825485697/article/details/83753260" target="_blank" rel="noopener">k8s yamlæ–‡ä»¶è¯¦è§£</a></li>
</ul>
</li>
<li><code>kubectl apply -f deployment.yaml</code>å¦‚æœyamlæ–‡ä»¶æœ‰æ”¹åŠ¨çš„è¯ï¼Œå¯ä»¥ç”¨è¿™æ¡å‘½ä»¤æ¥update</li>
</ul>
<pre><code> $ kubectl apply -f deployment.yaml
   Warning: kubectl apply should be used on resource created by either kubectl create --save-config or kubectl apply
  deployment.extensions/webapp1 configured
</code></pre>
<ul>
<li><code>kubectl exec $pod -- /usr/bin/curl -s localhost/unhealthy</code></li>
<li><code>kubectl get ing</code> å¯ä»¥ç”¨æ¥çœ‹Ingress</li>
<li><code>kubectl create namespace</code>åˆ›å»ºnamespace</li>
<li><code>kubectl config set-context $(kubectl config current-context) --namespace=&lt;insert-namespace-name-here&gt;</code></li>
<li><code>kubectl config get-contexts</code> è¿™ä¸ªcontextä¸çŸ¥é“æ˜¯å•¥</li>
<li><code>kubectl get namespaces</code></li>
<li><code>kubectl delete pvc --all --namespace default</code> ç”¨è¿™ä¸ªå‘½ä»¤æ¥åšdeleteã€‚ä¸€å †éƒ½è¡Œã€‚pvcæ¢æˆpodï¼Œdeploymentsï¼Œsecretï¼Œconfigmapï¼Œserviceå•¥çš„</li>
<li>å®‰è£…k8sçš„dashboardï¼š
<ul>
<li>ä½¿ç”¨â€œdocker for desktopâ€œçš„æ—¶å€™ï¼Œè¿™ä¸ªdashboardè²Œä¼¼ä¸æ˜¯äº‹å…ˆè£…å¥½çš„ã€‚å°è±¡ä¸æ·±åˆ»äº†ã€‚éœ€è¦è£…ä¸€ä¸‹ï¼š</li>
<li><code>kubectl create -f https://raw.githubusercontent.com/kubernetes/dashboard/master/src/deploy/recommended/kubernetes-dashboard.yaml</code></li>
<li><code>kubectl proxy</code> å†å°†proxyç»™å¼„å‡ºæ¥ï¼Œå°±å¯ä»¥è®¿é—®äº†ã€‚</li>
<li>å¦‚ä¸‹å›¾ï¼š<br>
<img src="https://user-images.githubusercontent.com/5803001/34945022-c57b369a-fa3c-11e7-85e7-83f716d10705.png" alt></li>
<li>å‚è€ƒé“¾æ¥ç™»å½•ï¼š
<ul>
<li><a href="https://segmentfault.com/a/1190000012850396" target="_blank" rel="noopener">configç™»å½•æ–¹å¼</a></li>
<li><a href="https://www.cnblogs.com/guigujun/p/8366530.html" target="_blank" rel="noopener">configç™»å½•æ–¹å¼2</a></li>
<li><a href="https://www.cnblogs.com/jackyfei/p/10180465.html" target="_blank" rel="noopener">tokenæ–¹å¼ç™»å½•</a></li>
</ul>
</li>
<li>è·å–tokençš„å‘½ä»¤ï¼š<code>kubectl -n kube-system describe secret $(kubectl -n kube-system get secret | grep admin-user | awk '{print $1}')</code></li>
</ul>
</li>
</ul>
<h3 id="å‚è€ƒæ–‡æ¡£"><a class="header-anchor" href="#å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h3>
<ul>
<li><a href="http://docs.kubernetes.org.cn/475.html" target="_blank" rel="noopener">k8sä¸­æ–‡æ–‡æ¡£</a></li>
<li><a href="https://www.katacoda.com/courses/kubernetes/kubectl-run-containers" target="_blank" rel="noopener">codekaraçš„åœ¨çº¿è¯¾ç¨‹</a></li>
</ul>
<h3 id="ä¸»è¦ç‰¹æ€§"><a class="header-anchor" href="#ä¸»è¦ç‰¹æ€§"></a>ä¸»è¦ç‰¹æ€§</h3>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/hexo_blog/2019/02/14/å¸¸ç”¨Dockerå‘½ä»¤è®°å½•/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/hexo_blog/2019/02/14/å¸¸ç”¨Dockerå‘½ä»¤è®°å½•/" itemprop="url">å¸¸ç”¨Dockerå‘½ä»¤è®°å½•</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-02-14T15:16:01+08:00">
                2019-02-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/docker/" itemprop="url" rel="index">
                    <span itemprop="name">docker</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="å¸¸ç”¨dockerå‘½ä»¤"><a class="header-anchor" href="#å¸¸ç”¨dockerå‘½ä»¤"></a>å¸¸ç”¨dockerå‘½ä»¤</h2>
<p>è¿™ç¯‡è®°å½•ä¸€ä¸‹å¸¸ç”¨çš„dockerå‘½ä»¤ï¼Œæˆ‘æ€•æˆ‘ä¼šå¿˜å•Š  -_-#<br>
è¿™ç¯‡åšå®¢å†™å¾—å¥½éšæ„çš„æ„Ÿè§‰å•Š</p>
<ul>
<li><code>docker run</code> -d / -it / -v / -p /â€“name/-l
<ul>
<li>-d: background; -v: ç£ç›˜æ˜ å°„ ï¼›-pï¼šç«¯å£æ˜ å°„; -l: label</li>
</ul>
</li>
<li><code>docker build -t ï¼ˆbuild-directoryï¼‰ dockerfile</code> build docker image
<ul>
<li>-t æŒ‡å®šç¼–è¯‘å‡ºæ¥çš„imageçš„åå­—ã€‚å¯ä»¥å¸¦ä¸Šç‰ˆæœ¬ã€‚æ¯”å¦‚ï¼šfirstImage:v1</li>
<li>-f æŒ‡å®šdockerfileçš„åå­—</li>
</ul>
</li>
<li><code>docker inspect</code>çœ‹ä¸€ä¸ªimageçš„ä¿¡æ¯æˆ–è€…containerçš„ä¿¡æ¯
<ul>
<li>docker inspect -f â€œâ€ katacoda-label-example</li>
<li>These labels will remain even if the image has been untagged. When an image is untagged, it will have the name <none></none></li>
</ul>
</li>
<li>Labelå°±æ˜¯ä¸­æ–‡å«ä¹‰ä¸€æ ·çš„æ ‡ç­¾ï¼Œkey-valueçš„å½¢å¼ï¼Œæ¯”å¦‚user=lynnï¼Œè¿™æ ·å­ã€‚é™¤äº†userï¼Œè¿˜ä¼šæœ‰versionå•Š
<ul>
<li>LABEL vendor=Katacoda \ com.katacoda.version=0.0.5 \ com.katacoda.build-date=2016-07-01T10:47:29Z \ com.katacoda.course=Docker</li>
<li>container, image, demonéƒ½å¯ä»¥æœ‰labelï¼Œåœ¨æŸ¥çœ‹æ—¶å€™éƒ½å¯ä»¥ç”¨ä¸Š</li>
</ul>
</li>
<li>å‚è€ƒé“¾æ¥ï¼š<a href="https://www.katacoda.com/courses/docker/2" target="_blank" rel="noopener">karacoda dockeråœ¨çº¿è¯¾ç¨‹</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/hexo_blog/2019/02/14/Scalaæ¦‚å¿µå¿«é€Ÿè§£é‡Š/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/hexo_blog/2019/02/14/Scalaæ¦‚å¿µå¿«é€Ÿè§£é‡Š/" itemprop="url">Scalaæ¦‚å¿µå¿«é€Ÿè§£é‡Š</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-02-14T10:18:49+08:00">
                2019-02-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/Scala/" itemprop="url" rel="index">
                    <span itemprop="name">Scala</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="scalaæ¦‚å¿µå¿«é€Ÿè§£é‡Š"><a class="header-anchor" href="#scalaæ¦‚å¿µå¿«é€Ÿè§£é‡Š"></a>Scalaæ¦‚å¿µå¿«é€Ÿè§£é‡Š</h2>
<p>Scalaæœ‰å¾ˆå¤šç‰¹æœ‰çš„æ¦‚å¿µã€‚å¦‚æœè¦çœ‹æ‡‚ä»£ç å°±å¾—å¤§è‡´æ˜ç™½å«ä¹‰ï¼Œè¿™ç¯‡åšå®¢å°±æ˜¯å¿«é€Ÿè§£é‡Šä¸€ä¸‹ï¼Œå…¶ä¸­å¯èƒ½ä¼šæœ‰ä¸å¤Ÿå‡†ç¡®çš„åœ°æ–¹ï¼Œå°±æ˜¯ä¸æ±‚ç”šè§£ï¼Œåªæ±‚è¿…é€Ÿè¯»æ‡‚scalaä»£ç äº†.<br>
éš”äº†ä¸€æ®µæ—¶é—´åˆå¼€å§‹çœ‹scalaçš„ä»£ç ï¼Œç»“æœå‘ç°è¿™ç¯‡åšå®¢å†™å¾—å¤ªä¸å£°æƒ…å¹¶èŒ‚äº†ã€‚scalaè¿˜æ˜¯æ¯”è¾ƒå¤æ‚çš„ã€‚è¿™ä¹ˆç®€å•å†™å‡ å¥ä¸å¤ªæˆï¼Œå¾—ç»™ä¸€ç‚¹ä¾‹å­æ‰è¡Œã€‚</p>
<h3 id="object"><a class="header-anchor" href="#object"></a>object</h3>
<p>çœ‹äº†å‡ ç¯‡åšå®¢ï¼Œè§£é‡Šéƒ½ä¸å¤Ÿæ¸…æ™°çš„æ„Ÿè§‰ï¼Œè¿˜æ˜¯stackoverflowä¸Šé¢è§£é‡Šå¾—æ›´æ¸…æ¥š</p>
<ul>
<li>
<p>ä½œä¸ºstaticå‡½æ•°çš„classæ–‡ä»¶ï¼Œè¿™æ˜¯æœ€å¸¸è§åˆ°çš„ç”¨æ³•ï¼š</p>
<pre><code> object A {
    def twice(i: Int): Int = 2*i
 }
</code></pre>
</li>
<li></li>
<li>
<p>å‚è€ƒé“¾æ¥ï¼š<br>
-<a href="https://stackoverflow.com/questions/1755345/difference-between-object-and-class-in-scala" target="_blank" rel="noopener">difference-between-object-and-class-in-scala</a></p>
</li>
</ul>
<h3 id="trait"><a class="header-anchor" href="#trait"></a>trait</h3>
<ul>
<li><a href="http://www.runoob.com/scala/scala-traits.html" target="_blank" rel="noopener">Scala Trait(ç‰¹å¾)</a></li>
<li>ç±»ä¼¼javaçš„Interfaceï¼Œå…¶å®æ›´è¿‘ä¼¼äºæŠ½è±¡ç±»</li>
<li>ä½†æ˜¯å¯ä»¥ä½¿ç”¨<code>with</code>å…³é”®å­—å¤šé‡ç»§æ‰¿ï¼Œå¾ˆå¥½ç”¨çš„æ„Ÿè§‰å“¦</li>
<li><code>scala</code>æœ¬èº«è¿˜æ˜¯æœ‰<code>interface</code>å…³é”®å­—çš„ï¼Œæœ¬èº«ä¹Ÿå¯ä»¥ä½¿ç”¨<code>with</code>å…³é”®å­—æ¥å®ç°æ¥å£</li>
</ul>
<h3 id="case-class"><a class="header-anchor" href="#case-class"></a>case class</h3>
<ul>
<li><a href="https://blog.csdn.net/bluishglc/article/details/50914001" target="_blank" rel="noopener">csdnä¸Šçš„ä¸€ç¯‡æ–‡ç« </a></li>
<li>ç®€å•æ¥è¯´ï¼Œcase classä¼šé»˜è®¤ç”Ÿæˆå¾ˆå¤šä¸œè¥¿ï¼Œæ¯”å¦‚ä¼´ç”Ÿå¯¹è±¡ï¼Œæ¯”å¦‚å·¥å‚æ–¹æ³•ï¼Œæ¯”å¦‚toStringï¼Œ copyï¼Œæ„é€ æ–¹æ³•å‚æ•°åŒåçš„å±æ€§</li>
<li>æœ€å¼€å¿ƒçš„ç”¨æ³•ï¼Œåº”è¯¥å°±æ˜¯ä¸ç”¨<code>new</code>å‡ºä¸€ä¸ªå¯¹è±¡æ¥ã€‚è€Œæ˜¯å¯ä»¥ç›´æ¥<code>methodName(æ„é€ å‡½æ•°å‚æ•°)</code>è¿™æ ·æ¥è·å–ä¸€ä¸ªå¯¹è±¡ã€‚å…¶å®æ˜¯åŒåçš„å·¥å‚æ–¹æ³•</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/hexo_blog/2019/01/28/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/hexo_blog/2019/01/28/hello-world/" itemprop="url">Hello World</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-01-28T16:21:54+08:00">
                2019-01-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="quick-start"><a class="header-anchor" href="#quick-start"></a>Quick Start</h2>
<h3 id="create-a-new-post"><a class="header-anchor" href="#create-a-new-post"></a>Create a new post</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="run-server"><a class="header-anchor" href="#run-server"></a>Run server</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="generate-static-files"><a class="header-anchor" href="#generate-static-files"></a>Generate static files</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="deploy-to-remote-sites"><a class="header-anchor" href="#deploy-to-remote-sites"></a>Deploy to remote sites</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/hexo_blog/2019/01/21/Cassandraæ•°æ®ç»“æ„/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/hexo_blog/2019/01/21/Cassandraæ•°æ®ç»“æ„/" itemprop="url">Cassandraæ•°æ®ç»“æ„</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-01-21T15:35:56+08:00">
                2019-01-21
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/cassandra/" itemprop="url" rel="index">
                    <span itemprop="name">cassandra</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="cassandra-æ•°æ®ç»“æ„"><a class="header-anchor" href="#cassandra-æ•°æ®ç»“æ„"></a>Cassandra æ•°æ®ç»“æ„</h2>
<p>å¿…é¡»äº†è§£Cassandraçš„æ•°æ®ç»“æ„ã€‚æœ¬èº«å¹¶ä¸æ˜¯å¤šä¹ˆå¤æ‚ï¼Œè€Œä¸”æœ‰è¶³å¤Ÿå¤šçš„æ–‡æ¡£ï¼Œæ‰€ä»¥ç®€å•å†™ä¸€ä¸‹ã€‚</p>
<h3 id="keyspace"><a class="header-anchor" href="#keyspace"></a>KeySpace</h3>
<ul>
<li>å¥½åƒæ²¡å•¥éœ€è¦è§£é‡Šçš„ã€‚</li>
<li>åœ¨è®ºæ–‡é‡Œé¢çœ‹åˆ°è¯´namespaceçš„å¦ä¸€ä¸ªä½œç”¨æ˜¯å¯ä»¥åšæ•°æ®é‡å¤ã€‚</li>
</ul>
<h3 id="column"><a class="header-anchor" href="#column"></a>Column</h3>
<ul>
<li>Columnæ˜¯Cassandraä¸­æœ€å°çš„æ•°æ®å•å…ƒï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸‰å…ƒçš„æ•°æ®ç±»å‹ï¼ŒåŒ…å«name,value,timestamp.</li>
<li>nameæ˜¯å¿…é¡»çš„ï¼Œvalueä¸æ˜¯å¿…é¡»çš„ï¼Œtimestampç»å¸¸å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œå¦‚ä¸‹å›¾<br>
<img src="https://raw.githubusercontent.com/sallyslove/Pictures/master/Cassandra/cassandra_column.png" alt="å¼•ç”¨è‡ªç¬¬ä¸€ç¯‡å‚è€ƒé“¾æ¥"></li>
</ul>
<blockquote>
<p>å¼•ç”¨è‡ªcsdn</p>
</blockquote>
<h3 id="super-column"><a class="header-anchor" href="#super-column"></a>Super Column</h3>
<ul>
<li>å¯ä»¥å°†SuperColumnæƒ³è±¡æˆColumnçš„æ•°ç»„ï¼Œå®ƒåŒ…å«ä¸€ä¸ªnameä»¥åŠä¸€ç³»åˆ—Column.</li>
<li>SuperColumnæœ¬èº«ä¸åŒ…å«timestampå±æ€§ã€‚ä½¿ç”¨SuperColumnæœ‰ä¸€ä¸ªé™åˆ¶ï¼Œè¦è¯»å–å…¶ä¸­ä¸€ä¸ªå­åˆ—çš„å€¼ï¼Œå¿…é¡»æŠŠæ‰€æœ‰å­åˆ—éƒ½ååºåˆ—åŒ–ï¼Œä¸”ä¸èƒ½åœ¨å­åˆ—ä¸­å»ºç´¢å¼•<br>
<img src="https://raw.githubusercontent.com/sallyslove/Pictures/master/Cassandra/cassandra_super_column.png" alt></li>
</ul>
<blockquote>
<p>å¼•ç”¨è‡ªcsdn</p>
</blockquote>
<ul>
<li>
<p>å‚è€ƒé“¾æ¥é‡Œé¢æœ‰ä»¥ä¸‹çš„ä¾‹å­</p>
<pre><code> {   // è¿™æ˜¯ä¸€ä¸ªSuperColumn
     name: &quot;info&quot;,
     // åŒ…å«ä¸€ç³»åˆ—çš„Columns
     value: {
        street: {name: &quot;street&quot;, value: &quot;1234 x street&quot;, timestamp: 123456789},
        city: {name: &quot;city&quot;, value: &quot;san francisco&quot;, timestamp: 123456789},
        zip: {name: &quot;zip&quot;, value: &quot;94107&quot;, timestamp: 123456789},
  }
}
</code></pre>
</li>
</ul>
<h3 id="columnfamily"><a class="header-anchor" href="#columnfamily"></a>ColumnFamily</h3>
<ul>
<li>
<p><code>columnFamily</code>ç›¸å½“äºæ•°æ®åº“ä¸­çš„è¡¨</p>
</li>
<li>
<p>æ¯ä¸€è¡Œæœ‰ä¸€ä¸ª<code>row</code>çš„åå­—ï¼Œç„¶åæ¯ä¸€è¡Œé‡Œé¢æ˜¯ä¸€ä¸ªä¸ªçš„<code>column</code>ï¼Œä¹Ÿå¯ä»¥æ˜¯<code>super column</code></p>
</li>
<li>
<p><code>ColumnFamily</code>æ˜¯ä¸€ä¸ªåŒ…å«äº†è®¸å¤š<code>Row</code>çš„ç»“æ„ï¼Œæ¯ä¸€ä¸ª<code>Row</code>éƒ½åŒ…å«æœ‰clientæä¾›çš„Keyä»¥åŠå’Œè¯¥Keyå…³è”çš„ä¸€ç³»åˆ—Columnã€‚</p>
</li>
<li>
<p>æ¯ä¸€è¡Œé‡Œé¢çš„<code>column</code>çš„åå­—å¯ä»¥æ˜¯ä¸å˜çš„ã€‚ä¹Ÿå¯ä»¥æ˜¯å¯å˜çš„ã€‚é™æ€å’ŒåŠ¨æ€column</p>
</li>
<li>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ•°æ®å†™å…¥çš„æ—¶å€™å·²ç»ç»è¿‡æ’åºäº†ã€‚å°±æ˜¯è¯´ä¸€è¡Œçš„æ‰€æœ‰<code>column</code>ï¼Œä¼šæ ¹æ®å®ƒçš„åå­—æ¥è¿›è¡Œæ’åºã€‚</p>
</li>
<li>
<p>ç¬¬äºŒä¸ªå‚è€ƒé“¾æ¥é‡Œé¢çš„ä¾‹å­ï¼š</p>
</li>
</ul>
<pre><code>   UserProfile = { // è¿™æ˜¯ä¸€ä¸ªColumnFamily
        phatduckk: {   // è¿™æ˜¯å¯¹åº”ColumnFamilyçš„key
            // è¿™æ˜¯Keyä¸‹å¯¹åº”çš„Column
            username: &quot;gpcuster&quot;,
            email: &quot;gpcuster@gmail.com&quot;,
            phone: &quot;6666&quot;
        }, // ç¬¬ä¸€ä¸ªrowç»“æŸ
        ieure: {   // è¿™æ˜¯ColumnFamilyçš„å¦ä¸€ä¸ªkey
          //è¿™æ˜¯å¦ä¸€ä¸ªKeyå¯¹åº”çš„column
          username: &quot;pengguo&quot;,
          email: &quot;pengguo@live.com&quot;,
          phone: &quot;888&quot;
        }
</code></pre>
<p><img src="https://raw.githubusercontent.com/sallyslove/Pictures/master/Cassandra/cassandra_column_family.png" alt></p>
<blockquote>
<p>å¼•ç”¨è‡ªç¬¬ä¸€ç¯‡å‚è€ƒé“¾æ¥æ–‡æ¡£</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/sallyslove/Pictures/master/Cassandra/cassandra_storage_picture.png" alt></p>
<blockquote>
<p>å¼•ç”¨è‡ªç¬¬äºŒç¯‡å‚è€ƒé“¾æ¥æ–‡æ¡£</p>
</blockquote>
<h3 id="å¯¹åº”åˆ°è¡¨çš„å®šä¹‰é‡Œé¢"><a class="header-anchor" href="#å¯¹åº”åˆ°è¡¨çš„å®šä¹‰é‡Œé¢"></a>å¯¹åº”åˆ°è¡¨çš„å®šä¹‰é‡Œé¢</h3>
<p>ç›®å‰å¯¹äºè¡¨ç»“æ„çš„ç†è§£æ˜¯è¿™æ ·çš„ï¼Œå¯èƒ½åé¢æœ‰æ›´æ­£ï¼š</p>
<ul>
<li>å¦‚æœç”¨<code>desc tables</code>å»æŸ¥çœ‹ä¸€å¼ è¡¨ã€‚é‚£ä¹ˆå¯ä»¥çœ‹åˆ°primaryKeyå­—æ ·ï¼Œç±»ä¼¼<code>PRIMARY KEY ()</code>ï¼Œè¿˜æœ‰<code>CLUSTERING ORDER</code> å­—æ ·</li>
<li><strong><em>é‚£ä¹ˆè¿™ä¸ªprimary keyå°±æ˜¯å¯¹åº”æ•°æ®æ¨¡å‹é‡Œé¢çš„rowçš„åå­—ã€‚ä¹Ÿå°±æ˜¯super columnçš„åå­—ã€‚åªä¸è¿‡è¿™ä¸ªåå­—æ˜¯å‡ ä¸ªprimaryKeyè”åˆèµ·æ¥ç»„æˆçš„ã€‚ï¼Ÿ</em></strong></li>
<li><code>primaryKey</code>å¯ä»¥ç”¨æ¥æŸ¥è¯¢æ•°æ®ã€‚<code>primary key</code>åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†<code>partition key</code>å’Œ<code>clustering key</code>ï¼Œ å‰è€…ç»„åˆèµ·æ¥å†³å®šä¸€ä¸ªæ•°æ®çš„å­˜å‚¨åœ¨å“ªä¸ª<code>node</code>ä¸Šé¢, åè€…ä¼šç”¨æ¥æ’åºã€‚è€Œ <code>CLUSTERING ORDER</code>å†³å®šæ’åºæ—¶å€™ä½¿ç”¨çš„å‚æ•°çš„é¡ºåº</li>
<li>æŸ¥è¯¢æ˜¯æ—¶å€™å¿…é¡»ç»™å‡ºæ‰€æœ‰çš„<code>partition key</code>ï¼Œä¹‹å‰æœ‰è¿‡<code>ALLOW FILTERING</code>çš„å­—æ®µæ¥å®¹å¿ç¼ºå¤±<code>partition key</code>ï¼Œç°åœ¨æ²¡æœ‰è¿™ä¸ªåŠŸèƒ½äº†ã€‚</li>
</ul>
<p>å¦‚ä¸‹ï¼š</p>
<pre><code>PRIMARY KEY ((race_year, race_name), rank)
</code></pre>
<p>è¿™é‡Œçš„<code>race_year</code>å’Œ<code>race_name</code>å°±æ˜¯ç»„åˆçš„<code>partition key</code>,è€Œ<code>rank</code>å°±æ˜¯<code>a clustering column</code>ï¼Œç”¨æ¥æ’åºçš„</p>
<ul>
<li>ä¹Ÿå¯èƒ½çœ‹åˆ°<code>CLUSTERING ORDER BY</code>çš„å­—æ ·é‡Œé¢ï¼Œæœ‰<code>ASC</code>ï¼Œä»£è¡¨å‡åºæ’åºï¼Œå¯ä»¥æŒ‡å®šä¸º<code>DESC</code>é™åºæ’åº</li>
<li>åœ¨3.0çš„ç‰ˆæœ¬ä¹‹å‰ï¼Œè¿˜å¯èƒ½çœ‹åˆ°<code>COMPACT STORAGE</code>ï¼Œç°åœ¨å·²ç»æ²¡æœ‰å•¦ï¼Œæ‰€ä»¥ä¹Ÿå°±ä¸å†™äº†ã€‚</li>
</ul>
<h3 id="data-moduling"><a class="header-anchor" href="#data-moduling"></a>data moduling</h3>
<ul>
<li>æœ€è¿‘çœ‹äº†ä¸€äº›å…³äºå»ºæ¨¡çš„æ–‡ç« ã€‚æ–‡ç« é‡Œé¢ä¸€äº›åå¤å¼ºè°ƒçš„äº‹å¦‚ä¸‹ï¼š
<ul>
<li><code>cassandra</code>ä¸åŒäºå…¶ä»–æ•°æ®åº“çš„æ˜¯ï¼Œå®ƒå†™çš„æˆæœ¬ä½ï¼Œè¯»çš„æˆæœ¬é«˜ã€‚</li>
<li>åŸºäºè¿™ä¸€ç‚¹ï¼Œå¿…é¡»åœ¨ä¸€å¼€å§‹å…ˆè€ƒè™‘<code>query</code>çš„éœ€æ±‚ï¼Œç„¶åæ•°æ®å¯ä»¥<code>duplicated</code>ã€‚è€Œåœ¨å…³ç³»æ•°æ®åº“å»ºæ¨¡æ—¶å€™ï¼Œå®Œå…¨æ˜¯ä¸ä¸€æ ·çš„ã€‚</li>
<li>åŸºäº<code>cassandra</code>çš„å†™å’Œå­˜å‚¨çš„æ–¹å¼ï¼Œéœ€è¦è¯»å–çš„æ•°æ®åº”è¯¥æ”¾åœ¨åŒä¸€ä¸ª<code>partition</code>é‡Œé¢ã€‚</li>
<li>æ–‡ç« é‡Œé¢çš„è¿™å¥è¯è¯´æ˜äº†<code>partition</code>çš„å®šä¹‰å’Œé‡è¦æ€§ï¼š</li>
</ul>
<blockquote>
<p>a set of rows that share a partition key is called a partition<br>
Cassandra is a partitioned row store with tunable consistency.<br>
You perform several optimizations in the physical data modeling stage, including the specifying of partition sizes and ordering.</p>
</blockquote>
</li>
</ul>
<h3 id="å‚è€ƒæ–‡æ¡£"><a class="header-anchor" href="#å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h3>
<ul>
<li><a href="https://blog.csdn.net/aesop_wubo/article/details/20289837" target="_blank" rel="noopener">æ•°æ®æ¨¡å‹</a></li>
<li><a href="http://www.cnblogs.com/gpcuster/archive/2010/03/12/1684072.html" target="_blank" rel="noopener">å¤§è¯Cassandraæ•°æ®æ¨¡å‹</a></li>
<li><a href="https://stackoverflow.com/questions/24949676/difference-between-partition-key-composite-key-and-clustering-key-in-cassandra" target="_blank" rel="noopener">primary key partition key and clustering key</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/hexo_blog/2019/01/21/Cassandraè¯»æ•°æ®è¿‡ç¨‹/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/hexo_blog/2019/01/21/Cassandraè¯»æ•°æ®è¿‡ç¨‹/" itemprop="url">Cassandraè¯»æ•°æ®è¿‡ç¨‹</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-01-21T15:35:32+08:00">
                2019-01-21
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/cassandra/" itemprop="url" rel="index">
                    <span itemprop="name">cassandra</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="cassandraè¯»æ•°æ®è¿‡ç¨‹"><a class="header-anchor" href="#cassandraè¯»æ•°æ®è¿‡ç¨‹"></a>Cassandraè¯»æ•°æ®è¿‡ç¨‹</h2>
<p>æ•°æ®åº“è¯»æ•°æ®è¿‡ç¨‹å¿…é¡»çŸ¥é“ã€‚</p>
<h3 id="å¤§è‡´çš„è¯»æµç¨‹"><a class="header-anchor" href="#å¤§è‡´çš„è¯»æµç¨‹"></a>å¤§è‡´çš„è¯»æµç¨‹</h3>
<p><img src="https://docs.datastax.com/en/archived/cassandra/3.0/cassandra/images/dml_caching-reads_12.png" alt="å®˜æ–¹è¯»æµç¨‹å›¾ç‰‡"></p>
<blockquote>
<p>å®˜æ–¹è¯»æµç¨‹å›¾ç‰‡</p>
</blockquote>
<ul>
<li>
<p>Check the memtable</p>
</li>
<li>
<p>Check row cache, if enabled</p>
</li>
<li>
<p>Checks Bloom filter</p>
</li>
<li>
<p>Checks partition key cache, if enabled</p>
</li>
<li>
<p>Goes directly to the compression offset map if a partition key is found in the partition key cache, or checks the partition summary if not<br>
If the partition summary is checked, then the partition index is accessed</p>
</li>
<li>
<p>Locates the data on disk using the compression offset map</p>
</li>
<li>
<p>Fetches the data from the SSTable on disk</p>
</li>
<li>
<p>åœ¨å­˜è´®æ•°æ®çš„æ—¶å€™ï¼Œ<code>Cassandra</code>ä¼šè®²åŒæ ·çš„æ•°æ®å­˜å‚¨å¾ˆå¤šä»½ï¼Œè¿™ä¸ªåœ¨å†™çš„æ—¶å€™å·²ç»æåŠè¿‡ã€‚</p>
</li>
<li>
<p>åœ¨è¯»çš„æ—¶å€™è¯»å‡ ä¸ªèŠ‚ç‚¹åŒæ ·æ˜¯ç”±å¤åˆ¶å› å­å’Œ<code>consistency level</code>ç­–ç•¥å†³å®šçš„ã€‚ä¹Ÿå°±æ˜¯è¯´å†™å‡ ä¸ªï¼Œè¯»å‡ ä¸ªã€‚</p>
</li>
</ul>
<h3 id="caches"><a class="header-anchor" href="#caches"></a>Caches</h3>
<p>è¿™ç¯‡ä¹Ÿä½œä¸º<code>KeyCache</code>å’Œ<code>RowCache</code>å­¦ä¹ çš„blog.<br>
<code>RowCache</code>ç¼“å­˜çš„æ˜¯æ•°æ®ï¼Œè€Œ<code>KeyCache</code>ç¼“å­˜çš„æ˜¯åœ¨<code>SSTable</code>æ–‡ä»¶ä¸­çš„ä½ç½®ã€‚<br>
<code>Cassandra</code>è¯»æ•°æ®æ…¢ï¼Œå†™æ•°æ®å¿«ã€‚</p>
<p>ä»¥ä¸‹å‡ ç§<code>cache</code>éƒ½æ˜¯é’ˆå¯¹<code>SSTable</code>æ¥è¯´çš„</p>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<ul>
<li><a href="https://stackoverflow.com/questions/25079311/difference-between-cassandra-row-caching-and-partition-key-caching" target="_blank" rel="noopener">row cache å’Œ key cache</a></li>
</ul>
<h4 id="keycache"><a class="header-anchor" href="#keycache"></a>keyCache</h4>
<ul>
<li>key cacheï¼šstores a map of partition keys to row index entriesã€‚stores a cache of the partition index in off-heap memory</li>
<li><em>partition key cache, caches the partition index for an SSTable</em></li>
<li>ä¹Ÿåœ¨<code>off-heap</code>é‡Œé¢</li>
<li><code>key_cache_size_in_mb</code>ï¼š <em>set the maximum size of the key cache for all tables in a database.</em></li>
</ul>
<p><img src="%5Chexo_blog%5Cimages%5Cpasted-4.png" alt="upload successful"></p>
<h4 id="rowcache"><a class="header-anchor" href="#rowcache"></a>rowCache</h4>
<ul>
<li><em>caches frequently accessed rows to speed up access to those rows.</em></li>
<li>ä¸æ˜¯é»˜è®¤å¼€çš„ï¼Œ<em>In Cassandra 2.2 and later, it is stored in fully off-heap memory using a new implementation that relieves garbage collection pressure in the JVM.</em> åœ¨2.2ä¹‹åï¼Œä¼šå°†è¿™äº›è¡Œå­˜è¿›éæ ˆçš„å†…å­˜é‡Œé¢ï¼Œä½¿å¾—ç³»ç»Ÿä¸éœ€è¦è¿›è¡Œ<code>GC</code></li>
<li>å½“å­˜åœ¨å†…å­˜ä¸­çš„è¡Œè¢«æ›´æ–°ä¹‹åï¼Œè¿™ä¸€è¡Œä¼šè¢«åˆ é™¤ï¼Œç›´åˆ°å†æ¬¡è¯»å–</li>
<li>åŒæ ·ï¼Œå½“ä¸€ä¸ª<code>partition</code>è¢«æ›´æ–°äº†ï¼Œè¿™ä¸ª<code>partition</code>ä¼šè¢«ä»å†…å­˜é‡Œé¢åˆ é™¤</li>
<li>å‚æ•°ï¼š
<ul>
<li><code>rows_per_partition</code>ï¼š<em>set the number of rows the database must cache in a partition.This attribute has three values: ALL, NONE, and N.</em></li>
</ul>
</li>
</ul>
<h4 id="counter-cache"><a class="header-anchor" href="#counter-cache"></a>counter cache</h4>
<ul>
<li>A counter cache improves performance for the counters that youâ€™ll need to access frequently. å¥½åƒæ²¡æ€ä¹ˆå¬è¯´è¿‡counterçš„æ¦‚å¿µã€‚è¿™ä¸ªcacheä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡çœ‹åˆ°æœ‰ã€‚</li>
</ul>
<h4 id="bloom-filters"><a class="header-anchor" href="#bloom-filters"></a>bloom filters</h4>
<ul>
<li><code>Bloom Filters</code> å°±æ˜¯åœ¨å†™<code>ssTable</code>æ—¶å€™åŒæ—¶å†™çš„<code>filter.db</code>æ–‡ä»¶ã€‚ä½†æ˜¯å®é™…æ˜¯è¯»çš„æ—¶å€™ç”¨çš„ä¸€ä¸ªæœºåˆ¶</li>
<li>è¯»çš„æ—¶å€™ä¼šç”¨è¿™ä¸ªæœºåˆ¶æ¥çœ‹ä¸€ä¸ªæ•°æ®keyæ˜¯ä¸æ˜¯åœ¨æŸä¸ª<code>SSTable</code>é‡Œé¢ã€‚å½“filterè¡¨ç¤ºä¸åœ¨ï¼Œè‚¯å®šæ˜¯ä¸åœ¨ï¼›ä½†æ˜¯è¯´åœ¨ï¼Œå¯èƒ½ä¸åœ¨ã€‚å°±æ˜¯è¯´å¯èƒ½å‡ç»¿çš„ã€‚ä¹Ÿä¼šç»™å‡ºä¸€ä¸ªæ¦‚ç‡å€¼ï¼ŒæŸä¸ª<code>partition</code>åœ¨ä¸åœ¨è¿™ä¸ª<code>SSTable</code>é‡Œé¢</li>
<li>å‡ç»¿çš„æ¦‚ç‡æ˜¯ä¸‡åˆ†ä¹‹ä¸€</li>
<li>å¯ä»¥é…ç½®<code>bloom_filter_fp_chance</code>æ¥é™ä½å‡ç»¿ï¼Œä½†æ˜¯ä¼šå æ›´å¤šå†…å­˜</li>
<li><code>Bloom Filters</code> ä¹Ÿæ˜¯å­˜å‚¨åœ¨<code>off-heap</code> memoryé‡Œé¢çš„ã€‚å¹¶ä¸”æ˜¯æ¯å¼ <code>SSTable</code>éƒ½æœ‰ä¸€ä¸ªçš„</li>
<li><em>A Bloom filter can establish that a SSTable does not contain certain partition data.</em></li>
<li>å‚è€ƒé“¾æ¥ï¼š
<ul>
<li><a href="https://blog.csdn.net/u010900754/article/details/78307808" target="_blank" rel="noopener">bloom è¿‡æ»¤å™¨</a></li>
<li><a href="https://blog.csdn.net/jiaomeng/article/details/1495500" target="_blank" rel="noopener">ç®—æ³•åŸç†</a></li>
<li><a href="https://blog.csdn.net/nangongyanya/article/details/54089568" target="_blank" rel="noopener">Cassandra Bloom è¿‡æ»¤å™¨</a></li>
</ul>
</li>
</ul>
<h4 id="index-files"><a class="header-anchor" href="#index-files"></a>Index Files</h4>
<h3 id="gossip-protocal"><a class="header-anchor" href="#gossip-protocal"></a>Gossip Protocal</h3>
<h3 id="limit"><a class="header-anchor" href="#limit"></a>Limit</h3>
<ul>
<li>Cassandraæ ¹æ®primary keyæ¥è¯»å–æ•°æ®ï¼Œè¿™ä¸ªkeyå°±æ˜¯å­˜åœ¨keyCacheé‡Œé¢çš„å†…å®¹ã€‚ç„¶åä¼šè¯»å–ä¸€ç‰‡æ•°æ®ã€‚</li>
<li>è¯»å–æ—¶å€™å¯ä»¥æŒ‡å®šlimitå€¼ï¼Œè¿™æ ·ä¼šè¯»å–æœ‰é™çš„å†…å®¹ï¼Œè€Œä¸æ˜¯ä¸€å¤§ç‰‡ã€‚</li>
</ul>
<h3 id="å‚è€ƒæ–‡æ¡£"><a class="header-anchor" href="#å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h3>
<ul>
<li>éå¸¸è¯¦å°½æ¸…æ™°çš„ä¸€ç¯‡æ–‡æ¡£ï¼š<a href="https://www.oschina.net/question/12_11855" target="_blank" rel="noopener">Cassandraæ•°æ®ç»“æ„å’Œå†™å…¥è¯»å–</a></li>
<li><a href="https://docs.datastax.com/en/archived/cassandra/3.0/cassandra/dml/dmlAboutReads.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£è¯»æµç¨‹</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/hexo_blog/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/hexo_blog/">1</a><a class="page-number" href="/hexo_blog/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/hexo_blog/page/4/">4</a><a class="extend next" rel="next" href="/hexo_blog/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Lynn Shen</p>
              <p class="site-description motion-element" itemprop="description">35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/hexo_blog/archives/">
              
                  <span class="site-state-item-count">36</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/hexo_blog/categories/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">åˆ†ç±»</span>
                </a>
              </div>
            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Lynn Shen</span>

  
</div>


  <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/hexo_blog/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/hexo_blog/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/hexo_blog/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/hexo_blog/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/hexo_blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/hexo_blog/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/hexo_blog/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/hexo_blog/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/hexo_blog/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/hexo_blog/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/hexo_blog/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  







<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://billts.site/extra_css/gitment.css">
        <script src="https://billts.site/js/gitment.js"></script>
    
<!-- END LOCAL -->

    

    







  





  

  

  

  
  

  

  

  

</body>
</html>
