<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/hexo_blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/hexo_blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/hexo_blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/hexo_blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/hexo_blog/css/main.css">


<link rel="stylesheet" href="/hexo_blog/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"sallyslove.github.io","root":"/hexo_blog/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦">
<meta property="og:type" content="website">
<meta property="og:title" content="è·¬æ­¥">
<meta property="og:url" content="https://sallyslove.github.io/hexo_blog/page/4/index.html">
<meta property="og:site_name" content="è·¬æ­¥">
<meta property="og:description" content="35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Lynn Shen">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://sallyslove.github.io/hexo_blog/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>è·¬æ­¥</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/hexo_blog/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">è·¬æ­¥</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">ä¸ç§¯è·¬æ­¥ï¼Œæ— ä»¥è‡³åƒé‡Œ</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/hexo_blog/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/hexo_blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/2019/02/15/%E5%B8%B8%E7%94%A8k8s%E5%91%BD%E4%BB%A4%E8%AE%B0%E5%BD%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content="35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/hexo_blog/2019/02/15/%E5%B8%B8%E7%94%A8k8s%E5%91%BD%E4%BB%A4%E8%AE%B0%E5%BD%95/" class="post-title-link" itemprop="url">å¸¸ç”¨k8så‘½ä»¤è®°å½•</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-02-15 14:15:01" itemprop="dateCreated datePublished" datetime="2019-02-15T14:15:01+08:00">2019-02-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-11-05 11:27:22" itemprop="dateModified" datetime="2020-11-05T11:27:22+08:00">2020-11-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/docker/" itemprop="url" rel="index"><span itemprop="name">docker</span></a>
                </span>
            </span>

          
            <span id="/hexo_blog/2019/02/15/%E5%B8%B8%E7%94%A8k8s%E5%91%BD%E4%BB%A4%E8%AE%B0%E5%BD%95/" class="post-meta-item leancloud_visitors" data-flag-title="å¸¸ç”¨k8så‘½ä»¤è®°å½•" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="å¸¸ç”¨k8så‘½ä»¤"><a class="header-anchor" href="#å¸¸ç”¨k8så‘½ä»¤"></a>å¸¸ç”¨k8så‘½ä»¤</h2>
<p>è¿™ç¯‡è®°å½•ä¸€ä¸‹å¸¸ç”¨çš„<code>k8s</code>å‘½ä»¤ï¼Œæˆ‘æ€•æˆ‘ä¼šå¿˜å•Š  -_-#<br>
æ²¡é”™ï¼Œè¿™æ˜¯<code>docker</code>é‚£ç¯‡çš„å§å¦¹ç¯‡å“¦ã€‚æ£’æ£’å“’</p>
<h3 id="é›†ç¾¤å‘½ä»¤"><a class="header-anchor" href="#é›†ç¾¤å‘½ä»¤"></a>é›†ç¾¤å‘½ä»¤</h3>
<ul>
<li><code>kubectl cluster-info</code></li>
</ul>
<h3 id="æŸ¥è¯¢å‘½ä»¤"><a class="header-anchor" href="#æŸ¥è¯¢å‘½ä»¤"></a>æŸ¥è¯¢å‘½ä»¤</h3>
<ul>
<li>
<p><code>kubectl get nodes</code>ï¼šç”¨ä¸‹é¢è¿™æ¡å‘½ä»¤å¯ä»¥æ‰“å‡º<code>node</code>çš„å…·ä½“ä¿¡æ¯</p>
<pre><code>kubectl get nodes -o wide
</code></pre>
</li>
<li>
<p><code>kubectl get pods</code>ï¼š <code>get pods</code>çš„è¯ï¼Œä¼šæŠŠ<code>replication cotronller</code>ï¼Œ <code>service</code>ï¼Œ <code>deployment</code>éƒ½ç»™æ‰“å°å‡ºæ¥</p>
</li>
<li>
<p><code>kubectl get rc</code>: <code>replication controller</code>æ‰“å°å‡ºæ¥ã€‚</p>
</li>
</ul>
<pre><code>$ kubectl get pods
NAME     READY     STATUS    RESTARTS   AGE
http-7b77c4cd66-74zqx          1/1       Running   0          4s
http-7b77c4cd66-fhlmx          1/1       Running   0          19m
http-7b77c4cd66-xrbpf          1/1       Running   0          4s
httpexposed-5c4cf8b7d8-qprzc   1/1       Running   0          11m

$ kubectl get deployments
NAME DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
http          3         3         3            3           19m
httpexposed   1         1         1            1           11m
</code></pre>
<ul>
<li><code>kubectl describe deployment http</code></li>
<li><code>kubectl describe svc http</code> èƒ½çœ‹åˆ°å¾ˆå¤šä¿¡æ¯ï¼ŒåŒ…æ‹¬æ•´ä¸ªclusterå¯¹å¤–çš„ipï¼Œå„ä¸ªnodeçš„å†…éƒ¨ipä¹‹ç±»</li>
<li><code>kubectl get ing</code> å¯ä»¥ç”¨æ¥çœ‹Ingress</li>
<li><code>kubectl config set-context $(kubectl config current-context) --namespace=&lt;insert-namespace-name-here&gt;</code></li>
<li><code>kubectl config get-contexts</code></li>
<li><code>kubectl get namespaces</code></li>
</ul>
<h3 id="åˆ›å»ºç±»å‘½ä»¤"><a class="header-anchor" href="#åˆ›å»ºç±»å‘½ä»¤"></a>åˆ›å»ºç±»å‘½ä»¤</h3>
<ul>
<li>
<p><code>kubectl run first-deployment --image=katacoda/docker-http-server --port=80</code></p>
<ul>
<li><code>-port</code>ä»æ—§æ˜¯å†…éƒ¨çš„ç«¯å£</li>
<li>å¤–éƒ¨ç«¯å£å¯ä»¥ç”¨<code>--hostport=8001</code>æŒ‡å®šï¼Œ ä½†æ˜¯è¿™æ ·åšçš„è¯ï¼Œ â€”<em>Under the covers, this exposes the Pod via Docker Port Mapping.</em> As a result, you will not see the service listed using <code>kubectl get svc</code>ã€‚ç›®å‰çš„ç†è§£æ˜¯ï¼Œå› ä¸ºæ˜¯ç”¨çš„<code>docker</code>çš„æ–¹æ³•ï¼Œæ‰€ä»¥<code>k8s</code>ä¸çŸ¥é“
<ul>
<li>ç”¨<code>docker ps</code>å‘½ä»¤èƒ½çœ‹åˆ°è¿™ä¸ª<code>container</code>ï¼Œç„¶åå¯ä»¥æ³¨æ„åˆ°æœ‰ä¸¤ä¸ª<code>ps</code>è¿›ç¨‹ã€‚å…¶ä¸­ä¸€ä¸ªæ˜¯<code>paused</code>çŠ¶æ€ï¼Œç„¶åæˆ‘ä»¬çš„ç«¯å£<code>8001</code>å…¶å®å¼€åœ¨è¿™ä¸ª<code>paused</code>çš„<code>ps</code>ä¸Šé¢ã€‚</li>
<li><em>The ports are exposed on the Pod, not the http container itself. The Pause container is responsible for defining the network for the Pod. Other containers in the pod share the same network namespace. This improves network performance and allow multiple containers to communicate over the same network interface.</em> æ„Ÿè§‰è¿™æ®µè§£é‡Šå¾ˆå…³é”®å•Šã€‚è¿™ä¸ªcontainerçš„åå­—æ˜¯ï¼š k8s_POD_â€œhttpexposedâ€,æœ€åä¸€ä¸ªå­—æ®µæ˜¯æˆ‘ä»¬èµ·çš„podçš„åå­—</li>
</ul>
</li>
<li><code>--replicas</code>ï¼š å¤åˆ¶å› å­</li>
</ul>
</li>
<li>
<p><code>kubectl scale --replicas=3 deployment http</code> scaleçš„å‘½ä»¤</p>
</li>
<li>
<p><code>kubectl create -f deployment.yaml</code> é€šè¿‡yamlæ–‡ä»¶åˆ›å»ºä¸€ä¸ªdeployment</p>
</li>
<li>
<p><code>kubectl create -f service.yaml</code> ä¹Ÿå¯ä»¥é€šè¿‡<code>yaml</code>æ–‡ä»¶åˆ›å»º<code>service</code></p>
<ul>
<li><code>ymal</code>æ–‡ä»¶é‡Œé¢çš„å†…å®¹è¿˜ä¸æ˜¯éå¸¸æ¸…æ¥šã€‚å‚è€ƒ<a href="https://blog.csdn.net/luanpeng825485697/article/details/83753260" target="_blank" rel="noopener">k8s yamlæ–‡ä»¶è¯¦è§£</a></li>
</ul>
</li>
<li>
<p><code>kubectl apply -f deployment.yaml</code>å¦‚æœ<code>yaml</code>æ–‡ä»¶æœ‰æ”¹åŠ¨çš„è¯ï¼Œå¯ä»¥ç”¨è¿™æ¡å‘½ä»¤æ¥update</p>
</li>
</ul>
<pre><code> $ kubectl apply -f deployment.yaml
  Warning: kubectl apply should be used on resource created by either kubectl create --save-config or kubectl apply
  deployment.extensions/webapp1 configured
</code></pre>
<ul>
<li>
<p><code>kubectl exec $pod -- /usr/bin/curl -s localhost/unhealthy</code></p>
</li>
<li>
<p><code>kubectl create namespace</code>åˆ›å»ºnamespace</p>
</li>
<li>
<p><code>kubectl delete pvc --all --namespace default</code> ç”¨è¿™ä¸ªå‘½ä»¤æ¥åš<code>delete</code>ã€‚ä¸€å †éƒ½è¡Œã€‚<code>pvc</code>æ¢æˆ<code>pod</code>ï¼Œ<code>deployments</code>ï¼Œ<code>secret</code>ï¼Œ<code>configmap</code>ï¼Œ<code>service</code>å•¥çš„</p>
</li>
</ul>
<h3 id="å·¥ä½œä¸­å¸¸ç”¨å®ç”¨å‘½ä»¤"><a class="header-anchor" href="#å·¥ä½œä¸­å¸¸ç”¨å®ç”¨å‘½ä»¤"></a>å·¥ä½œä¸­å¸¸ç”¨å®ç”¨å‘½ä»¤</h3>
<h4 id="ç«¯å£æ˜ å°„"><a class="header-anchor" href="#ç«¯å£æ˜ å°„"></a>ç«¯å£æ˜ å°„</h4>
<ul>
<li><code>kubectl port-forward</code>
<ul>
<li>
<p>Forward one or more local ports to a pod. This command requires the node to have â€˜socatâ€™ installed. <strong><em>socatæ˜¯ä»€ä¹ˆ?</em></strong></p>
</li>
<li>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<ul>
<li><a href="https://imti.co/kubernetes-port-forwarding/" target="_blank" rel="noopener">Kubernetes Port Forwarding for Local Development</a></li>
<li><a href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#port-forward" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></li>
</ul>
</li>
<li>
<p>ç”¨ä¾‹ï¼š</p>
<ul>
<li>ä»¥ä¸‹å‘½ä»¤çš„å«ä¹‰æ˜¯ï¼šå°†æœ¬åœ°ç«¯å£<code>8080</code>å’Œ<code>8081</code>ï¼Œæ˜ å°„åˆ°<code>k8s</code>æœåŠ¡<code>ok</code>çš„<code>8080</code>å’Œ<code>80</code>ç«¯å£ä¸Šé¢ã€‚<code>-n</code>ä»£è¡¨çš„<code>namespace</code></li>
<li>é»˜è®¤åœ°å€æ˜¯<code>localhost</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code>  kubectl port-forward service/ok 8080:8080 8081:80 -n the-project
</code></pre>
<h4 id="ä¸´æ—¶ç¼–è¾‘èµ„æº"><a class="header-anchor" href="#ä¸´æ—¶ç¼–è¾‘èµ„æº"></a>ä¸´æ—¶ç¼–è¾‘èµ„æº</h4>
<ul>
<li><code>kubectl edit</code> å‘½ä»¤å¯ä»¥ç”¨æ¥ä¿®æ”¹ä¸€ä¸ªèµ„æºã€‚<code>kubectl edit deployment &lt;resource_name&gt; -n &lt;namespace&gt;</code>,éœ€è¦æ³¨æ„çš„æ˜¯ä¿®æ”¹æ˜¯æš‚æ—¶çš„ï¼Œå¦‚æœä½¿ç”¨<code>helm upgrade</code>å‘½ä»¤ï¼Œé‚£ä¹ˆä¿®æ”¹ä¼šè¢«è¦†ç›–æ‰
<ul>
<li>å‚è€ƒé“¾æ¥ï¼š <a href="https://stackoverflow.com/questions/45502729/how-do-i-edit-a-resource-configuration-with-kubectl" target="_blank" rel="noopener">kubectl edit</a></li>
</ul>
</li>
</ul>
<h3 id="å‚è€ƒæ–‡æ¡£"><a class="header-anchor" href="#å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h3>
<ul>
<li><a href="http://docs.kubernetes.org.cn/475.html" target="_blank" rel="noopener">k8sä¸­æ–‡æ–‡æ¡£</a></li>
<li><a href="https://www.katacoda.com/courses/kubernetes/kubectl-run-containers" target="_blank" rel="noopener">codekaraçš„åœ¨çº¿è¯¾ç¨‹</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/2019/02/14/%E5%B8%B8%E7%94%A8Docker%E5%91%BD%E4%BB%A4%E8%AE%B0%E5%BD%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content="35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/hexo_blog/2019/02/14/%E5%B8%B8%E7%94%A8Docker%E5%91%BD%E4%BB%A4%E8%AE%B0%E5%BD%95/" class="post-title-link" itemprop="url">Docker</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-02-14 15:16:01" itemprop="dateCreated datePublished" datetime="2019-02-14T15:16:01+08:00">2019-02-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-10-30 15:24:31" itemprop="dateModified" datetime="2020-10-30T15:24:31+08:00">2020-10-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/docker/" itemprop="url" rel="index"><span itemprop="name">docker</span></a>
                </span>
            </span>

          
            <span id="/hexo_blog/2019/02/14/%E5%B8%B8%E7%94%A8Docker%E5%91%BD%E4%BB%A4%E8%AE%B0%E5%BD%95/" class="post-meta-item leancloud_visitors" data-flag-title="Docker" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><code>Docker</code>ç›¸å…³çš„ä¿¡æ¯éƒ½è®°å½•åœ¨è¿™é‡Œ</p>
<h2 id="å‚è€ƒé“¾æ¥"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2>
<ul>
<li><a href="https://www.jianshu.com/p/f0a0f6a43907" target="_blank" rel="noopener">Dockerfile RUNï¼ŒCMDï¼ŒENTRYPOINTå‘½ä»¤åŒºåˆ«</a></li>
</ul>
<h2 id="å¸¸ç”¨dockerå‘½ä»¤"><a class="header-anchor" href="#å¸¸ç”¨dockerå‘½ä»¤"></a>å¸¸ç”¨dockerå‘½ä»¤</h2>
<p>è¿™ç¯‡è®°å½•ä¸€ä¸‹ <code>Docker</code> ç›¸å…³çš„çŸ¥è¯†ï¼Œæˆ‘æ€•æˆ‘ä¼šå¿˜å•Š ğŸ˜…</p>
<ul>
<li><code>docker run -d / -it / -v / -p /--name/-l</code>
<ul>
<li><code>-d</code>: background; <code>-v</code>: ç£ç›˜æ˜ å°„ ï¼›<code>-p</code>ï¼šç«¯å£æ˜ å°„; <code>-l</code>: label</li>
</ul>
</li>
<li><code>docker build -t ï¼ˆbuild-directoryï¼‰ dockerfile</code> build docker image
<ul>
<li><code>-t</code> æŒ‡å®šç¼–è¯‘å‡ºæ¥çš„imageçš„åå­—ã€‚å¯ä»¥å¸¦ä¸Šç‰ˆæœ¬ã€‚æ¯”å¦‚ï¼šfirstImage:v1</li>
<li><code>-f</code> æŒ‡å®šdockerfileçš„åå­—</li>
</ul>
</li>
<li><code>docker inspect</code>çœ‹ä¸€ä¸ªimageçš„ä¿¡æ¯æˆ–è€…containerçš„ä¿¡æ¯
<ul>
<li>docker inspect -f â€œâ€ katacoda-label-example</li>
<li>These labels will remain even if the image has been untagged. When an image is untagged, it will have the name <none></li>
</ul>
</li>
<li><code>docker exec</code></li>
</ul>
<h2 id="dockerçš„æ¦‚å¿µ"><a class="header-anchor" href="#dockerçš„æ¦‚å¿µ"></a>Dockerçš„æ¦‚å¿µ</h2>
<ul>
<li><code>Label</code>å°±æ˜¯ä¸­æ–‡å«ä¹‰ä¸€æ ·çš„æ ‡ç­¾ï¼Œ<code>key-value</code>çš„å½¢å¼ï¼Œæ¯”å¦‚user=lynnï¼Œè¿™æ ·å­ã€‚é™¤äº†userï¼Œè¿˜ä¼šæœ‰versionå•Š
<ul>
<li>LABEL vendor=Katacoda \ com.katacoda.version=0.0.5 \ com.katacoda.build-date=2016-07-01T10:47:29Z \ com.katacoda.course=Docker</li>
<li>container, image, demonéƒ½å¯ä»¥æœ‰labelï¼Œåœ¨æŸ¥çœ‹æ—¶å€™éƒ½å¯ä»¥ç”¨ä¸Š</li>
</ul>
</li>
<li>å‚è€ƒé“¾æ¥ï¼š<a href="https://www.katacoda.com/courses/docker/2" target="_blank" rel="noopener">karacoda dockeråœ¨çº¿è¯¾ç¨‹</a></li>
</ul>
<h2 id="dockerfile"><a class="header-anchor" href="#dockerfile"></a>Dockerfile</h2>
<ul>
<li>è¿™å‡ å¤©æ­£å¥½åœ¨åš<code>docker image</code>ï¼Œå‡ ç‚¹ç»éªŒå†™åœ¨ä¸‹é¢ï¼š
<ul>
<li>æ‰“åŒ…ï¼š ä½¿ç”¨åŸå§‹çš„<code>docker build</code>å‘½ä»¤è‡ªç„¶æ˜¯å¯ä»¥çš„ï¼Œäº§å“ä¸­å°±ä¸æ˜¯è¿™æ ·äº†ã€‚<code>JAVA</code>ä½¿ç”¨çš„è‡ªç„¶æ˜¯<code>maven</code>çš„<code>docker plugin</code>ï¼Œè¿™ä¸ªå¾ˆå¤šå¹´å‰å°±ç”¨è¿‡ã€‚è€Œè¿™å›<code>SCALA</code>é‡Œé¢ï¼Œæ„Ÿè§‰æ˜¯è‡ªç„¶å¸¦çš„ï¼Œç›´æ¥<code>sbt</code>é‡Œé¢<code>package</code>å°±å¯ä»¥æ‰“å‡ºï¼Œä¹Ÿè®¸è¿™ä¸ªç†è§£æœ‰å·®æ± ã€‚</li>
<li>è°ƒè¯•ï¼Œåˆ¶ä½œ<code>docker image</code>çš„è¿‡ç¨‹æˆ‘æ˜¯å¤§è‡´æ˜ç™½çš„ï¼Œå…¶å®æ¯ä¸€æ­¥éƒ½ä¼šæœ‰ä¸€ä¸ªä¸´æ—¶çš„<code>image</code>ï¼Œç„¶åä¼šåœ¨æ­¤åŸºç¡€ä¸Šé¢èµ·ä¸€ä¸ªå®¹å™¨ï¼Œåœ¨è¿™ä¸ªå®¹å™¨é‡Œé¢å»æ‰§è¡Œã€‚æ‰€ä»¥å‡ºé”™äº†ï¼Œéœ€è¦æ‰¾åˆ°è¿™ä¸€æ­¥çš„ä¸´æ—¶é•œåƒå’Œå®¹å™¨ã€‚</li>
<li>å‚è€ƒä»¥ä¸‹é“¾æ¥ï¼Œä¸»è¦æ˜¯ç”¨<code>docker commit 20f3e5cebec5 tempimagename</code> å°†ä¸´æ—¶çš„é•œåƒå­˜å‚¨ä¸‹æ¥</li>
<li><a href="https://www.joyfulbikeshedding.com/blog/2019-08-27-debugging-docker-builds.html" target="_blank" rel="noopener">Debugging Docker builds</a></li>
</ul>
</li>
</ul>
<h3 id="cmd-run"><a class="header-anchor" href="#cmd-run"></a>CMD &amp; RUN</h3>
<ul>
<li><code>CMD</code> å’Œ <code>RUN</code>éƒ½å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œä¸¤è€…çš„åŒºåˆ«å¦‚ä¸‹ï¼š
<ul>
<li><code>RUN</code>ä¼šç”Ÿæˆæ–°çš„é•œåƒå±‚ï¼Œæ‰€ä»¥é€šå¸¸ç”¨æ¥å®‰è£…è½¯ä»¶</li>
<li><code>CMD</code>åˆ™æ˜¯åœ¨é•œåƒéƒ¨ç½²å®Œä¹‹åæ‰§è¡Œçš„å‘½ä»¤</li>
</ul>
</li>
<li>å¦‚æœåœ¨å¯åŠ¨å‘½ä»¤çš„æ—¶å€™å¸¦ä¸Šå‘½ä»¤çš„è¯ï¼Œé‚£ä¹ˆ<code>CMD</code>çš„å‘½ä»¤ä¼šè¢«è¦†ç›–æ‰
<ul>
<li><code>docker run -it [image] /bin/bash</code>æ¯”å¦‚ï¼Œæ‰§è¡Œäº†è¿™å¥ï¼Œé‚£ä¹ˆå³ä½¿æœ‰æ—¢å®šçš„<code>CMD</code>ï¼Œä¹Ÿä¼šä¸æ‰§è¡Œäº†ã€‚</li>
<li>æ‰€ä»¥å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œä¸ºé•œåƒè®¾ç½®é»˜è®¤å¯åŠ¨å‘½ä»¤ï¼Œç„¶ååœ¨å®é™…å¯åŠ¨æ—¶å€™æ›¿æ¢ã€‚æ¯”å¦‚ï¼Œ<code>CMD echo &quot;hello world&quot;</code>, å¯ä»¥åœ¨å®é™…ä¸­å¯åŠ¨æ”¹ä¸º<code>hello new world</code></li>
</ul>
</li>
</ul>
<h3 id="endpoint"><a class="header-anchor" href="#endpoint"></a>Endpoint</h3>
<ul>
<li><code>endPoint</code>æ˜¯æ‰§è¡Œçš„èµ·ç‚¹ï¼Œæ¯”å¦‚<code>bash</code>, <code>mysql</code>è¿™äº›ã€‚
<ul>
<li>ä¸€ä¸ªä¾‹å­å¯ä»¥ä¸º<code>ENTRYPOINT [&quot;/bin/echo&quot;]</code>ï¼Œ<code>CMD &quot;world&quot;</code>ã€‚é‚£ä¹ˆå¯åŠ¨çš„æ—¶å€™ä¼šæ‰§è¡Œ<code>echo world</code></li>
</ul>
</li>
</ul>
<h3 id="maven-docker-plugin"><a class="header-anchor" href="#maven-docker-plugin"></a>Maven Docker Plugin</h3>
<ul>
<li><code>maven</code>æœ‰å¥½å‡ ä¸ªæ”¯æŒ<code>Docker</code>çš„<code>plugin</code></li>
<li><code>io.fabric8:docker-maven-plugin</code> å°±æ˜¯å…¶ä¸­çš„ä¸€ä¸ª</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/2019/02/14/Scala/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content="35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/hexo_blog/2019/02/14/Scala/" class="post-title-link" itemprop="url">Scala Concept</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-02-14 10:18:49" itemprop="dateCreated datePublished" datetime="2019-02-14T10:18:49+08:00">2019-02-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-02-24 10:19:47" itemprop="dateModified" datetime="2021-02-24T10:19:47+08:00">2021-02-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/Scala/" itemprop="url" rel="index"><span itemprop="name">Scala</span></a>
                </span>
            </span>

          
            <span id="/hexo_blog/2019/02/14/Scala/" class="post-meta-item leancloud_visitors" data-flag-title="Scala Concept" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="scalaæ¦‚å¿µå¿«é€Ÿè§£é‡Š"><a class="header-anchor" href="#scalaæ¦‚å¿µå¿«é€Ÿè§£é‡Š"></a>Scalaæ¦‚å¿µå¿«é€Ÿè§£é‡Š</h2>
<ul>
<li><code>Scala</code>æœ‰å¾ˆå¤šç‰¹æœ‰çš„æ¦‚å¿µã€‚å¦‚æœè¦çœ‹æ‡‚ä»£ç å°±å¾—å¤§è‡´æ˜ç™½å«ä¹‰ï¼Œè¿™ç¯‡åšå®¢å°±æ˜¯å¿«é€Ÿè§£é‡Šä¸€ä¸‹ï¼Œå…¶ä¸­å¯èƒ½ä¼šæœ‰ä¸å¤Ÿå‡†ç¡®çš„åœ°æ–¹ï¼Œå°±æ˜¯ä¸æ±‚ç”šè§£ï¼Œåªæ±‚è¿…é€Ÿè¯»æ‡‚<code>scala</code>ä»£ç äº†.</li>
<li>éš”äº†ä¸€æ®µæ—¶é—´åˆå¼€å§‹çœ‹<code>scala</code>çš„ä»£ç ï¼Œç»“æœå‘ç°è¿™ç¯‡åšå®¢å†™å¾—å¤ªä¸å£°æƒ…å¹¶èŒ‚äº†ã€‚<code>scala</code>è¿˜æ˜¯æ¯”è¾ƒå¤æ‚çš„ã€‚è¿™ä¹ˆç®€å•å†™å‡ å¥ä¸å¤ªæˆï¼Œå¾—ç»™ä¸€ç‚¹ä¾‹å­æ‰è¡Œã€‚</li>
</ul>
<h3 id="enum"><a class="header-anchor" href="#enum"></a>Enum</h3>
<ul>
<li>ç®€å•æ¥è¯´ï¼Œå¹¶æ²¡æœ‰æšä¸¾è¿™ä¸ªç±»å‹ï¼Œä½†æ˜¯å¯ä»¥ç»§æ‰¿<code>Enumeration</code>æ¥è¾¾åˆ°æšä¸¾çš„æ•ˆæœ</li>
<li>é€šå¸¸å®šä¹‰ä¸€ä¸ª<code>object</code>æ¥ç»§æ‰¿<code>Enumeration</code></li>
<li>ä½¿ç”¨<code>Enum</code>ï¼Œç±»å‹éƒ½æ˜¯<code>Enum.Value</code></li>
<li><a href="http://kubicode.me/2015/06/06/Scala/Enum-in-Scala/" target="_blank" rel="noopener">Scalaä¸­çš„Enumï¼Œè¿™ç¯‡å¯¹æ¯”äº†ä¸€ä¸‹javaå’Œscalaçš„æšä¸¾</a></li>
</ul>
<h3 id="none"><a class="header-anchor" href="#none"></a>&lt;-</h3>
<ul>
<li>
<p><code>for</code> å¾ªç¯é‡Œé¢ç”¨çš„ï¼Œçœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­å°±æ¯”è¾ƒæ¸…æ¥šï¼š</p>
<pre><code>for(x &lt;- 1 to 5)  println(i)

for { 
     x&lt;-1 to 5
     y&lt;-2 to 6
   } println (x,y)
</code></pre>
</li>
<li>
<p>å‚è€ƒé“¾æ¥ï¼š <a href="https://stackoverflow.com/questions/31799536/what-is-%E2%86%90-in-scala" target="_blank" rel="noopener">what-is-â†-in-scala</a></p>
</li>
</ul>
<h3 id="sealed-class"><a class="header-anchor" href="#sealed-class"></a>sealed class</h3>
<h3 id="valå’Œvarçš„åŒºåˆ«"><a class="header-anchor" href="#valå’Œvarçš„åŒºåˆ«"></a>valå’Œvarçš„åŒºåˆ«</h3>
<ul>
<li><code>val</code>å°±æ˜¯å¸¸é‡ï¼Œåªèƒ½èµ‹å€¼ä¸€æ¬¡</li>
<li><code>var</code>å˜é‡ï¼Œå¯ä»¥èµ‹å€¼å¤šæ¬¡</li>
<li><a href="https://www.cnblogs.com/IChing/p/7093345.html" target="_blank" rel="noopener">scalaåŸºç¡€- valå’Œvarçš„åŒºåˆ«</a></li>
</ul>
<h3 id="object"><a class="header-anchor" href="#object"></a>object</h3>
<p>çœ‹äº†å‡ ç¯‡åšå®¢ï¼Œè§£é‡Šéƒ½ä¸å¤Ÿæ¸…æ™°çš„æ„Ÿè§‰ï¼Œè¿˜æ˜¯<code>stackoverflow</code>ä¸Šé¢è§£é‡Šå¾—æ›´æ¸…æ¥š.</p>
<ul>
<li>æœ‰å¥½å‡ ç§ç”¨æ³•ï¼š
<ul>
<li>
<p>ä½œä¸º<code>static</code>å‡½æ•°çš„<code>class</code>æ–‡ä»¶ï¼Œè¿™æ˜¯æœ€å¸¸è§åˆ°çš„ç”¨æ³•ï¼š</p>
<pre><code>object A {
  def twice(i: Int): Int = 2*i
}
</code></pre>
<p>è¿™æ ·å¯ä»¥ç›´æ¥è°ƒç”¨<code>A.twice</code>ï¼Œæ²¡æœ‰å¿…è¦å…ˆå£°æ˜ä¸€ä¸ª<code>A</code>çš„å¯¹è±¡ã€‚è¿™ç§æ˜¯ç±»ä¼¼<code>java</code>é‡Œé¢çš„<code>static</code>å‡½æ•°çš„</p>
</li>
</ul>
</li>
</ul>
<ul>
<li>å‚è€ƒé“¾æ¥ï¼š<a href="https://stackoverflow.com/questions/1755345/difference-between-object-and-class-in-scala" target="_blank" rel="noopener">difference-between-object-and-class-in-scala</a></li>
</ul>
<h3 id="trait"><a class="header-anchor" href="#trait"></a>trait</h3>
<ul>
<li><a href="http://www.runoob.com/scala/scala-traits.html" target="_blank" rel="noopener">Scala Trait(ç‰¹å¾)</a></li>
<li>ç±»ä¼¼<code>java</code>çš„<code>Interface</code>ï¼Œå…¶å®æ›´è¿‘ä¼¼äºæŠ½è±¡ç±»</li>
<li>ä½†æ˜¯å¯ä»¥ä½¿ç”¨<code>with</code>å…³é”®å­—å¤šé‡ç»§æ‰¿ï¼Œå¾ˆå¥½ç”¨çš„æ„Ÿè§‰å“¦</li>
<li><code>scala</code>æœ¬èº«è¿˜æ˜¯æœ‰<code>interface</code>å…³é”®å­—çš„ï¼Œæœ¬èº«ä¹Ÿå¯ä»¥ä½¿ç”¨<code>with</code>å…³é”®å­—æ¥å®ç°æ¥å£</li>
</ul>
<h3 id="case-class"><a class="header-anchor" href="#case-class"></a>case class</h3>
<ul>
<li><a href="https://blog.csdn.net/bluishglc/article/details/50914001" target="_blank" rel="noopener">csdnä¸Šçš„ä¸€ç¯‡æ–‡ç« </a></li>
<li>ç®€å•æ¥è¯´ï¼Œ<code>case class</code>ä¼šé»˜è®¤ç”Ÿæˆå¾ˆå¤šä¸œè¥¿ï¼Œæ¯”å¦‚ä¼´ç”Ÿå¯¹è±¡ï¼Œæ¯”å¦‚å·¥å‚æ–¹æ³•ï¼Œæ¯”å¦‚<code>toString</code>ï¼Œ <code>copy</code>ï¼Œæ„é€ æ–¹æ³•å‚æ•°åŒåçš„å±æ€§</li>
<li>æœ€å¼€å¿ƒçš„ç”¨æ³•ï¼Œåº”è¯¥å°±æ˜¯ä¸ç”¨<code>new</code>å‡ºä¸€ä¸ªå¯¹è±¡æ¥ã€‚è€Œæ˜¯å¯ä»¥ç›´æ¥<code>methodName(æ„é€ å‡½æ•°å‚æ•°)</code>è¿™æ ·æ¥è·å–ä¸€ä¸ªå¯¹è±¡ã€‚å…¶å®æ˜¯åŒåçš„å·¥å‚æ–¹æ³•</li>
<li>è¿˜æœ‰ä¸€ä¸ªå¼€å¿ƒçš„ç”¨æ³•å°±æ˜¯<code>case class</code>å¯ä»¥ç›´æ¥ç”¨åœ¨<code>case</code>è¯­å¥é‡Œé¢è¿›è¡Œåˆ¤æ–­</li>
</ul>
<h3 id="implicit"><a class="header-anchor" href="#implicit"></a>implicit</h3>
<ul>
<li>
<p>éšå¼è½¬æ¢ã€‚ä¾‹å­å¦‚ä¸‹ï¼š</p>
<pre><code>    def display(input:String):Unit = println(input)
    implicit def typeConvertor(input:Int):String = input.toString
    display(12)
</code></pre>
</li>
<li>
<p>æœ¬æ¥çš„è¯ï¼Œ<code>display</code>å‡½æ•°åªèƒ½æ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å‚æ•°ï¼Œä½†æ˜¯åœ¨ç›¸åŒä½œç”¨åŸŸé‡Œé¢æœ‰éšå¼å‡½æ•°çš„å­˜åœ¨ï¼Œè‡ªåŠ¨å°†æ•´å‹è½¬æ¢æˆäº†å­—ç¬¦ä¸²ä¸‹ç±»å‹</p>
</li>
<li>
<p>éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œåœ¨ç›¸åŒä½œç”¨åŸŸé‡Œé¢ï¼Œç›¸åŒå‚æ•°ï¼Œç›¸åŒè¿”å›å€¼çš„å‡½æ•°ï¼Œå‡½æ•°åå¹¶ä¸å…³é”®ã€‚ç¡®å®ä¸å…³é”®ï¼Œåœ¨è°ƒç”¨<code>display(12)</code>çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰è¯´ï¼Œå•Šï¼Œè¯·ç”¨éšå¼å‡½æ•°<code>typeConvertor</code></p>
</li>
<li>
<p>æ‰€ä»¥ï¼Œå¦‚æœæœ‰å¦ä¸€ä¸ªéšå¼å‡½æ•°ï¼Œä¹Ÿæ˜¯å°†æ•´å‹è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œ<code>scala</code>ä¼šå‡ºé”™ã€‚å› ä¸ºå›ä¸çŸ¥é“ç”¨å“ªä¸€ä¸ª</p>
</li>
<li>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<ul>
<li><a href="https://www.cnblogs.com/rollenholt/p/4118567.html" target="_blank" rel="noopener">è¯¦å°½è§£é‡Šçš„åšå®¢ï¼Œåšä¸»å…¶ä»–åšå®¢ä¹Ÿä¸é”™</a></li>
</ul>
</li>
</ul>
<h3 id="asscala"><a class="header-anchor" href="#asscala"></a>asScala</h3>
<ul>
<li><code>import scala.collection.JavaConverters._</code></li>
<li>ç†è§£å°±æ˜¯å°†<code>Java</code>çš„ä¸€äº›ç»“æ„è‡ªåŠ¨è½¬ä¸º<code>Scala</code>çš„ç»“æ„</li>
<li>ä»¥ä¸‹å‚è€ƒé‡Œé¢å°†<code>ArrayList</code>è½¬æˆäº†<code>mutable.Buffer</code>ã€‚</li>
<li>å‚è€ƒé“¾æ¥
<ul>
<li><a href="https://blog.csdn.net/guotong1988/article/details/51454281" target="_blank" rel="noopener">asScala</a></li>
</ul>
</li>
</ul>
<h3 id="actor"><a class="header-anchor" href="#actor"></a>Actor</h3>
<ul>
<li>
<p><code>actor</code>å…¶å®ä¸æ˜¯<code>scala</code>çš„æ¦‚å¿µï¼Œ<code>Linux</code>é‡Œé¢å°±æœ‰çš„ã€‚ä½†æ˜¯æ„Ÿè§‰å†™åœ¨<code>scala</code>é‡Œé¢æ¯”è¾ƒåˆé€‚ã€‚</p>
</li>
<li>
<p><a href="https://cloud.tencent.com/developer/article/1135999" target="_blank" rel="noopener">æ¼«è°ˆå¹¶å‘ç¼–ç¨‹ï¼šActoræ¨¡å‹</a>è¿™ç¯‡é‡Œé¢å…¶å®è›®æ¸…æ¥šçš„ã€‚åŸºç¡€çš„ä¸€äº›ç”¨æ³•åœ¨è¿™è¾¹çœ‹ä¸€ä¸‹ä¹Ÿå°±æ˜ç™½ä¸€äº›äº†</p>
</li>
<li>
<p>åŸºäº<code>Actor</code>çš„å¹¶å‘ç¼–ç¨‹ä¸­ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½æ˜¯ä¸€ä¸ª<code>actor</code>ï¼Œç±»ä¼¼é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œæ‰€æœ‰çš„éƒ½æ˜¯å¯¹è±¡ä¸€æ ·ã€‚åªæ˜¯<code>Actor</code>å†å’Œ<code>Scala</code>ç»“åˆï¼Œè¿™ä¸ªå¯è¯»æ€§ï¼Œå¿…é¡»ç†Ÿæ‚‰ä»£ç çš„æ‰è¡Œã€‚</p>
</li>
<li>
<p>é¦–å…ˆæœ‰ä¸€ä¸ª<code>ActorSystem</code>ï¼Œç„¶å<code>Actor</code>æ˜¯å®¶æ—å¼çš„ï¼Œæœ‰ä¸€ä¸ªçˆ¶çš„<code>Actor</code>ï¼Œç„¶åå…¶ä»–<code>Actor</code>ç”±çˆ¶è€Œæ¥ã€‚çˆ¶<code>Actor</code>å¯ä»¥åˆ›å»ºå­<code>Actor</code>ï¼Œäº‹å®ä¸Šï¼Œæ˜¯æ•´ä¸ª<code>life cycle</code>çš„æ§åˆ¶</p>
</li>
<li>
<p>é¡¶å±‚çš„çˆ¶<code>Actor</code>ç”¨ä»¥ä¸‹è¯­å¥åˆ›å»ºã€‚<code>Props</code>é‡Œé¢çš„å°±æ˜¯<code>Actor</code>çš„ç±»çš„åå­—ï¼Œåé¢ä¸€ä¸ªå‚æ•°æ˜¯<code>Actor</code>çš„åå­—</p>
<pre><code>system.actorOf(Props[BetterMaster], &quot;master&quot;)
</code></pre>
</li>
<li>
<p>å­<code>Actor</code>åˆ›å»ºçš„æ–¹å¼æ˜¯ç±»ä¼¼çš„ï¼Œåªæ˜¯æ˜¯ç”±çˆ¶ <code>Actor</code>åˆ›å»ºçš„ã€‚çˆ¶<code>Actor</code>å†…éƒ¨ï¼Œé€šè¿‡è°ƒç”¨<code>ActorContext</code>çš„<code>actorOf()</code>æ–¹æ³•æ¥åˆ›å»ºå®ƒè‡ªèº«çš„<code>child actor</code>ã€‚å’Œçˆ¶<code>Actor</code>ä¸€æ ·ï¼Œå‚æ•°æ˜¯<code>Actor</code>çš„å®ç°çš„ç±»çš„åå­—å’Œ<code>Actor</code>çš„åå­—ã€‚</p>
</li>
</ul>
<pre><code>	context.actorOf(Props[BetterTalker], &quot;talker&quot;)
</code></pre>
<ul>
<li><code>Actor</code>æœ¬èº«æ˜¯<code>TRAIT</code>ï¼Œ<code>preStart</code>ä¸<code>postStop</code>æ˜¯å¾ˆé‡è¦çš„æ–¹æ³•ã€‚è¿™æ ·ï¼Œé€šè¿‡è¿™äº›å‡½æ•°ï¼Œå¯ä»¥æ§åˆ¶ä¸€ä¸ª<code>Actor</code>çš„ç”Ÿå‘½å‘¨æœŸã€‚åœ¨æˆ‘ä»¬çš„ä»£ç é‡Œé¢é€šè¿‡é‡è½½çˆ¶<code>Actor</code>çš„<code>preStart</code>æ–¹æ³•ï¼Œæ¥æ§åˆ¶äº†æ•´ä¸ª<code>Actor System</code></li>
</ul>
<h4 id="tell"><a class="header-anchor" href="#tell"></a>tell</h4>
<ul>
<li><code>tell</code>å…¶å®æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯<code>!</code>ï¼Œçœ‹åˆ°è¿™æ„Ÿå¹å·ç®€ç›´æ˜¯ ğŸ˜‚ è¿™éƒ½ä¸ªå¯è¯»æ€§åªèƒ½OMGäº†ã€‚</li>
<li><a href="https://stackoverflow.com/questions/49649745/what-is-the-second-argument-of-the-actorref-tell-method" target="_blank" rel="noopener">tell<br>
çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯å¹²å˜›çš„</a></li>
<li><code>tell</code>æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ¶ˆæ¯ï¼Œç¬¬äºŒä¸ªæ˜¯å›è°ƒçš„<code>Actor</code>ï¼Œå°±æ˜¯è¯´æ”¶åˆ°æ¶ˆæ¯çš„<code>Actor</code>å¯ä»¥ç»™ç¬¬äºŒä¸ªå‚æ•°(ä¹Ÿæ˜¯ä¸ª<code>Actor</code>)å‘é€æ¶ˆæ¯ï¼Œæ¥å‘Šè¯‰å®ƒè‡ªå·±æ”¶åˆ°äº†ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šçš„æ¶ˆæ¯ã€‚åŒæ—¶æ”¶åˆ°æ¶ˆæ¯çš„<code>Actor</code>ä¹Ÿä¼šè®¤ä¸ºæ¶ˆæ¯æ˜¯ç¬¬äºŒä¸ªå‚æ•°å‘æ¥çš„ã€‚</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/2019/01/28/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content="35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/hexo_blog/2019/01/28/hello-world/" class="post-title-link" itemprop="url">Hello World</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-01-28 16:21:54" itemprop="dateCreated datePublished" datetime="2019-01-28T16:21:54+08:00">2019-01-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2017-10-28 08:39:58" itemprop="dateModified" datetime="2017-10-28T08:39:58+08:00">2017-10-28</time>
              </span>

          
            <span id="/hexo_blog/2019/01/28/hello-world/" class="post-meta-item leancloud_visitors" data-flag-title="Hello World" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="quick-start"><a class="header-anchor" href="#quick-start"></a>Quick Start</h2>
<h3 id="create-a-new-post"><a class="header-anchor" href="#create-a-new-post"></a>Create a new post</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="run-server"><a class="header-anchor" href="#run-server"></a>Run server</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="generate-static-files"><a class="header-anchor" href="#generate-static-files"></a>Generate static files</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="deploy-to-remote-sites"><a class="header-anchor" href="#deploy-to-remote-sites"></a>Deploy to remote sites</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/2019/01/21/Cassandra%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content="35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/hexo_blog/2019/01/21/Cassandra%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" class="post-title-link" itemprop="url">Cassandraæ•°æ®ç»“æ„</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-01-21 15:35:56" itemprop="dateCreated datePublished" datetime="2019-01-21T15:35:56+08:00">2019-01-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-02-22 16:45:42" itemprop="dateModified" datetime="2021-02-22T16:45:42+08:00">2021-02-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/cassandra/" itemprop="url" rel="index"><span itemprop="name">cassandra</span></a>
                </span>
            </span>

          
            <span id="/hexo_blog/2019/01/21/Cassandra%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" class="post-meta-item leancloud_visitors" data-flag-title="Cassandraæ•°æ®ç»“æ„" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="cassandra-æ•°æ®ç»“æ„"><a class="header-anchor" href="#cassandra-æ•°æ®ç»“æ„"></a>Cassandra æ•°æ®ç»“æ„</h2>
<p>å¿…é¡»äº†è§£<code>Cassandra</code>çš„æ•°æ®ç»“æ„ã€‚æœ¬èº«å¹¶ä¸æ˜¯å¤šä¹ˆå¤æ‚ï¼Œè€Œä¸”æœ‰è¶³å¤Ÿå¤šçš„æ–‡æ¡£ï¼Œæ‰€ä»¥ç®€å•å†™ä¸€ä¸‹ã€‚</p>
<h3 id="keyspace"><a class="header-anchor" href="#keyspace"></a>KeySpace</h3>
<ul>
<li>å¥½åƒæ²¡å•¥éœ€è¦è§£é‡Šçš„ã€‚</li>
<li>åœ¨è®ºæ–‡é‡Œé¢çœ‹åˆ°è¯´<code>namespace</code>çš„å¦ä¸€ä¸ªä½œç”¨æ˜¯å¯ä»¥åšæ•°æ®é‡å¤ã€‚</li>
</ul>
<h3 id="column"><a class="header-anchor" href="#column"></a>Column</h3>
<ul>
<li><code>Column</code>æ˜¯<code>Cassandra</code>ä¸­æœ€å°çš„æ•°æ®å•å…ƒï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸‰å…ƒçš„æ•°æ®ç±»å‹ï¼ŒåŒ…å«<code>name,value,timestamp.</code></li>
<li><code>name</code>æ˜¯å¿…é¡»çš„ï¼Œ<code>value</code>ä¸æ˜¯å¿…é¡»çš„ï¼Œ<code>timestamp</code>ç»å¸¸å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œå¦‚ä¸‹å›¾<br>
<img src="https://raw.githubusercontent.com/sallyslove/Pictures/master/Cassandra/cassandra_column.png" alt="å¼•ç”¨è‡ªç¬¬ä¸€ç¯‡å‚è€ƒé“¾æ¥"></li>
</ul>
<blockquote>
<p>å¼•ç”¨è‡ªcsdn</p>
</blockquote>
<h3 id="super-column"><a class="header-anchor" href="#super-column"></a>Super Column</h3>
<ul>
<li>å¯ä»¥å°†<code>SuperColumn</code>æƒ³è±¡æˆ<code>Column</code>çš„æ•°ç»„ï¼Œå®ƒåŒ…å«ä¸€ä¸ª<code>name</code>ä»¥åŠä¸€ç³»åˆ—<code>Column</code>.</li>
<li><code>SuperColumn</code>æœ¬èº«ä¸åŒ…å«<code>timestamp</code>å±æ€§ã€‚ä½¿ç”¨<code>SuperColumn</code>æœ‰ä¸€ä¸ªé™åˆ¶ï¼Œè¦è¯»å–å…¶ä¸­ä¸€ä¸ªå­åˆ—çš„å€¼ï¼Œå¿…é¡»æŠŠæ‰€æœ‰å­åˆ—éƒ½ååºåˆ—åŒ–ï¼Œä¸”ä¸èƒ½åœ¨å­åˆ—ä¸­å»ºç´¢å¼•<br>
<img src="https://raw.githubusercontent.com/sallyslove/Pictures/master/Cassandra/cassandra_super_column.png" alt=""></li>
</ul>
<blockquote>
<p>å¼•ç”¨è‡ªcsdn</p>
</blockquote>
<ul>
<li>
<p>å‚è€ƒé“¾æ¥é‡Œé¢æœ‰ä»¥ä¸‹çš„ä¾‹å­</p>
<pre><code> {   // è¿™æ˜¯ä¸€ä¸ªSuperColumn
     name: &quot;info&quot;,
     // åŒ…å«ä¸€ç³»åˆ—çš„Columns
     value: {
        street: {name: &quot;street&quot;, value: &quot;1234 x street&quot;, timestamp: 123456789},
        city: {name: &quot;city&quot;, value: &quot;san francisco&quot;, timestamp: 123456789},
        zip: {name: &quot;zip&quot;, value: &quot;94107&quot;, timestamp: 123456789},
  }
}
</code></pre>
</li>
</ul>
<h3 id="columnfamily"><a class="header-anchor" href="#columnfamily"></a>ColumnFamily</h3>
<ul>
<li>
<p><code>columnFamily</code>ç›¸å½“äºæ•°æ®åº“ä¸­çš„è¡¨</p>
</li>
<li>
<p>æ¯ä¸€è¡Œæœ‰ä¸€ä¸ª<code>row</code>çš„åå­—ï¼Œç„¶åæ¯ä¸€è¡Œé‡Œé¢æ˜¯ä¸€ä¸ªä¸ªçš„<code>column</code>ï¼Œä¹Ÿå¯ä»¥æ˜¯<code>super column</code></p>
</li>
<li>
<p><code>ColumnFamily</code>æ˜¯ä¸€ä¸ªåŒ…å«äº†è®¸å¤š<code>Row</code>çš„ç»“æ„ï¼Œæ¯ä¸€ä¸ª<code>Row</code>éƒ½åŒ…å«æœ‰<code>client</code>æä¾›çš„<code>Key</code>ä»¥åŠå’Œè¯¥<code>Key</code>å…³è”çš„ä¸€ç³»åˆ—<code>Column</code>ã€‚</p>
</li>
<li>
<p>æ¯ä¸€è¡Œé‡Œé¢çš„<code>column</code>çš„åå­—å¯ä»¥æ˜¯ä¸å˜çš„ã€‚ä¹Ÿå¯ä»¥æ˜¯å¯å˜çš„ã€‚é™æ€å’ŒåŠ¨æ€<code>column</code></p>
</li>
<li>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ•°æ®å†™å…¥çš„æ—¶å€™å·²ç»ç»è¿‡æ’åºäº†ã€‚å°±æ˜¯è¯´ä¸€è¡Œçš„æ‰€æœ‰<code>column</code>ï¼Œä¼šæ ¹æ®å®ƒçš„åå­—æ¥è¿›è¡Œæ’åºã€‚</p>
</li>
<li>
<p>ç¬¬äºŒä¸ªå‚è€ƒé“¾æ¥é‡Œé¢çš„ä¾‹å­ï¼š</p>
</li>
</ul>
<pre><code>   UserProfile = { // è¿™æ˜¯ä¸€ä¸ªColumnFamily
        phatduckk: {   // è¿™æ˜¯å¯¹åº”ColumnFamilyçš„key
            // è¿™æ˜¯Keyä¸‹å¯¹åº”çš„Column
            username: &quot;gpcuster&quot;,
            email: &quot;gpcuster@gmail.com&quot;,
            phone: &quot;6666&quot;
        }, // ç¬¬ä¸€ä¸ªrowç»“æŸ
        ieure: {   // è¿™æ˜¯ColumnFamilyçš„å¦ä¸€ä¸ªkey
          //è¿™æ˜¯å¦ä¸€ä¸ªKeyå¯¹åº”çš„column
          username: &quot;pengguo&quot;,
          email: &quot;pengguo@live.com&quot;,
          phone: &quot;888&quot;
        }
</code></pre>
<p><img src="https://raw.githubusercontent.com/sallyslove/Pictures/master/Cassandra/cassandra_column_family.png" alt=""></p>
<blockquote>
<p>å¼•ç”¨è‡ªç¬¬ä¸€ç¯‡å‚è€ƒé“¾æ¥æ–‡æ¡£</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/sallyslove/Pictures/master/Cassandra/cassandra_storage_picture.png" alt=""></p>
<blockquote>
<p>å¼•ç”¨è‡ªç¬¬äºŒç¯‡å‚è€ƒé“¾æ¥æ–‡æ¡£</p>
</blockquote>
<h3 id="å¯¹åº”åˆ°è¡¨çš„å®šä¹‰é‡Œé¢"><a class="header-anchor" href="#å¯¹åº”åˆ°è¡¨çš„å®šä¹‰é‡Œé¢"></a>å¯¹åº”åˆ°è¡¨çš„å®šä¹‰é‡Œé¢</h3>
<p>ç›®å‰å¯¹äºè¡¨ç»“æ„çš„ç†è§£æ˜¯è¿™æ ·çš„ï¼Œå¯èƒ½åé¢æœ‰æ›´æ­£ï¼š</p>
<ul>
<li>å¦‚æœç”¨<code>desc tables</code>å»æŸ¥çœ‹ä¸€å¼ è¡¨ã€‚é‚£ä¹ˆå¯ä»¥çœ‹åˆ°<code>primaryKey</code>å­—æ ·ï¼Œç±»ä¼¼<code>PRIMARY KEY ()</code>ï¼Œè¿˜æœ‰<code>CLUSTERING ORDER</code> å­—æ ·</li>
<li><strong><em>é‚£ä¹ˆè¿™ä¸ªprimary keyå°±æ˜¯å¯¹åº”æ•°æ®æ¨¡å‹é‡Œé¢çš„rowçš„åå­—ã€‚ä¹Ÿå°±æ˜¯super columnçš„åå­—ã€‚åªä¸è¿‡è¿™ä¸ªåå­—æ˜¯å‡ ä¸ªprimaryKeyè”åˆèµ·æ¥ç»„æˆçš„ã€‚ï¼Ÿ</em></strong></li>
<li><code>primaryKey</code>å¯ä»¥ç”¨æ¥æŸ¥è¯¢æ•°æ®ã€‚<code>primary key</code>åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†<code>partition key</code>å’Œ<code>clustering key</code>ï¼Œ å‰è€…ç»„åˆèµ·æ¥å†³å®šä¸€ä¸ªæ•°æ®çš„å­˜å‚¨åœ¨å“ªä¸ª<code>node</code>ä¸Šé¢, åè€…ä¼šç”¨æ¥æ’åºã€‚è€Œ <code>CLUSTERING ORDER</code>å†³å®šæ’åºæ—¶å€™ä½¿ç”¨çš„å‚æ•°çš„é¡ºåº</li>
<li>æŸ¥è¯¢æ˜¯æ—¶å€™å¿…é¡»ç»™å‡ºæ‰€æœ‰çš„<code>partition key</code>ï¼Œä¹‹å‰æœ‰è¿‡<code>ALLOW FILTERING</code>çš„å­—æ®µæ¥å®¹å¿ç¼ºå¤±<code>partition key</code>ï¼Œç°åœ¨æ²¡æœ‰è¿™ä¸ªåŠŸèƒ½äº†ã€‚</li>
</ul>
<p>å¦‚ä¸‹ï¼š</p>
<pre><code>PRIMARY KEY ((race_year, race_name), rank)
</code></pre>
<p>è¿™é‡Œçš„<code>race_year</code>å’Œ<code>race_name</code>å°±æ˜¯ç»„åˆçš„<code>partition key</code>,è€Œ<code>rank</code>å°±æ˜¯<code>a clustering column</code>ï¼Œç”¨æ¥æ’åºçš„</p>
<ul>
<li>ä¹Ÿå¯èƒ½çœ‹åˆ°<code>CLUSTERING ORDER BY</code>çš„å­—æ ·é‡Œé¢ï¼Œæœ‰<code>ASC</code>ï¼Œä»£è¡¨å‡åºæ’åºï¼Œå¯ä»¥æŒ‡å®šä¸º<code>DESC</code>é™åºæ’åº</li>
<li>åœ¨<code>3.0</code>çš„ç‰ˆæœ¬ä¹‹å‰ï¼Œè¿˜å¯èƒ½çœ‹åˆ°<code>COMPACT STORAGE</code>ï¼Œç°åœ¨å·²ç»æ²¡æœ‰å•¦ï¼Œæ‰€ä»¥ä¹Ÿå°±ä¸å†™äº†ã€‚</li>
</ul>
<h3 id="data-moduling"><a class="header-anchor" href="#data-moduling"></a>data moduling</h3>
<ul>
<li>æœ€è¿‘çœ‹äº†ä¸€äº›å…³äºå»ºæ¨¡çš„æ–‡ç« ã€‚æ–‡ç« é‡Œé¢ä¸€äº›åå¤å¼ºè°ƒçš„äº‹å¦‚ä¸‹ï¼š
<ul>
<li><code>cassandra</code>ä¸åŒäºå…¶ä»–æ•°æ®åº“çš„æ˜¯ï¼Œå®ƒå†™çš„æˆæœ¬ä½ï¼Œè¯»çš„æˆæœ¬é«˜ã€‚</li>
<li>åŸºäºè¿™ä¸€ç‚¹ï¼Œå¿…é¡»åœ¨ä¸€å¼€å§‹å…ˆè€ƒè™‘<code>query</code>çš„éœ€æ±‚ï¼Œç„¶åæ•°æ®å¯ä»¥<code>duplicated</code>ã€‚è€Œåœ¨å…³ç³»æ•°æ®åº“å»ºæ¨¡æ—¶å€™ï¼Œå®Œå…¨æ˜¯ä¸ä¸€æ ·çš„ã€‚</li>
<li>åŸºäº<code>cassandra</code>çš„å†™å’Œå­˜å‚¨çš„æ–¹å¼ï¼Œéœ€è¦è¯»å–çš„æ•°æ®åº”è¯¥æ”¾åœ¨åŒä¸€ä¸ª<code>partition</code>é‡Œé¢ã€‚</li>
<li>æ–‡ç« é‡Œé¢çš„è¿™å¥è¯è¯´æ˜äº†<code>partition</code>çš„å®šä¹‰å’Œé‡è¦æ€§ï¼š</li>
</ul>
<blockquote>
<p>a set of rows that share a partition key is called a partition<br>
Cassandra is a partitioned row store with tunable consistency.<br>
You perform several optimizations in the physical data modeling stage, including the specifying of partition sizes and ordering.</p>
</blockquote>
</li>
</ul>
<h3 id="å‚è€ƒæ–‡æ¡£"><a class="header-anchor" href="#å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h3>
<ul>
<li><a href="https://blog.csdn.net/aesop_wubo/article/details/20289837" target="_blank" rel="noopener">æ•°æ®æ¨¡å‹</a></li>
<li><a href="http://www.cnblogs.com/gpcuster/archive/2010/03/12/1684072.html" target="_blank" rel="noopener">å¤§è¯Cassandraæ•°æ®æ¨¡å‹</a></li>
<li><a href="https://stackoverflow.com/questions/24949676/difference-between-partition-key-composite-key-and-clustering-key-in-cassandra" target="_blank" rel="noopener">primary key partition key and clustering key</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/2019/01/21/Cassandra%E8%AF%BB%E6%95%B0%E6%8D%AE%E8%BF%87%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content="35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/hexo_blog/2019/01/21/Cassandra%E8%AF%BB%E6%95%B0%E6%8D%AE%E8%BF%87%E7%A8%8B/" class="post-title-link" itemprop="url">Cassandraè¯»æ•°æ®è¿‡ç¨‹</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-01-21 15:35:32" itemprop="dateCreated datePublished" datetime="2019-01-21T15:35:32+08:00">2019-01-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-02-22 16:24:08" itemprop="dateModified" datetime="2021-02-22T16:24:08+08:00">2021-02-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/cassandra/" itemprop="url" rel="index"><span itemprop="name">cassandra</span></a>
                </span>
            </span>

          
            <span id="/hexo_blog/2019/01/21/Cassandra%E8%AF%BB%E6%95%B0%E6%8D%AE%E8%BF%87%E7%A8%8B/" class="post-meta-item leancloud_visitors" data-flag-title="Cassandraè¯»æ•°æ®è¿‡ç¨‹" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="cassandraè¯»æ•°æ®è¿‡ç¨‹"><a class="header-anchor" href="#cassandraè¯»æ•°æ®è¿‡ç¨‹"></a>Cassandraè¯»æ•°æ®è¿‡ç¨‹</h2>
<p>æ•°æ®åº“è¯»æ•°æ®è¿‡ç¨‹å¿…é¡»çŸ¥é“ã€‚</p>
<h3 id="å¤§è‡´çš„è¯»æµç¨‹"><a class="header-anchor" href="#å¤§è‡´çš„è¯»æµç¨‹"></a>å¤§è‡´çš„è¯»æµç¨‹</h3>
<p><img src="https://docs.datastax.com/en/archived/cassandra/3.0/cassandra/images/dml_caching-reads_12.png" alt="å®˜æ–¹è¯»æµç¨‹å›¾ç‰‡"></p>
<blockquote>
<p>å®˜æ–¹è¯»æµç¨‹å›¾ç‰‡</p>
</blockquote>
<ul>
<li>
<p>Check the memtable</p>
</li>
<li>
<p>Check row cache, if enabled</p>
</li>
<li>
<p>Checks Bloom filter</p>
</li>
<li>
<p>Checks partition key cache, if enabled</p>
</li>
<li>
<p>Goes directly to the compression offset map if a partition key is found in the partition key cache, or checks the partition summary if not<br>
If the partition summary is checked, then the partition index is accessed</p>
</li>
<li>
<p>Locates the data on disk using the compression offset map</p>
</li>
<li>
<p>Fetches the data from the SSTable on disk</p>
</li>
<li>
<p>åœ¨å­˜è´®æ•°æ®çš„æ—¶å€™ï¼Œ<code>Cassandra</code>ä¼šè®²åŒæ ·çš„æ•°æ®å­˜å‚¨å¾ˆå¤šä»½ï¼Œè¿™ä¸ªåœ¨å†™çš„æ—¶å€™å·²ç»æåŠè¿‡ã€‚</p>
</li>
<li>
<p>åœ¨è¯»çš„æ—¶å€™è¯»å‡ ä¸ªèŠ‚ç‚¹åŒæ ·æ˜¯ç”±å¤åˆ¶å› å­å’Œ<code>consistency level</code>ç­–ç•¥å†³å®šçš„ã€‚ä¹Ÿå°±æ˜¯è¯´å†™å‡ ä¸ªï¼Œè¯»å‡ ä¸ªã€‚</p>
</li>
</ul>
<h3 id="caches"><a class="header-anchor" href="#caches"></a>Caches</h3>
<p>è¿™ç¯‡ä¹Ÿä½œä¸º<code>KeyCache</code>å’Œ<code>RowCache</code>å­¦ä¹ çš„blog.<br>
<code>RowCache</code>ç¼“å­˜çš„æ˜¯æ•°æ®ï¼Œè€Œ<code>KeyCache</code>ç¼“å­˜çš„æ˜¯åœ¨<code>SSTable</code>æ–‡ä»¶ä¸­çš„ä½ç½®ã€‚<br>
<code>Cassandra</code>è¯»æ•°æ®æ…¢ï¼Œå†™æ•°æ®å¿«ã€‚</p>
<p>ä»¥ä¸‹å‡ ç§<code>cache</code>éƒ½æ˜¯é’ˆå¯¹<code>SSTable</code>æ¥è¯´çš„</p>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<ul>
<li><a href="https://stackoverflow.com/questions/25079311/difference-between-cassandra-row-caching-and-partition-key-caching" target="_blank" rel="noopener">row cache å’Œ key cache</a></li>
</ul>
<h4 id="keycache"><a class="header-anchor" href="#keycache"></a>keyCache</h4>
<ul>
<li>key cacheï¼šstores a map of partition keys to row index entriesã€‚stores a cache of the partition index in off-heap memory</li>
<li><em>partition key cache, caches the partition index for an SSTable</em></li>
<li>ä¹Ÿåœ¨<code>off-heap</code>é‡Œé¢</li>
<li><code>key_cache_size_in_mb</code>ï¼š <em>set the maximum size of the key cache for all tables in a database.</em></li>
</ul>
<p><img src="%5Chexo_blog%5Cimages%5Cpasted-4.png" alt="upload successful"></p>
<h4 id="rowcache"><a class="header-anchor" href="#rowcache"></a>rowCache</h4>
<ul>
<li><em>caches frequently accessed rows to speed up access to those rows.</em></li>
<li>ä¸æ˜¯é»˜è®¤å¼€çš„ï¼Œ<em>In Cassandra 2.2 and later, it is stored in fully off-heap memory using a new implementation that relieves garbage collection pressure in the JVM.</em> åœ¨2.2ä¹‹åï¼Œä¼šå°†è¿™äº›è¡Œå­˜è¿›éæ ˆçš„å†…å­˜é‡Œé¢ï¼Œä½¿å¾—ç³»ç»Ÿä¸éœ€è¦è¿›è¡Œ<code>GC</code></li>
<li>å½“å­˜åœ¨å†…å­˜ä¸­çš„è¡Œè¢«æ›´æ–°ä¹‹åï¼Œè¿™ä¸€è¡Œä¼šè¢«åˆ é™¤ï¼Œç›´åˆ°å†æ¬¡è¯»å–</li>
<li>åŒæ ·ï¼Œå½“ä¸€ä¸ª<code>partition</code>è¢«æ›´æ–°äº†ï¼Œè¿™ä¸ª<code>partition</code>ä¼šè¢«ä»å†…å­˜é‡Œé¢åˆ é™¤</li>
<li>å‚æ•°ï¼š
<ul>
<li><code>rows_per_partition</code>ï¼š<em>set the number of rows the database must cache in a partition.This attribute has three values: ALL, NONE, and N.</em></li>
</ul>
</li>
</ul>
<h4 id="counter-cache"><a class="header-anchor" href="#counter-cache"></a>counter cache</h4>
<ul>
<li>A counter cache improves performance for the counters that youâ€™ll need to access frequently. å¥½åƒæ²¡æ€ä¹ˆå¬è¯´è¿‡counterçš„æ¦‚å¿µã€‚è¿™ä¸ªcacheä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡çœ‹åˆ°æœ‰ã€‚</li>
</ul>
<h4 id="bloom-filters"><a class="header-anchor" href="#bloom-filters"></a>bloom filters</h4>
<ul>
<li><code>Bloom Filters</code> å°±æ˜¯åœ¨å†™<code>ssTable</code>æ—¶å€™åŒæ—¶å†™çš„<code>filter.db</code>æ–‡ä»¶ã€‚ä½†æ˜¯å®é™…æ˜¯è¯»çš„æ—¶å€™ç”¨çš„ä¸€ä¸ªæœºåˆ¶</li>
<li>è¯»çš„æ—¶å€™ä¼šç”¨è¿™ä¸ªæœºåˆ¶æ¥çœ‹ä¸€ä¸ªæ•°æ®keyæ˜¯ä¸æ˜¯åœ¨æŸä¸ª<code>SSTable</code>é‡Œé¢ã€‚å½“filterè¡¨ç¤ºä¸åœ¨ï¼Œè‚¯å®šæ˜¯ä¸åœ¨ï¼›ä½†æ˜¯è¯´åœ¨ï¼Œå¯èƒ½ä¸åœ¨ã€‚å°±æ˜¯è¯´å¯èƒ½å‡ç»¿çš„ã€‚ä¹Ÿä¼šç»™å‡ºä¸€ä¸ªæ¦‚ç‡å€¼ï¼ŒæŸä¸ª<code>partition</code>åœ¨ä¸åœ¨è¿™ä¸ª<code>SSTable</code>é‡Œé¢</li>
<li>å‡ç»¿çš„æ¦‚ç‡æ˜¯ä¸‡åˆ†ä¹‹ä¸€</li>
<li>å¯ä»¥é…ç½®<code>bloom_filter_fp_chance</code>æ¥é™ä½å‡ç»¿ï¼Œä½†æ˜¯ä¼šå æ›´å¤šå†…å­˜</li>
<li><code>Bloom Filters</code> ä¹Ÿæ˜¯å­˜å‚¨åœ¨<code>off-heap</code> memoryé‡Œé¢çš„ã€‚å¹¶ä¸”æ˜¯æ¯å¼ <code>SSTable</code>éƒ½æœ‰ä¸€ä¸ªçš„</li>
<li><em>A Bloom filter can establish that a SSTable does not contain certain partition data.</em></li>
<li>å‚è€ƒé“¾æ¥ï¼š
<ul>
<li><a href="https://blog.csdn.net/u010900754/article/details/78307808" target="_blank" rel="noopener">bloom è¿‡æ»¤å™¨</a></li>
<li><a href="https://blog.csdn.net/jiaomeng/article/details/1495500" target="_blank" rel="noopener">ç®—æ³•åŸç†</a></li>
<li><a href="https://blog.csdn.net/nangongyanya/article/details/54089568" target="_blank" rel="noopener">Cassandra Bloom è¿‡æ»¤å™¨</a></li>
</ul>
</li>
</ul>
<h4 id="partition-summary-partition-index"><a class="header-anchor" href="#partition-summary-partition-index"></a>Partition Summary &amp; Partition Index</h4>
<ul>
<li><code>partition index</code>æ˜¯å­˜å‚¨åœ¨ç£ç›˜ä¸Šé¢çš„æ–‡ä»¶ï¼Œé‡Œé¢æ˜¯_an index of all partition keys mapped to their offset._</li>
<li><code>partition summary</code>æ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­çš„<code>partition index</code>çš„é‡‡æ ·ã€‚ä¹Ÿæ˜¯åœ¨<code>off-heap</code>é‡Œé¢çš„ã€‚ä¹Ÿå°±æ˜¯å‡ ä¹æ‰€æœ‰å¸®åŠ©è¯»çš„æœºåˆ¶éƒ½å­˜åœ¨<code>off-heap</code>çš„å†…å­˜é‡Œé¢</li>
<li><code>partition summary</code>çš„é‡‡æ ·å­˜å‚¨ä¸¾ä¾‹æ¥è¯´ï¼Œå‡è®¾å› å­æ˜¯20ï¼Œé‚£ä¹ˆå°±æ˜¯ç¬¬ä¸€ä¸ªå’Œç¬¬20ä¸ªçš„åç§»é‡è¢«å­˜å‚¨äº†ã€‚</li>
<li>å¦‚æœåœ¨è¯»çš„æ—¶å€™å¿…é¡»è¯»åˆ°<code>partition summary</code>ï¼Œé‚£ä¹ˆæ•´ä¸ªè¯»çš„è¿‡ç¨‹ä¼šæœ‰ä¸¤æ¬¡è®¿é—®ç£ç›˜</li>
</ul>
<h3 id="gossip-protocal"><a class="header-anchor" href="#gossip-protocal"></a>Gossip Protocal</h3>
<h3 id="limit"><a class="header-anchor" href="#limit"></a>Limit</h3>
<ul>
<li><code>Cassandra</code>æ ¹æ®<code>primary key</code>æ¥è¯»å–æ•°æ®ï¼Œè¿™ä¸ª<code>key</code>å°±æ˜¯å­˜åœ¨<code>keyCache</code>é‡Œé¢çš„å†…å®¹ã€‚ç„¶åä¼šè¯»å–ä¸€ç‰‡æ•°æ®ã€‚<em>è¿™é‡Œç†è§£æ­£ç¡®å—ï¼Ÿ<code>keyCache</code>é‡Œé¢çš„ä¸æ˜¯<code>partition index</code>é‡Œé¢çš„å†…å®¹å—ï¼Ÿ</em></li>
<li>è¯»å–æ—¶å€™å¯ä»¥æŒ‡å®š<code>limit</code>å€¼ï¼Œè¿™æ ·ä¼šè¯»å–æœ‰é™çš„å†…å®¹ï¼Œè€Œä¸æ˜¯ä¸€å¤§ç‰‡ã€‚</li>
</ul>
<h3 id="å‚è€ƒæ–‡æ¡£"><a class="header-anchor" href="#å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h3>
<ul>
<li>éå¸¸è¯¦å°½æ¸…æ™°çš„ä¸€ç¯‡æ–‡æ¡£ï¼š<a href="https://www.oschina.net/question/12_11855" target="_blank" rel="noopener">Cassandraæ•°æ®ç»“æ„å’Œå†™å…¥è¯»å–</a></li>
<li><a href="https://docs.datastax.com/en/archived/cassandra/3.0/cassandra/dml/dmlAboutReads.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£è¯»æµç¨‹</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/2019/01/18/Java-GC-%E6%9C%BA%E5%88%B6-CMS-G1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content="35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/hexo_blog/2019/01/18/Java-GC-%E6%9C%BA%E5%88%B6-CMS-G1/" class="post-title-link" itemprop="url">Java GC æœºåˆ¶ CMS & G1</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-01-18 14:04:17" itemprop="dateCreated datePublished" datetime="2019-01-18T14:04:17+08:00">2019-01-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-02-14 14:40:18" itemprop="dateModified" datetime="2019-02-14T14:40:18+08:00">2019-02-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
                </span>
            </span>

          
            <span id="/hexo_blog/2019/01/18/Java-GC-%E6%9C%BA%E5%88%B6-CMS-G1/" class="post-meta-item leancloud_visitors" data-flag-title="Java GC æœºåˆ¶ CMS & G1" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="java-gc-æœºåˆ¶-cms-g1"><a class="header-anchor" href="#java-gc-æœºåˆ¶-cms-g1"></a>Java GC æœºåˆ¶ CMS &amp; G1</h2>
<p>åœ¨çœ‹Cassandraçš„è¿‡ç¨‹ä¸­çœ‹åˆ°äº†GCçš„æœºåˆ¶ï¼Œåœ¨Cassandraä¸­æ˜¯å¯é…çš„ã€‚GCå¯¹äºCassandraçš„æ€§èƒ½è‚¯å®šæ˜¯æœ‰å½±å“çš„ã€‚<br>
æ‰€ä»¥é¦–å…ˆå­¦ä¹ è¿™ä¸¤ä¸ªGCæœºåˆ¶ã€‚å› ä¸ºæ¯•ç«Ÿæ˜¯ä¸ºäº†Cassandraæ¥çœ‹ï¼Œæ‰€ä»¥ä¼šç›´æ¥çœ‹çœ‹ä¸¤ç§æœºåˆ¶ã€‚</p>
<h3 id="java-heapåˆ†åŒº"><a class="header-anchor" href="#java-heapåˆ†åŒº"></a>Java Heapåˆ†åŒº</h3>
<ul>
<li>Heapçš„Capacityç­‰äº-Xmså’Œ-Xmxçš„å€¼, Xmsæ˜¯åˆå§‹åŒ–çš„heap sizeï¼ŒXmxæ˜¯æœ€å¤§çš„heap sizeï¼Œè¿™ä¸¤ä¸ªç»å¸¸æ˜¯ä¸€æ ·å¤§çš„</li>
<li>å¹´è½»ä»£çš„GCï¼šå­˜æ´»å¯¹è±¡ä¼šè¢«æ‹·è´/ç§»åŠ¨åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªâ€œSurvivorâ€åŒºåŸŸï¼Œå­˜æ´»æ—¶é—´å¤Ÿé•¿çš„ç›´æ¥ç§»åˆ°â€œè€å¹´ä»£â€åŒºåŸŸã€‚è¿™é‡Œä¼šstop the worldï¼Œä½†young GCçš„è¿‡ç¨‹æ˜¯å¤šçº¿ç¨‹æ‰§è¡Œçš„</li>
<li>Youngä¸­åˆ†æˆEdenå’ŒSurvivorï¼Œå…¶ä¸­Edenå’ŒSurvivoræ˜¯æˆæ¯”ä¾‹çš„</li>
</ul>
<h3 id="cms"><a class="header-anchor" href="#cms"></a>CMS</h3>
<ul>
<li><code>CMS</code>ï¼š Concurrent Low Pause Collector</li>
<li>CMSæ˜¯Java GCä½¿ç”¨çš„ç®—æ³•ï¼Œæ˜¯è€å¹´ä»£çš„å›æ”¶ã€‚éœ€è¦æ­é…ä¸€ä¸ªå¹´è½»ä»£å›æ”¶çš„å›æ”¶å™¨</li>
<li>CMSçš„å‚æ•°CMSInitiatingOccupancyFractionï¼Œ åœ¨old generationçš„å¤§å°è¾¾åˆ°è¿™ä¸ªé—¨é˜€å€¼çš„æ—¶å€™ï¼Œä¼šå¼•èµ·ä¸€æ¬¡full GC</li>
<li>Cassandaraé»˜è®¤ä½¿ç”¨çš„ç®—æ³•æ˜¯CMS GC</li>
</ul>
<h3 id="g1"><a class="header-anchor" href="#g1"></a>G1</h3>
<h3 id="å‚è€ƒæ–‡æ¡£"><a class="header-anchor" href="#å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h3>
<ul>
<li><a href="https://www.cnblogs.com/hunrry/p/9210022.html" target="_blank" rel="noopener">å¸¸è§GCç®—æ³•é€Ÿè§ˆ</a></li>
<li><a href="https://www.jianshu.com/p/bdd6f03923d1" target="_blank" rel="noopener">G1 vs CMS</a></li>
<li><a href="https://www.tuicool.com/articles/Jj2yAbb" target="_blank" rel="noopener">CMS</a></li>
<li>è¿™ç¯‡æ–‡æ¡£å¯¹æ¯”å¾—éå¸¸å¥½ï¼Œç»†èŠ‚å¾ˆå¤š<br>
<a href="https://www.tuicool.com/articles/QZfiAzz" target="_blank" rel="noopener">Cassandraä¸­CMS vs G1</a></li>
<li><a href="https://plumbr.io/blog/garbage-collection/minor-gc-vs-major-gc-vs-full-gc" target="_blank" rel="noopener">minor GC &amp; major Gc &amp; full GC</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/2019/01/17/Cassandra-%E5%86%99%E6%95%B0%E6%8D%AE%E8%BF%87%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content="35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/hexo_blog/2019/01/17/Cassandra-%E5%86%99%E6%95%B0%E6%8D%AE%E8%BF%87%E7%A8%8B/" class="post-title-link" itemprop="url">Cassandra å†™æ•°æ®è¿‡ç¨‹</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-01-17 16:37:00" itemprop="dateCreated datePublished" datetime="2019-01-17T16:37:00+08:00">2019-01-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-02-22 16:24:22" itemprop="dateModified" datetime="2021-02-22T16:24:22+08:00">2021-02-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/cassandra/" itemprop="url" rel="index"><span itemprop="name">cassandra</span></a>
                </span>
            </span>

          
            <span id="/hexo_blog/2019/01/17/Cassandra-%E5%86%99%E6%95%B0%E6%8D%AE%E8%BF%87%E7%A8%8B/" class="post-meta-item leancloud_visitors" data-flag-title="Cassandra å†™æ•°æ®è¿‡ç¨‹" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="cassandra-å†™æµç¨‹"><a class="header-anchor" href="#cassandra-å†™æµç¨‹"></a>Cassandra å†™æµç¨‹</h2>
<h3 id="å¤§è‡´æµç¨‹"><a class="header-anchor" href="#å¤§è‡´æµç¨‹"></a>å¤§è‡´æµç¨‹</h3>
<p>åˆ°æŠŠæ•°æ®å†™åˆ°ç£ç›˜ä¸­åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>å…ˆæ‰¾åˆ°åº”è¯¥å¾€å“ªå‡ ä¸ªèŠ‚ç‚¹å†™</li>
<li>å†™logåˆ°commit log</li>
<li>å†™æ•°æ®åˆ°memtable</li>
<li>ä»memtableä¸­flushæ•°æ®</li>
<li>å°†æ•°æ®å­˜å‚¨åœ¨SSTablesä¸­çš„ç£ç›˜ä¸­</li>
</ol>
<ul>
<li>å®¢æˆ·ç«¯å†™ä¸€æ¡æ•°æ®å¿…é¡»æŒ‡å®š Keyspaceã€ColumnFamilyã€Keyã€Column Name å’Œ Valueï¼Œè¿˜å¯ä»¥æŒ‡å®š Timestampï¼Œä»¥åŠæ•°æ®çš„å®‰å…¨ç­‰çº§ã€‚<strong><em>è¿™ä¸ªkeyåˆæ˜¯ä»€ä¹ˆkeyå‘¢ï¼Œpartition Key, primary Key,æ˜¯åæ–‡è¯´æ ¹æ®keyç®—å‡ºtokenï¼Œç„¶åå†æ ¹æ®tokenç®—å‡ºpartition Indexçš„</em></strong></li>
</ul>
<pre><code>Cassandra Node ---&gt;Commitlog---&gt; Memtable

Commitlog ---&gt; Periodically sync to  disk

Memtable  ---&gt; Periodically flush to SSTable
</code></pre>
<p><strong><em>å¦‚æœçœ‹ä¸‹é¢çš„æµç¨‹å›¾çš„è¯ï¼Œé‚£ä¹ˆä¸Šé¢è¿™ä¸ªé¡ºåºæ˜¯ä¸å¯¹çš„ã€‚æ˜¯å…ˆå†™åˆ°memtableï¼Œç„¶åå†å†™commitLogï¼Ÿçœ‹å®˜æ–¹æ–‡æ¡£ï¼Œä¸Šé¢çš„æ˜¯æ­£ç¡®çš„ã€‚åº”è¯¥æ˜¯æµç¨‹å›¾ä¸å¤Ÿå¥½ã€‚æˆ–è€…æ˜¯ä¸€ä¸ªç›¸å¯¹å¹¶è¡Œçš„è¿‡ç¨‹</em></strong></p>
<p><img src="https://www.ibm.com/developerworks/cn/opensource/os-cn-cassandraxu2/image012-large.jpg" alt=""></p>
<blockquote>
<p>å¼•ç”¨è‡ªç¬¬äºŒç¯‡é“¾æ¥</p>
</blockquote>
<ul>
<li>è¿™å¼ å›¾é‡Œé¢æœ‰çš„ç»“æ„å¯èƒ½ä¸å¤ªå¯¹äº†ã€‚æ²¡æœ‰æ‰¾åˆ°RowMutationè¿™ä¸ªç»“æ„ï¼Œåªæœ‰Mutation</li>
</ul>
<h3 id="replica-factor"><a class="header-anchor" href="#replica-factor"></a>Replica Factor</h3>
<ul>
<li>
<p>CassandraServer æ¥æ”¶åˆ°è¦å†™å…¥çš„æ•°æ®æ—¶ï¼š</p>
<ul>
<li>åˆ›å»ºä¸€ä¸ª <code>RowMutation</code> å¯¹è±¡ï¼Œå†åˆ›å»ºä¸€ä¸ª <code>QueryPath</code> å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¸­ä¿å­˜äº† <code>ColumnFamily</code>ã€<code>Column Name</code> æˆ–è€… <code>Super Column Name</code>ã€‚</li>
<li>æŠŠç”¨æˆ·æäº¤çš„æ‰€æœ‰æ•°æ®ä¿å­˜åœ¨ <code>RowMutation</code> å¯¹è±¡çš„ Map&lt;String, ColumnFamily&gt; ç»“æ„ä¸­ã€‚</li>
<li>æ ¹æ®æäº¤çš„<code>Key</code>è®¡ç®—é›†ç¾¤ä¸­é‚£ä¸ªèŠ‚ç‚¹åº”è¯¥ä¿å­˜è¿™æ¡æ•°æ®ã€‚è¿™ä¸ªè®¡ç®—çš„è§„åˆ™æ˜¯ï¼šå°†<code>Key</code>è½¬åŒ–æˆ<code>Token</code>ï¼Œç„¶ååœ¨æ•´ä¸ªé›†ç¾¤çš„<code>Token</code>ç¯ä¸­æ ¹æ®äºŒåˆ†æŸ¥æ‰¾ç®—æ³•æ‰¾åˆ°ä¸ç»™å®šçš„<code>Token</code>æœ€æ¥è¿‘çš„ä¸€ä¸ªèŠ‚ç‚¹ã€‚</li>
<li>å¦‚æœç”¨æˆ·æŒ‡å®šäº†æ•°æ®è¦ä¿å­˜å¤šä¸ªå¤‡ä»½ï¼Œé‚£ä¹ˆå°†ä¼šé¡ºåºåœ¨<code>Token</code>ç¯ä¸­è¿”å›ä¸å¤‡ä»½æ•°ç›¸ç­‰çš„èŠ‚ç‚¹ã€‚è¿™æ˜¯ä¸€ä¸ªåŸºæœ¬çš„èŠ‚ç‚¹åˆ—è¡¨ï¼Œåé¢<code>Cassandra</code>ä¼šåˆ¤æ–­è¿™äº›èŠ‚ç‚¹æ˜¯å¦æ­£å¸¸å·¥ä½œï¼Œå¦‚æœä¸æ­£å¸¸å¯»æ‰¾æ›¿æ¢èŠ‚ç‚¹ã€‚è¿˜æœ‰è¿˜è¦æ£€æŸ¥æ˜¯å¦æœ‰èŠ‚ç‚¹æ­£åœ¨å¯åŠ¨ï¼Œè¿™ç§èŠ‚ç‚¹ä¹Ÿæ˜¯è¦åœ¨è€ƒè™‘çš„èŒƒå›´å†…ï¼Œæœ€ç»ˆä¼šå½¢æˆä¸€ä¸ªç›®æ ‡èŠ‚ç‚¹åˆ—è¡¨ã€‚æœ€åæŠŠæ•°æ®å‘é€åˆ°è¿™äº›èŠ‚ç‚¹ã€‚</li>
<li><strong><em>æ‰€ä»¥åœ¨çœŸæ­£å¼€å§‹å†™å…¥æ•°æ®ä¹‹å‰ï¼Œcassandraä¼šåšè¿™äº›äº‹æƒ…ï¼Ÿåœ¨commitLogä¹‹å‰ï¼Ÿ</em></strong> æˆ‘æƒ³åº”è¯¥æ˜¯ä¹‹å‰</li>
</ul>
</li>
<li>
<p><code>Replica Factor</code>å’Œ<code>consistency level</code>ä¸æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œç„¶åæœ‰ä¸€ä¸ªç®—æ³•ã€‚æ¯”å¦‚ï¼Œ<code>replica set</code>æ˜¯3ï¼Œ <code>consistency level</code>çš„ç­–ç•¥æ˜¯<code>Querum</code>ã€‚è¿™æ ·éœ€è¦consistentçš„èŠ‚ç‚¹æ˜¯replica set/2 +1 ï¼Œæ‰€ä»¥å°±æ˜¯2</p>
</li>
</ul>
<h3 id="eventual-consistency"><a class="header-anchor" href="#eventual-consistency"></a>Eventual Consistency</h3>
<p>è¿™åœ¨Cassandraé‡Œé¢æ˜¯éå¸¸å…³é”®çš„ä¸€ä¸ªæ¦‚å¿µã€‚å†™åœ¨è¿™é‡Œã€‚å› ä¸ºä¸å†™çš„æœºåˆ¶ç›¸å…³æœ€å¤šã€‚</p>
<ul>
<li>
<p>Cassandra must make tradeoffs among data consistency, availability, and partition tolerance. Cassandraå¿…é¡»åœ¨æ•°æ®ä¸€è‡´æ€§ã€å¯ç”¨æ€§å’Œåˆ†åŒºå®¹å¿ä¹‹é—´å¹³è¡¡</p>
<ul>
<li>
<p>Availability: all clients are able to access the data so they can read and write data. å¯ç”¨æ€§ï¼šæ‰€æœ‰å®¢æˆ·éƒ½èƒ½å¤Ÿè¯»å–å’Œå†™å…¥æ•°æ®</p>
</li>
<li>
<p>Consistencyçš„æ¦‚å¿µï¼š</p>
<ul>
<li>a read always return the latest written dataï¼š è¯»å–æ—¶å€™è¿”å›æœ€åä¸€æ¬¡å†™å…¥çš„æ•°æ®</li>
<li>All clients will read the same value for an element of data even when the database is simultaneously updating dataï¼š å½“æ•°æ®åº“åŒæ­¥å®Œæˆçš„æ—¶å€™ï¼Œæ‰€æœ‰å®¢æˆ·ç«¯åº”è¯¥å¾—åˆ°åŒæ ·çš„æ•°æ®</li>
</ul>
</li>
<li>
<p>Partition toleranceï¼ša database can be split into multiple machines and be able keep functioning even during network segmentation breaksï¼š ä¸€ä¸ªæ•°æ®åº“å¯ä»¥åˆ†å¸ƒåœ¨ä¸åŒçš„æœºå™¨ä¸Šé¢ï¼Œå¹¶ä¸”èƒ½å¤Ÿåœ¨ç½‘ç»œå‡ºç°æ•…éšœæ—¶å€™ä¿æŒæ­£å¸¸åŠŸèƒ½</p>
<p>è¿™é‡Œåº”è¯¥å’Œå…³ç³»å‹çš„ä¼ ç»Ÿæ•°æ®åº“ä¸ä¸€æ ·ã€‚Cassandraæ˜¯åˆ†å¸ƒå¼æ•°æ®åº“ï¼Œæ‰€æœ‰nodeçš„åœ°ä½æ˜¯ä¸€æ ·çš„ã€‚<strong><em>è¯´å¥½çš„seedå‘¢ï¼Œæ€ä¹ˆæ„Ÿè§‰æœ‰seedï¼Œ seedåº”è¯¥æ˜¯Gossipæœºåˆ¶é‡Œé¢æå‡ºçš„ã€‚å‚è€ƒåšå®¢å†…æ–‡æ¡£<code>Cassandra system logåˆ†æ</code>åé¢ä¹Ÿè®¸ä¼šæ¢ä¸€ä»½æ–‡æ¡£æ”¾</em></strong></p>
<p>Oracleè¿™ç§æ•°æ®åº“ä¸€èˆ¬æ˜¯å•æœºç‰ˆçš„ï¼Œæ²¡æœ‰clusterï¼Œ ä½†æ˜¯æœ‰ä¸»ä»å¤‡ä»½ï¼Œæ‰€æœ‰ä¸ä¸€æ ·çš„</p>
</li>
</ul>
</li>
<li>
<p>ä¸¥æ ¼æ„ä¹‰ä¸Šé¢çš„Consistencyå¯¹äºåˆ†å¸ƒå¼æ•°æ®åº“æ¥è¯´å¾ˆéš¾åšåˆ°ã€‚æ‰€ä»¥æœ‰Eventual consistency requires that all updates must be present on all the copies (replicas) of data in a distributed database, but allows for the fact that the process can take a bit of time.<br>
å°±æ˜¯è¯´æ›´æ–°æ˜¯éƒ½è¦è¿›è¡Œçš„ï¼Œä½†æ˜¯å¯ä»¥æœ‰ä¸€æ®µæ—¶é—´å·®</p>
</li>
<li>
<p>tuneable consistencyï¼š å¯é…ç½®çš„consistencyã€‚å†™å’Œè¯»éƒ½å¯ä»¥é…ã€‚</p>
</li>
</ul>
<h3 id="commit-log"><a class="header-anchor" href="#commit-log"></a>commit log</h3>
<p><a href="https://stackoverflow.com/questions/34592948/what-is-the-purpose-of-cassandras-commit-log" target="_blank" rel="noopener">stackoverflowé—®ç­”</a><br>
è¿™ç¯‡æ–‡ç« é‡Œé¢è§£é‡Šå¾—æŒºæ¸…æ¥šçš„ã€‚è¿™é‡ŒåŸºæœ¬å°±æ˜¯ç¿»è¯‘ä»¥ä¸‹ã€‚è¿™ä¸ªcommit logä¹Ÿå°±æ˜¯è£…æœºæ—¶å€™é…ç½®çš„é‚£ä¸ª<code>commitlog_directory</code>çš„é…ç½®é¡¹ã€‚<br>
commit logå¤§å°é…ç½®æ˜¯per-nodeæ¥é…ç½®çš„ï¼Œæ‰€æœ‰çš„table shareè¿™ä¸ªé…ç½®ã€‚è€ŒMemtableå’ŒSSTableæ˜¯per-tableé…ç½®çš„</p>
<ul>
<li>
<p>cassandraæ˜¯å…ˆå†™åˆ°å†…å­˜ï¼Œå†å†™åˆ°diskä¸Šé¢çš„ï¼Œä½†æ˜¯å¦‚æœå½“æœºäº†ã€‚é‚£ä¹ˆå†…å­˜çš„æ•°æ®å°±ä¼šä¸¢ã€‚</p>
</li>
<li>
<p>è¿™ä¸ªæ—¶å€™å°±éœ€è¦commitLogï¼Œcassandraä¼šä»å½“æœºçš„æ—¶é—´ç‚¹å¼€å§‹ï¼Œå°†commitlogé‡Œé¢çš„æ•°æ®å†å†™åˆ°memTableé‡Œé¢ã€‚è¿™ä¸ªè¿‡ç¨‹å¹¶ä¸å¿«ï¼Œæ‰€ä»¥æœ€å¥½åœ¨restartä¹‹å‰æ‰‹åŠ¨è¿›è¡Œä¸€ä¸‹memTableçš„flushã€‚</p>
</li>
<li>
<p>A commit log serves just one purpose: to hold committed data until itâ€™s permanently written to disk in the SSTables</p>
</li>
<li>
<p>commitLogéœ€è¦å†™çš„æ•°æ®å°‘ï¼Œå¹¶ä¸”åªå†™åˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œæ‰€ä»¥æ¯”å†™SSTableè¦å¿«</p>
</li>
<li>
<p>åœ¨å·¥ä½œä¸­ç¢°åˆ°çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯commitLogæŸåäº†ï¼Œç„¶åcassandraå°±èµ·ä¸æ¥äº†ã€‚æœ‰ä¸€ä¸ªé…ç½®é¡¹å¯ä»¥å¿½ç•¥commitLogæŠ¥é”™ã€‚</p>
</li>
<li>
<blockquote>
<p>Data in the commit log is purged after its corresponding data in the memtable is flushed to an SSTable on disk.</p>
</blockquote>
</li>
<li>
<blockquote>
<p>Commit log replay is the process of reading the commit log to recover lost writes in the event of interrupted operations.</p>
</blockquote>
</li>
<li>
<p>The database flushes memtables to disk when the space configured for the commit log reaches its limit. è¿™é‡Œé…ç½®çš„åº”è¯¥æ˜¯ç£ç›˜ç©ºé—´å¤§å°ï¼Œcommit logåªä¼šå†™åˆ°ç£ç›˜ä¸Šé¢ã€‚ä¸ä¼šå†™åˆ°å†…å­˜é‡Œé¢ã€‚</p>
</li>
<li>
<p>By default, the database doesnâ€™t compress the commit log, but you can make it compress.</p>
</li>
<li>
<p>The database archives the commit log at the following times. You configure commit log archiving in the commitlog_archiving.properties file. _<strong><em>archiveå’Œcompressä¸æ˜¯ä¸€ä¸ªæ¦‚å¿µçš„æ„Ÿè§‰ã€‚ä½†æ˜¯å‰è€…æ˜¯æŒ‡ä»€ä¹ˆå‘¢</em></strong></p>
<ul>
<li>When the node starts up</li>
<li>When it writes a commit log to disk</li>
<li>At a point in time that you specify</li>
</ul>
</li>
</ul>
<h3 id="memtable"><a class="header-anchor" href="#memtable"></a>MemTable</h3>
<ul>
<li>
<blockquote>
<p>Each memtable is dedicated to storing data for a specific table, and there may be multiple memtables per table.</p>
</blockquote>
</li>
<li>æ¯æ¬¡å†™çš„æ—¶å€™åªå†™å…¶ä¸­ä¸€å¼ memtable memTableåœ¨å†…å­˜é‡Œé¢çœ‹ä¸åˆ°å“¦</li>
<li>memTableæœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯å†™çš„è¿™ç§ï¼Œå¦å¤–ä¸€ç§æ˜¯ä»SSTableè¯»è¿›æ¥çš„ï¼Œè¿™ç§ä¸ä¼šé‡æ–°å†™å›åˆ°ç£ç›˜é‡Œé¢</li>
<li><code>nodetool flush</code> or the <code>nodetool drain</code> command æ¥è§¦æ³•æ‰‹åŠ¨çš„flushã€‚å‰è€…æ˜¯æŒ‡å®štableã€‚åä¸€ä¸ªå‘½ä»¤æ˜¯flushè¿™ä¸ªnodeã€‚æœŸé—´ä¼šåœæ­¢ä»»ä½•connectionçš„æ¥å¬ï¼Œæ‰€ä»¥éœ€è¦åœ¨æ‰§è¡Œå‘½ä»¤ä¹‹åé‡å¯æ•´ä¸ªnode</li>
</ul>
<h3 id="sstable"><a class="header-anchor" href="#sstable"></a>SSTable</h3>
<p>ç¬¬äºŒç¯‡å‚è€ƒé“¾æ¥éå¸¸å¥½ï¼Œä½†æ˜¯å›¾ç‰‡å¿’ä¸æ¸…æ¥šã€‚</p>
<p><img src="https://www.ibm.com/developerworks/cn/opensource/os-cn-cassandraxu2/image010-large.jpg" alt=""></p>
<blockquote>
<p>å¼•ç”¨è‡ªç¬¬äºŒç¯‡å‚è€ƒé“¾æ¥</p>
</blockquote>
<h4 id="sstableç‰¹æ€§"><a class="header-anchor" href="#sstableç‰¹æ€§"></a>SSTableç‰¹æ€§</h4>
<ul>
<li>ä¸å¯ä¿®æ”¹</li>
<li>Cassandraåœ¨å†™SSTableçš„æ—¶å€™æ˜¯batchæ“ä½œï¼Œå› ä¸ºæ¯æ¬¡éƒ½æ˜¯å¯¹åº”çš„Memtableæ»¡çš„æ—¶å€™æ‰å†™çš„ï¼Œä¸å¤ªä¼šæœ‰å³°å€¼ï¼Œè¿™æ ·ä¿è¯å†™å…¥çš„æ•ˆç‡</li>
</ul>
<h4 id="sstableæ•°æ®å­˜å‚¨"><a class="header-anchor" href="#sstableæ•°æ®å­˜å‚¨"></a>SSTableæ•°æ®å­˜å‚¨</h4>
<ul>
<li>SSTableæ˜¯<code>Sorted String Table</code></li>
<li>SSTableåˆ†ä¸ºdataã€indexã€filterä¸‰ä¸ªæ–‡ä»¶å†™åˆ°ç£ç›˜ä¸Šé¢ï¼Œå…¶å®è¿˜æœ‰å¥½å‡ ä¸ªå…¶ä»–æ–‡ä»¶:<br>
ä»¥ä¸‹æ˜¯ä¸€ä¸ªç›®å½•é‡Œé¢çš„æ–‡ä»¶</li>
</ul>
<pre><code> Filter.db
 Statistics.db
 CompressionInfo.db
 Digest.adler32
 TOC.txt(å°±æ˜¯æ–‡ä»¶åˆ—è¡¨)
 Summary.db
 Data.db
 Index.db
</code></pre>
<ul>
<li>Primary index: A list of partition keys and the start position of rows in the data file written on disk(è®°å¾—è¯»çš„æ—¶å€™è›®æœ‰ç”¨çš„)</li>
<li>Partition summaryï¼š è¿™ä¸ªsummaryæ–‡ä»¶è·Ÿä¸Šé¢çš„Index Summaryåº”è¯¥å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶ã€‚è§£é‡Šä¹Ÿæ˜¯ä¸€æ ·ã€‚A sample of the partition index stored in memory</li>
<li>Bloom filterï¼š
<ul>
<li>
<blockquote>
<p>A structure stored in memory that checks if row data exists in the memtable before accessing SSTables on disk<br>
æŒ‰ç…§è¿™ä¸ªè§£é‡Šï¼Œæœ‰ç‚¹ä¸æ˜ç™½ï¼Œè¿™ä¹ˆè¯´åº”è¯¥æ˜¯memoryé‡Œé¢æ‰æœ‰çš„ã€‚<br>
- æ‰¾åˆ°è§£é‡Šäº†ï¼šFilter æ–‡ä»¶å­˜çš„å†…å®¹å°±æ˜¯ BloomFilter å¯¹è±¡çš„åºåˆ—åŒ–ç»“æœã€‚<strong><em>ä½†æ˜¯è¿™æ ·çš„è¯ï¼Œå°†å…¶åºåˆ—åŒ–åä¿å­˜åˆ°diskä¸Šé¢æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ Bloom filters for an SSTable enhance read performanceã€‚åé¢è¯»çš„æ—¶å€™çœ‹çœ‹æ€ä¹ˆæ¥enhanceçš„</em></strong></p>
</blockquote>
</li>
</ul>
</li>
<li>Statisticsï¼š Contains the statistical metadata about the SSTableâ€™s data</li>
</ul>
<ul>
<li>
<p>å­˜è´®çš„ç›®å½•å°±æ˜¯yamlæ–‡ä»¶é‡Œé¢é…ç½®çš„<code>data_file_directories</code>ç¡®å®š</p>
</li>
<li>
<p>For example, /data/data/ks1/cf1-5be396077b811e3a3ab9dc4b9ac088d/la-1-big-Data.db represents a data file. ks1 represents the keyspace name to distinguish the keyspace for streaming or bulk loading data. A hexadecimal string, 5be396077b811e3a3ab9dc4b9ac088d in this example, is appended to table names to represent unique table IDs.<br>
åŒæ ·ä¼šæœ‰ï¼šla-1-big-Index.db</p>
</li>
<li>
<p><strong><em>laæ˜¯å•¥ï¼Ÿ</em></strong></p>
</li>
<li>
<p>ç”¨<code>./tools/bin/sstable2json</code>å¯ä»¥æ‰“å¼€è¿™å †dataæ–‡ä»¶æ¥çœ‹ã€‚ä¸‹é¢æ˜¯æ‰“å¼€ä¸€ä¸ªdataæ–‡ä»¶çš„è¾“å‡ºã€‚</p>
<ul>
<li>ä»è¾“å‡ºæ¥çœ‹ï¼Œå­˜å‚¨çš„æ—¶å€™çš„keyå°±æ˜¯partition keyã€‚å¦‚æœæœ‰å¤šä¸ªï¼Œä¼šç”¨<code>ï¼š</code>éš”å¼€</li>
<li>ç„¶åå®ƒæ˜¯è¿™æ ·çš„ï¼š
<ul>
<li>ä¸æ˜¯partition keyçš„primary keyä¼šä½œä¸ºç¬¬ä¸€ä¸ªcolumnçš„åå­—ï¼ŒåŒæ ·ç”¨:éš”å¼€ã€‚</li>
<li>æ¥ä¸‹æ¥ä¸æ˜¯keyçš„columnå’Œä¸æ˜¯partition keyçš„primary keyè”åˆèµ·æ¥ä½œä¸ºcolumnçš„åå­—ã€‚</li>
<li>æ¯”å¦‚ï¼šé‚£ä¹ˆkeyå°±æ˜¯&quot;name:age&quot;, ç„¶åcellsé‡Œé¢çš„ç¬¬ä¸€è¡Œä¼šæ˜¯,æœ€åæ˜¯æ—¶é—´æˆ³<br>
<code>[&quot;address:salary&quot;,&quot;&quot;,1558958953681000]</code></li>
<li>ç¬¬äºŒè¡Œä¼šæ˜¯ï¼š<br>
<code>[&quot;address:salary:character&quot;,character_value,1558958953681000]</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code>    name text PRIMARY KEY,
    age bigint,
    address int,
    salary int,
    character blob,
    PRIMARY KEY ((name, age), address, salary)
</code></pre>
<h3 id="ä»memtablesåˆ°sstable"><a class="header-anchor" href="#ä»memtablesåˆ°sstable"></a>ä»memTablesåˆ°SSTable</h3>
<ul>
<li>
<p>Cassandra flushes the memtables to disk when either the commit log space threshold or the memtable cleanup threshold is reached.</p>
<ul>
<li><code>memtable_cleanup_threshold</code> åé¢ä¸€ç§åº”è¯¥å’Œè¿™ä¸ªå‚æ•°æœ‰å…³</li>
<li>åœ¨<code>expert cassandra</code>çš„ä¹¦é‡Œæœ‰ä¸‰ç§æƒ…å†µä¸‹é¢ä¼šflushã€‚ä¸åŒ…æ‹¬æ‰‹åŠ¨flush</li>
</ul>
</li>
<li>
<blockquote>
<p>To flush the data, Cassandra sorts memtables by token and then writes the data to disk sequentially.<br>
Cassandraåœ¨å°†æ•°æ®å†™åˆ°diskçš„æ—¶å€™ï¼ŒåŒæ—¶ä¼šå°†memtablesæŒ‰ç…§tokenæ’åºã€‚_è¿™ä¸ªtokenæ˜¯ä¸æ˜¯å°±æ˜¯keyç®—å‡ºæ¥çš„é‚£ä¸ªtokenï¼Ÿä½†æ˜¯tableæ€ä¹ˆæŒ‰ç…§tokenæ’åºå‘¢ï¼Œåº”è¯¥è¯´çš„æ˜¯tableé‡Œé¢çš„æ•°æ®å§ _</p>
</blockquote>
</li>
<li>
<blockquote>
<p>A partition index is also created on the disk that maps the tokens to a location on disk.<br>
partition indexæ˜¯åœ¨è¿™é‡Œæ‰ç®—å‡ºæ¥çš„ã€‚é‚£ä¹ˆä¹‹å‰å°±éƒ½æ˜¯tokenã€‚___ Memtbleé‡Œé¢çš„ä¹Ÿéƒ½æ˜¯tokenï¼Ÿ___</p>
</blockquote>
</li>
<li>
<p>flushçš„æ—¶å€™ä¸æ˜¯ä¸€æŠŠå¤´å…¨å†™è¿›å»çš„ã€‚ä¼šå…ˆæŠŠmemTableçš„æ•°æ®æ”¾åˆ°ä¸€ä¸ªqueueé‡Œé¢ã€‚è¿™ä¸ªqueueçš„å¤§å°å¯ä»¥åœ¨configurationé‡Œé¢å®šä¹‰ã€‚</p>
<blockquote>
<p>The queue can be configured with the memtable_heap_space_in_mb or memtable_offheap_space_in_mb setting</p>
</blockquote>
</li>
<li>
<p>You can manually flush a table using nodetool flush.</p>
</li>
<li>
<blockquote>
<p>Consequently, a partition is typically stored across multiple SSTable files.</p>
</blockquote>
</li>
<li>
<p>ç›¸åŒpartition keyçš„è®°å½•åº”è¯¥æ˜¯å­˜è´®åœ¨ä¸€ä¸ªnodeä¸Šé¢ï¼Œä½†æ˜¯ä¹Ÿæœ‰å¯èƒ½æ˜¯å¤šä¸ªæ–‡ä»¶ï¼Œè¦çœ‹æ•°æ®é‡ã€‚</p>
</li>
</ul>
<h3 id="å‚è€ƒæ–‡æ¡£"><a class="header-anchor" href="#å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h3>
<ul>
<li><a href="https://blog.csdn.net/fs1360472174/article/details/55005335/" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£â€“è¯»å†™æ•°æ®</a></li>
<li><a href="https://www.ibm.com/developerworks/cn/opensource/os-cn-cassandraxu2/index.html" target="_blank" rel="noopener">cassandraæ•°æ®åº“è¯¦è§£</a></li>
<li><a href="https://docs.datastax.com/en/cassandra/3.0/cassandra/dml/dmlHowDataWritten.html" target="_blank" rel="noopener">cassandraè¯»å†™è¿‡ç¨‹</a></li>
<li><a href="https://blog.csdn.net/qinzhihu/article/details/8807776" target="_blank" rel="noopener">ä¸€ç¯‡å¾ˆé€šä¿—çš„blog</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/2019/01/17/Cassandra%20System%20Log%20Analyses/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content="35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/hexo_blog/2019/01/17/Cassandra%20System%20Log%20Analyses/" class="post-title-link" itemprop="url">Cassandra system logåˆ†æ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-01-17 14:28:35" itemprop="dateCreated datePublished" datetime="2019-01-17T14:28:35+08:00">2019-01-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-02-22 17:16:52" itemprop="dateModified" datetime="2021-02-22T17:16:52+08:00">2021-02-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/cassandra/" itemprop="url" rel="index"><span itemprop="name">cassandra</span></a>
                </span>
            </span>

          
            <span id="/hexo_blog/2019/01/17/Cassandra%20System%20Log%20Analyses/" class="post-meta-item leancloud_visitors" data-flag-title="Cassandra system logåˆ†æ" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="cassandra-system-logåˆ†æ"><a class="header-anchor" href="#cassandra-system-logåˆ†æ"></a>Cassandra system logåˆ†æ</h2>
<p>æœ€è¿‘ä¸€å‘¨å¯èƒ½éƒ½ä¼šåœ¨çœ‹Cassandraçš„system logï¼Œçœ‹Cassandraåœ¨å¹²å˜›ã€‚å…¶ä¸­ä¼šæ¶‰åŠåˆ°cassandraçš„ä¸€äº›æœºåˆ¶ï¼Œæ¦‚å¿µè®°å½•ä¸‹æ¥ã€‚<br>
æ–‡æ¡£åå­—æš‚æ—¶çš„ï¼Œå…¶ä¸­çš„æ¦‚å¿µå¯èƒ½åæœŸä¼šç§»èµ°ã€‚</p>
<h3 id="nodetool"><a class="header-anchor" href="#nodetool"></a>Nodetool</h3>
<p>Cassandraçš„çŠ¶æ€å¯ä»¥ç”¨<code>NodeTool</code>æ¥checkï¼Œå¦‚æœé‡‡ç”¨äº†ssl è®¤è¯ï¼Œé‚£ä¹ˆå‘½ä»¤æ˜¯ <code>NodeTool --ssl</code></p>
<h3 id="gossip-tasks"><a class="header-anchor" href="#gossip-tasks"></a>Gossip Tasks</h3>
<h4 id="pending-task-log"><a class="header-anchor" href="#pending-task-log"></a>Pending task log</h4>
<p>åå­—å¤ªå¥½è®° ï¼Œæœ‰æ²¡æœ‰ ğŸ˜ƒ<br>
Cassandra çš„å„ä¸ªèŠ‚ç‚¹æ˜¯æ— ä¸­å¿ƒåŒ–å¯¹å¾…çš„ã€‚èƒ½åšåˆ°è¿™ä¸€ç‚¹çš„ä¸€ä¸ªå…³é”®æ˜¯ä½¿ç”¨äº†Gossipåè®®ã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆé€‚ç”¨äºä¸å¯ä¿¡ç½‘ç»œçš„åè®®</p>
<ul>
<li>å‚è€ƒé“¾æ¥ï¼Œ åç»­éœ€è¦æ›´ä¸ºä»”ç»†æ·±å…¥çš„å­¦ä¹ ï¼š <a href="https://www.ibm.com/developerworks/cn/opensource/os-cn-apache-cassandra3x3/index.html" target="_blank" rel="noopener">Apache Cassandra 3.X ç³»åˆ—</a></li>
<li>Cassandraä¸­Gossipåè®®è¢«å®ç°åœ¨ç±»<code>Gossiper</code>ä¸­ã€‚</li>
<li>Gossiper ç±»ç»´æŠ¤äº†ä¸€ä¸ªèŠ‚ç‚¹åˆ—è¡¨ï¼Œè¿™ä¸ªåˆ—è¡¨é‡ŒåŒ…æ‹¬å­˜æ´»çš„å’Œæ­»äº¡çš„èŠ‚ç‚¹ã€‚</li>
<li><code>GossipTask</code> æ˜¯ä½äº <code>org.apche.cassandra.gms.Gossip</code> ç±»ä¸‹çš„ä¸€ä¸ªå†…éƒ¨ç±»ã€‚</li>
<li>GossipTaskä¼šå‘å…¶ä»–èŠ‚ç‚¹å‘æ¶ˆæ¯ï¼Œé»˜è®¤æ—¶é—´æ˜¯1s</li>
<li>åœ¨logé‡Œé¢ä¼šæœ‰ï¼š<br>
[GossipTasks:1] 2019-01-03 04:19:33,680 Gossiper.java:751 - Gossip stage has 378 pending tasks; skipping status check (no nodes will be marked down)</li>
</ul>
<h4 id="pause-error-not-making-nodes-down"><a class="header-anchor" href="#pause-error-not-making-nodes-down"></a>Pause Error: Not making Nodes Down</h4>
<ul>
<li>åœ¨logé‡Œé¢ç»å¸¸ä¼šå‡ºç°:ä»¥ä¸‹æ˜¯è¯´cassandraåœ¨åšå…¶ä»–äº‹æƒ…ï¼Œå¯¼è‡´Gossipåœé¡¿äº†ï¼Œ hangä½äº†ã€‚ä½†æ˜¯å¹¶ä¸æ ‡ç¤ºnodeçŠ¶æ€ã€‚</li>
<li>é€šå¸¸æ˜¯GCçš„æ—¶å€™ï¼Œè¿™ä¸€å¥çš„ä¸Šä¸€å¥logç¡®å®æç¤ºäº†ä¸€æ¬¡55742msçš„GCï¼Œä½†æ˜¯GCé€šå¸¸ä¹Ÿå‘ç”Ÿåœ¨æœ‰å¾ˆå¤štaskçš„æ—¶å€™ï¼Œæ‰€ä»¥åº”è¯¥çœ‹çœ‹å…¶ä»–åœ¨åšä»€ä¹ˆtask</li>
</ul>
<pre><code>WARN  [GossipTasks:1] 2019-01-02 00:00:04,546 FailureDetector.java:287 - Not marking nodes down due to local pause of 54491963082 &gt; 5000000000
</code></pre>
<ul>
<li><a href="http://www.cnblogs.com/jobforlife/p/7092467.html" target="_blank" rel="noopener">errorè§£é‡Š</a></li>
</ul>
<h3 id="service-thread"><a class="header-anchor" href="#service-thread"></a>Service Thread</h3>
<p>æ²¡æœ‰çœ‹åˆ°è¿™ä¸ªService Threadçš„å…·ä½“è§£é‡Šã€‚ä»logé‡Œé¢çœ‹æœ‰å¾ˆå¤šåŠŸèƒ½</p>
<h4 id="statuslogger"><a class="header-anchor" href="#statuslogger"></a>StatusLogger</h4>
<p>å¦‚æ­¤ç®€å•çš„ä¸€ä¸ªå‡½æ•°ä¹Ÿæœ‰å¥½å‡ ç§logå•¦ã€‚</p>
<h5 id="threadpoolmetricsï¼š-stage"><a class="header-anchor" href="#threadpoolmetricsï¼š-stage"></a>ThreadPoolMetricsï¼š Stage</h5>
<p>æ‰“å°å‡ºå„ç§stageçš„çŠ¶æ€ï¼Œä¸€ä¸ªæ¥ä¸€ä¸ªçš„poolçš„çŠ¶æ€ã€‚çœŸå¿ƒä¸å°‘å•Šã€‚</p>
<ul>
<li>åœ¨logé‡Œé¢ä¼šæœ‰ï¼š</li>
</ul>
<pre><code>INFO  [Service Thread] 2019-01-02 00:00:04,547 StatusLogger.java:52 - Pool Name Active   Pending      Completed   Blocked  All Time Blocked
</code></pre>
<ul>
<li>é‰´äºstageæ¯”è¾ƒå¤šï¼Œå¦å¤–å†™ä¸€ç¯‡blogæ¥è§£é‡Šè¿™å †ã€‚è¯·çœ‹æœ¬ç«™çš„stageã€‚</li>
</ul>
<h5 id="cache"><a class="header-anchor" href="#cache"></a>Cache</h5>
<p>è¾“å‡ºKeyCache å’Œ RowCacheçš„çŠ¶æ€</p>
<ul>
<li>åœ¨logé‡Œé¢æ˜¯ï¼š</li>
</ul>
<pre><code>INFO  [Service Thread] 2019-01-02 00:00:05,130 StatusLogger.java:88 - Cache Type  Size Capacity KeysToSave
INFO  [Service Thread] 2019-01-02 00:00:05,130 StatusLogger.java:90 - KeyCache   1406343  104857600
</code></pre>
<ul>
<li>è¿™ç¯‡ logå·²ç»å¾ˆé•¿äº†ã€‚KeyCacheå’ŒRowCacheå¦å¼€ä¸€ç¯‡logã€‚</li>
</ul>
<h5 id="per-cf-stats"><a class="header-anchor" href="#per-cf-stats"></a>per-CF stats</h5>
<p>per-CF statsæ˜¯æºç é‡Œé¢çš„æ³¨é‡Šï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“æ˜¯å•¥å“¦</p>
<ul>
<li>åœ¨logé‡Œé¢æ˜¯ï¼š</li>
</ul>
<pre><code>INFO  [Service Thread] 2019-01-03 02:54:45,722 StatusLogger.java:106 (table_name)Â Â Â  6284,288376
</code></pre>
<ul>
<li>Cassandraçš„APIé‡Œé¢å¯¹äº<code>StatusLogger</code>ä¹Ÿæ²¡æœ‰è§£é‡Šã€‚ ORZï¼Œçœ‹æ¥æ˜¯ä¸ªå¾ˆç›´ç™½çš„æ–‡ä»¶å•Š<br>
-<code>org.apache.cassandra.utils.StatusLogger</code> åªæœ‰ä¸€ä¸ªå‡½æ•°<code>log()</code></li>
</ul>
<pre><code>logger.info(String.format(&quot;%-25s%20s&quot;, &quot;Table&quot;, &quot;Memtable ops,data&quot;));
logger.info(String.format(&quot;%-25s%20s&quot;,
                   cfs.keyspace.getName() 
				   + &quot;.&quot; + cfs.name,                                      cfs.metric.memtableColumnsCount.getValue() 
				   + &quot;,&quot; + cfs.metric.memtableLiveDataSize.getValue()));
    }ã€‚
</code></pre>
<ul>
<li>æ‰€ä»¥ï¼Œç¬¬ä¸€ä¸ªæ•°å€¼æ˜¯memTableçš„columnçš„ä¸ªæ•°ï¼Œç¬¬äºŒä¸ªæ˜¯dataçš„size</li>
<li>ä¸€ä¸ªé—®é¢˜æ˜¯ï¼š è¿™ä¸ªcolumnä¹Ÿå¤ªå¤šäº†å§ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</li>
<li>è¢«å¤§ç¥åŠæ‰“äº†ã€‚è¿™ä¸ªå€¼æ˜¯è¡¨è®¿é—®æ¬¡æ•°ã€‚</li>
</ul>
<h4 id="gcinspector"><a class="header-anchor" href="#gcinspector"></a>GCInspector</h4>
<p>-åœ¨logé‡Œé¢æ˜¯ï¼š</p>
<pre><code>INFO  [Service Thread] 2019-01-02 00:00:04,546 GCInspector.java:284 - ConcurrentMarkSweep GC in 55742ms.  CMS Old Gen: 7331643368 -&gt; 7331643360; Par Eden Space: 1006632960 -&gt; 784484600; Par Survivor Space: 125829104 -&gt; 0
</code></pre>
<ul>
<li>è¿™å¥logçš„æ„æ€æ˜¯ï¼šåšäº†ä¸€æ¬¡CMS GCã€‚ç„¶åæ•°å­—å¯¹åº”ï¼Œ11ä½æ˜¯Gï¼Œ9ä½æ˜¯Mï¼Œæ‰€ä»¥ edenåŒºæ˜¯784M</li>
<li>å‚è€ƒæœ¬ç«™GCçš„æ–‡ç« äº†è§£æ›´å¤šCMSç®—æ³•çš„å†…å®¹</li>
</ul>
<h3 id="periodic-commit-log-syncer"><a class="header-anchor" href="#periodic-commit-log-syncer"></a>PERIODIC-COMMIT-LOG-SYNCER</h3>
<ul>
<li>åœ¨logé‡Œé¢æ˜¯ï¼š</li>
</ul>
<pre><code>WARN  [PERIODIC-COMMIT-LOG-SYNCER] 2019-01-03 04:04:17,232 AbstractCommitLogService.java:117 - Out of 5 commit log syncs over the past 573s with average duration of 9734.40ms...
</code></pre>
<ul>
<li>è¿™ä¸ªåº”è¯¥æ˜¯å°†commit logå†™åˆ°diskä¸Šé¢çš„taskã€‚æ²¡æœ‰å†æŸ¥èµ„æ–™ã€‚å‚è€ƒæœ¬ç«™cassandraå†™è¿‡ç¨‹é‚£ç¯‡åšå®¢</li>
</ul>
<h3 id="rmi-tcp-connection-idle"><a class="header-anchor" href="#rmi-tcp-connection-idle"></a>RMI TCP Connection(idle)</h3>
<h3 id="indexsummarymanager"><a class="header-anchor" href="#indexsummarymanager"></a>IndexSummaryManager</h3>
<ul>
<li>åœ¨logé‡Œé¢æ˜¯ï¼š</li>
</ul>
<pre><code> INFO  [IndexSummaryManager:1] 2019-01-02 03:21:59,849 IndexSummaryRedistribution.java:74 - Redistributing index summaries
</code></pre>
<ul>
<li>Manages the fixed-size memory pool for index summaries, periodically resizing them in order to give more memory to hot sstables and less memory to cold sstables.</li>
<li>è¿˜ä¸æ˜¯å¾ˆç†è§£ï¼Œå°±æ˜¯è¯´index summaryä¸€å¼€å§‹ä¹Ÿæ˜¯å­˜åœ¨å†…å­˜ä¸­çš„å—ï¼Ÿç¡®å®åœ¨å‚æ•°é…ç½®é‡Œé¢æœ‰index_summary_capacity_in_mbå’Œindex_summary_resize_interval_in_minutes</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sallyslove.github.io/hexo_blog/2019/01/14/React%E5%85%A5%E9%97%A8-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/hexo_blog/images/avatar.gif">
      <meta itemprop="name" content="Lynn Shen">
      <meta itemprop="description" content="35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è·¬æ­¥">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/hexo_blog/2019/01/14/React%E5%85%A5%E9%97%A8-1/" class="post-title-link" itemprop="url">Reactå…¥é—¨(1)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-01-14 16:35:28" itemprop="dateCreated datePublished" datetime="2019-01-14T16:35:28+08:00">2019-01-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-01-15 14:53:45" itemprop="dateModified" datetime="2019-01-15T14:53:45+08:00">2019-01-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hexo_blog/categories/React/" itemprop="url" rel="index"><span itemprop="name">React</span></a>
                </span>
            </span>

          
            <span id="/hexo_blog/2019/01/14/React%E5%85%A5%E9%97%A8-1/" class="post-meta-item leancloud_visitors" data-flag-title="Reactå…¥é—¨(1)" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="reactå…¥é—¨"><a class="header-anchor" href="#reactå…¥é—¨"></a>Reactå…¥é—¨</h1>
<h2 id="å‚è€ƒæ–‡æ¡£"><a class="header-anchor" href="#å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2>
<p><a href="http://www.ruanyifeng.com/blog/2015/03/react.html" target="_blank" rel="noopener">é˜®ä¸€å³°çš„åšå®¢</a></p>
<h2 id="react-æ˜¯ä»€ä¹ˆ"><a class="header-anchor" href="#react-æ˜¯ä»€ä¹ˆ"></a>React æ˜¯ä»€ä¹ˆ</h2>
<p>Reactæ˜¯Facebookå‘å¸ƒçš„å‰ç«¯æ¡†æ¶</p>
<h2 id="reactçš„ä¼˜åŠ¿"><a class="header-anchor" href="#reactçš„ä¼˜åŠ¿"></a>Reactçš„ä¼˜åŠ¿</h2>
<p>ç°åœ¨è¿˜ä¸çŸ¥é“å“ªé‡Œæœ‰ä¼˜åŠ¿ã€‚æœ€å¤§çš„åº”è¯¥å°±æ˜¯JXSï¼Œç„¶åå¯ä»¥ç»„ä»¶åŒ–ã€‚</p>
<h2 id="reactçš„ä¸€äº›ç›¸å…³æ¦‚å¿µ"><a class="header-anchor" href="#reactçš„ä¸€äº›ç›¸å…³æ¦‚å¿µ"></a>Reactçš„ä¸€äº›ç›¸å…³æ¦‚å¿µ</h2>
<h3 id="dom"><a class="header-anchor" href="#dom"></a>DOM</h3>
<ul>
<li><code>DOM</code>: æ–‡æ¡£å¯¹è±¡æ¨¡å‹(Document Object Model). è¿™æ˜¯è¡¨ç¤ºå’Œå¤„ç†ä¸€ä¸ªHTMLæˆ–XMLæ–‡æ¡£çš„å¸¸ç”¨æ–¹æ³•ã€‚<br>
<a href="https://baike.baidu.com/item/DOM/50288#1_2" target="_blank" rel="noopener">DOM:ç™¾åº¦ç™¾ç§‘è§£é‡Š</a></li>
<li>ç›®å‰çš„ç†è§£æ˜¯ï¼šDOMå…¶å®å°±æ˜¯ä¸€å¥—æè¿°æ•°æ®ç»“æ„çš„æ–¹æ³•ã€‚ä¸€å¼€å§‹å¤§å®¶ä¸ç»Ÿä¸€ï¼Œåæ¥æœ‰W3Cç»™å‡ºäº†è§„èŒƒï¼Œå¯ä»¥åˆ†ä¸ºDOMæ ¸å¿ƒï¼ŒHTMLçš„DOMï¼ŒXMLçš„DOMè¿™å‡ ä¸ª</li>
<li>è¿›ä¸€æ­¥çš„ç†è§£ï¼šDOMæ˜¯å‰ç«¯åŸæ¥å°±æœ‰çš„ä¸€ä¸ªæ¦‚å¿µï¼Œç„¶åReactç»™è¿™ä¸ªæ¦‚å¿µèµ‹äºˆäº†ä¸€äº›æ–°çš„å†…æ¶µã€‚æ‰€æœ‰æœ‰React DOMè¿™ä¸ªè¯´æ³•ã€‚React DOMå…¶å®å°±æ˜¯ç»„ä»¶ã€‚</li>
</ul>
<h3 id="jsx"><a class="header-anchor" href="#jsx"></a>JSX</h3>
<p>JSX è¯­æ³•æ˜¯Reactç‹¬æœ‰çš„ã€‚ç›®å‰çš„ç†è§£æ˜¯ï¼š</p>
<ul>
<li>JSXè¯­æ³•åœ¨æ”¯æŒJSé‡Œé¢å¤„ç†HTMLã€‚</li>
<li>å¦‚æœè¿™æ ·çš„è„šæœ¬æ’åœ¨htmlé‡Œé¢ï¼Œè¦ç”¨<code>text/babel</code>æ¥æ ‡è®°ã€‚ babelå‘½ä»¤å¯ä»¥å°†JSXè¯­æ³•ç¼–è¯‘æˆä¸ºJSè¯­æ³•ã€‚</li>
<li>JSX çš„åŸºæœ¬è¯­æ³•è§„åˆ™ï¼šé‡åˆ° HTML æ ‡ç­¾ï¼ˆä»¥ <code>&lt;</code> å¼€å¤´ï¼‰ï¼Œå°±ç”¨ HTML è§„åˆ™è§£æï¼›é‡åˆ°ä»£ç å—ï¼ˆä»¥ <code>{</code> å¼€å¤´ï¼‰ï¼Œå°±ç”¨ JavaScript è§„åˆ™è§£æã€‚</li>
</ul>
<p><a href="https://reactjs.org/docs/rendering-elements.html#jsx-syntax" target="_blank" rel="noopener">JSXè¯­æ³•</a></p>
<h3 id="reactç»„ä»¶"><a class="header-anchor" href="#reactç»„ä»¶"></a>Reactç»„ä»¶</h3>
<ul>
<li>ä½¿ç”¨<code>React.createClass(</code> æ¥åˆ›å»ºä¸€ä¸ªç»„ä»¶ï¼Œç»„ä»¶å¯ä»¥è®¤ä¸ºå’ŒHTMLçš„æ ‡ç­¾ä¸€æ ·ä½¿ç”¨ã€‚e.gï¼šMyComponentsæ˜¯åˆ›å»ºå‡ºæ¥çš„ä¸€ä¸ªç»„ä»¶ã€‚</li>
</ul>
<pre><code>&lt;MyComponent
    &quot;Hello world!&quot;;
/MyComponent&gt;
</code></pre>
<ul>
<li>å‰é¢æåˆ°è¿‡React DOMï¼Œå…¶å®å°±æ˜¯ç»„ä»¶ã€‚ç»„ä»¶åœ¨å®šä¹‰æ—¶å€™ï¼Œåªæ˜¯å†…å­˜é‡Œé¢çš„ä¸€ä¸ªæ•°æ®ï¼Œä½†æ˜¯å› ä¸ºå¯ä»¥ä½œä¸ºHTMLæ ‡ç­¾ä½¿ç”¨ï¼Œç„¶årenderæˆä¸ºHTMLé‡Œé¢çš„DOMï¼Œæ‰€æœ‰è¢«ç§°ä¸ºvirtual DOM</li>
<li>ç»„ä»¶ç±»åªèƒ½åŒ…å«ä¸€ä¸ªé¡¶å±‚å…ƒç´ ã€‚</li>
<li>æ‰€æœ‰çš„ç»„ä»¶ç±»å¿…é¡»æœ‰è‡ªå·±çš„renderæ–¹æ³•ï¼Œæ¥</li>
<li>ç»„ä»¶çš„å±æ€§å¯ä»¥åœ¨ç»„ä»¶ç±»çš„ <code>this.props</code> å¯¹è±¡ä¸Šè·å–, å…¶ä¸­çš„<code>this.props.children</code>ä»£è¡¨æ‰€æœ‰çš„å­èŠ‚ç‚¹ã€‚</li>
<li><code>PropTypes</code> å¯ä»¥ç”¨æ¥é™å®šå‚æ•°çš„ç±»å‹ï¼Œ <code>getDefaultProps</code> æ–¹æ³•å¯ä»¥ç”¨æ¥è®¾ç½®ç»„ä»¶å±æ€§çš„é»˜è®¤å€¼</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/hexo_blog/page/3/"><i class="fa fa-angle-left" aria-label="ä¸Šä¸€é¡µ"></i></a><a class="page-number" href="/hexo_blog/">1</a><span class="space">&hellip;</span><a class="page-number" href="/hexo_blog/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/hexo_blog/page/5/">5</a><a class="extend next" rel="next" href="/hexo_blog/page/5/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Lynn Shen</p>
  <div class="site-description" itemprop="description">35å²å¼€å§‹çš„åšå®¢ï¼Œæœ‰ç‚¹æ™šå“¦</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/hexo_blog/archives/">
        
          <span class="site-state-item-count">42</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/hexo_blog/categories/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">æ ‡ç­¾</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Lynn Shen</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> å¼ºåŠ›é©±åŠ¨
  </div>

        






<script>
  (function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.id);
      var title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              Counter('post', '/classes/Counter', { title, url, time: 1 })
                .then(response => response.json())
                .then(() => {
                  leancloudSelector(url).innerText = 1;
                })
                .catch(error => {
                  console.error('Failed to create', error);
                });
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            let target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    let { app_id, app_key, server_url } = {"enable":true,"app_id":"ffyWzhHueqJEC5UEfPUhAWzF-MdYXbMMI","app_key":"vS7xTvT1vD1DxluERkmlkvme","server_url":"https://sallyslove.github.io/hexo_blog","security":false};
    function fetchData(api_server) {
      var Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    let api_server = app_id.slice(-9) !== '-MdYXbMMI' ? server_url : `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com`;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script>


      </div>
    </footer>
  </div>

  
  <script src="/hexo_blog/lib/anime.min.js"></script>
  <script src="/hexo_blog/lib/velocity/velocity.min.js"></script>
  <script src="/hexo_blog/lib/velocity/velocity.ui.min.js"></script>

<script src="/hexo_blog/js/utils.js"></script>

<script src="/hexo_blog/js/motion.js"></script>


<script src="/hexo_blog/js/schemes/muse.js"></script>


<script src="/hexo_blog/js/next-boot.js"></script>




  















  

  

</body>
</html>
